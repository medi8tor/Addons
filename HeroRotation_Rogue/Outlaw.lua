local S,B=...local T=HeroDBC.DBC local l=HeroLib local q=HeroCache local p=l.Unit local E=p.Player local L=p.Target local P=l.Spell local c=l.MultiSpell local F=l.Item local O=HeroRotation()local k=O.AoEON local o=O.CDsON local R=O.Cast local I=O.CastPooling local Z=O.CastSuggested local i=O.CastAnnotated local t=O.CastQueue local x=(O.Commons()).Everyone.num local C=(O.Commons()).Everyone.bool local V=math.min local j=math.max local W=math.abs local G=0 local U=false local w=C_Timer.After local z=(O.Commons()).Everyone local N=(O.Commons()).Rogue local v=O.ToggleIconFrame:GetToggle(2)local K=O.GUISettingsGet()local Y={General=K.General;Commons=K.APL.Rogue.Commons;Outlaw=K.APL.Rogue.Outlaw;Interrupt=K.APL.Rogue.Outlaw_Interrupt}local Q=P.Rogue.Outlaw local M=F.Rogue.Outlaw local n={M.ImperfectAscendancySerum:ID(),M.MadQueensMandate:ID()}local m,b=E:GetTrinketItems()if m:ID()==0 or b:ID()==0 then w(2,function()m,b=E:GetTrinketItems()end)end local function X(S)if S:IsEquippedAndReady()then return m:ID()==S:ID()and Y.Commons.Enabled.Trinket1 or b:ID()==S:ID()and Y.Commons.Enabled.Trinket2 end end l:RegisterForEvent(function()m,b=E:GetTrinketItems()end,"\080\076\065\089\069\082\095\069\081\085\073\080\077\069\078\084\095\067\072\065\078\071\069\068")local u,J,s,A,H local h local d=6 local D,r,f local g,y,a,e,Sy local By,Ty=0,0 local function ly(S)local B=E:EnergyTimeToMaxPredicted(nil,S)if B<By or B-By>.5 then By=B end return By end local function qy()local S=E:EnergyPredicted()if S>Ty or S-Ty>9 then Ty=S end return Ty end local py={Q.Broadside;Q.BuriedTreasure;Q.GrandMelee,Q.RuthlessPrecision,Q.SkullandCrossbones;Q.TrueBearing}local Ey=false local function Ly()if not q.APLVar.RtB_Buffs then q.APLVar.RtB_Buffs={}q.APLVar.RtB_Buffs.Will_Lose={}q.APLVar.RtB_Buffs.Will_Lose.Total=0 q.APLVar.RtB_Buffs.Total=0 q.APLVar.RtB_Buffs.Normal=0 q.APLVar.RtB_Buffs.Shorter=0 q.APLVar.RtB_Buffs.Longer=0 q.APLVar.RtB_Buffs.MinRemains=100 q.APLVar.RtB_Buffs.MaxRemains=0 local S=N.RtBRemains()for B=1,#py,1 do local T=E:BuffRemains(py[B])if T>0 then q.APLVar.RtB_Buffs.Total=q.APLVar.RtB_Buffs.Total+1 if T>q.APLVar.RtB_Buffs.MaxRemains then q.APLVar.RtB_Buffs.MaxRemains=T end if T<q.APLVar.RtB_Buffs.MinRemains then q.APLVar.RtB_Buffs.MinRemains=T end local l=math.abs(T-S)if l<=.5 then q.APLVar.RtB_Buffs.Normal=q.APLVar.RtB_Buffs.Normal+1 q.APLVar.RtB_Buffs.Will_Lose[py[B]:Name()]=true q.APLVar.RtB_Buffs.Will_Lose.Total=q.APLVar.RtB_Buffs.Will_Lose.Total+1 elseif T>S then q.APLVar.RtB_Buffs.Longer=q.APLVar.RtB_Buffs.Longer+1 else q.APLVar.RtB_Buffs.Shorter=q.APLVar.RtB_Buffs.Shorter+1 q.APLVar.RtB_Buffs.Will_Lose[py[B]:Name()]=true q.APLVar.RtB_Buffs.Will_Lose.Total=q.APLVar.RtB_Buffs.Will_Lose.Total+1 end end if Ey then print("\082\116\098\082\101\109\097\105\110\115",S)print(py[B]:Name(),T)end end if Ey then print("\104\097\118\101\058 ",q.APLVar.RtB_Buffs.Total)print("\119\105\108\108 \108\111\115\101\058 ",q.APLVar.RtB_Buffs.Will_Lose.Total)print("\115\104\111\114\116\101\114\058 ",q.APLVar.RtB_Buffs.Shorter)print("\110\111\114\109\097\108\058 ",q.APLVar.RtB_Buffs.Normal)print("\108\111\110\103\101\114\058 ",q.APLVar.RtB_Buffs.Longer)print("\109\097\120 \114\101\109\097\105\110\115\058 ",q.APLVar.RtB_Buffs.MaxRemains)print("\109\105\110 \114\101\109\097\105\110\115\058 ",q.APLVar.RtB_Buffs.MinRemains)end end return q.APLVar.RtB_Buffs.Total end local function Py(S)return(q.APLVar.RtB_Buffs.Will_Lose and q.APLVar.RtB_Buffs.Will_Lose[S])and true or false end local function cy()if not q.APLVar.RtB_Reroll then if Y.Outlaw.RolltheBonesLogic=="\049\043 \066\117\102\102"then q.APLVar.RtB_Reroll=Ly()<=0 and true or false elseif Y.Outlaw.RolltheBonesLogic=="\066\114\111\097\100\115\105\100\101"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.Broadside)and true or false elseif Y.Outlaw.RolltheBonesLogic=="\066\117\114\105\101\100 \084\114\101\097\115\117\114\101"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.BuriedTreasure)and true or false elseif Y.Outlaw.RolltheBonesLogic=="\071\114\097\110\100 \077\101\108\101\101"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.GrandMelee)and true or false elseif Y.Outlaw.RolltheBonesLogic=="\083\107\117\108\108 \097\110\100 \067\114\111\115\115\098\111\110\101\115"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.SkullandCrossbones)and true or false elseif Y.Outlaw.RolltheBonesLogic=="\082\117\116\104\108\101\115\115 \080\114\101\099\105\115\105\111\110"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.RuthlessPrecision)and true or false elseif Y.Outlaw.RolltheBonesLogic=="\084\114\117\101 \066\101\097\114\105\110\103"then q.APLVar.RtB_Reroll=not E:BuffUp(Q.TrueBearing)and true or false else q.APLVar.RtB_Reroll=false Ly()q.APLVar.RtB_Reroll=Ly()==x(Py(Q.BuriedTreasure))+x(Py(Q.GrandMelee)and x(s<2))q.APLVar.RtB_Reroll=Q.LoadedDice:IsAvailable()and q.APLVar.RtB_Buffs.Will_Lose.Total==x(E:BuffUp(Q.LoadedDiceBuff))q.APLVar.RtB_Reroll=q.APLVar.RtB_Reroll and q.APLVar.RtB_Buffs.Longer==0 or q.APLVar.RtB_Buffs.Normal==0 and(q.APLVar.RtB_Buffs.Longer>=1 and(Ly()<=6 and(q.APLVar.RtB_Buffs.MaxRemains<=39 and(not E:StealthUp(true,true)and E:BuffUp(Q.LoadedDiceBuff)))))if L:FilteredTimeToDie("\060",12)or l.BossFilteredFightRemains("\060",12)then q.APLVar.RtB_Reroll=false end end end return q.APLVar.RtB_Reroll end local Fy,Oy local function ky()Fy=D Oy=(N.CPMaxSpend()-1)-x(E:StealthUp(true,true)and Q.Crackshot:IsAvailable()or(Q.HandOfFate:IsAvailable()or Q.FlawlessForm:IsAvailable())and(Q.HiddenOpportunity:IsAvailable()and(E:BuffUp(Q.AudacityBuff)or E:BuffUp(Q.Opportunity))))return D>=(N.CPMaxSpend()-1)-x(E:StealthUp(true,true)and Q.Crackshot:IsAvailable()or(Q.HandOfFate:IsAvailable()or Q.FlawlessForm:IsAvailable())and(Q.HiddenOpportunity:IsAvailable()and(E:BuffUp(Q.AudacityBuff)or E:BuffUp(Q.Opportunity))))end local function oy()return(Q.HiddenOpportunity:IsAvailable()or f>=(2+x(Q.ImprovedAmbush:IsAvailable()))+x(E:BuffUp(Q.Broadside)))and g>=50 end local function Ry()return not z.ISSolo()or L:IsDummy()or not E:IsTanking(L)and Y.Commons.UseSoloVanish end local function Iy(S)if Q.BladeFlurry:IsReady()then if Q.DeftManeuvers:IsAvailable()and(not ky()and(s>=3 and f==s+x(E:BuffUp(Q.Broadside))or s>=5))then if S then return Q.BladeFlurry else if R(Q.BladeFlurry,true)then return"\067\097\115\116 \066\108\097\100\101 \070\108\117\114\114\121"end end end end if Q.ColdBlood:IsCastable()and(E:BuffDown(Q.ColdBlood)and(L:IsSpellInRange(Q.Dispatch)and ky()))then if O.Cast(Q.ColdBlood,true)then return"\067\097\115\116 \067\111\108\100 \066\108\111\111\100"end end if not U and(Q.BetweentheEyes:IsReady()and(L:IsSpellInRange(Q.BetweentheEyes)and(ky()and(Q.Crackshot:IsAvailable()and(not E:BuffUp(Q.Shadowmeld)or E:StealthUp(true,false))))))then if S then return Q.BetweentheEyes else if I(Q.BetweentheEyes)then return"\067\097\115\116 \066\101\116\119\101\101\110 \116\104\101 \069\121\101\115"end end end if Q.Dispatch:IsCastable()and(L:IsSpellInRange(Q.Dispatch)and ky())then if S then return Q.Dispatch else if I(Q.Dispatch)then return"\067\097\115\116 \068\105\115\112\097\116\099\104"end end end if Q.PistolShot:IsCastable()and(L:IsSpellInRange(Q.PistolShot)and(Q.Crackshot:IsAvailable()and(Q.FanTheHammer:TalentRank()>=2 and(E:BuffStack(Q.Opportunity)>=6 and(E:BuffUp(Q.Broadside)and r<=1 or E:BuffUp(Q.GreenskinsWickersBuff))))))then if S then return Q.PistolShot else if I(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116"end end end if Q.Ambush:IsCastable()and(L:IsSpellInRange(Q.Ambush)and(Q.HiddenOpportunity:IsAvailable()and E:BuffUp(Q.AudacityBuff)))then if S then return Q.SinisterStrike else if I(Q.SinisterStrike)then return"\067\097\115\116 \065\109\098\117\115\104 \040\083\083 \072\105\103\104-\080\114\105\111 \066\117\102\102\101\100\041"end end end if Q.Ambush:IsCastable()and(L:IsSpellInRange(Q.Ambush)and Q.HiddenOpportunity:IsAvailable())then if S then return Q.Ambush else if I(Q.Ambush)then return"\067\097\115\116 \065\109\098\117\115\104"end end end end local function Zy(S)if Q.BetweentheEyes:IsCastable()and(L:IsSpellInRange(Q.BetweentheEyes)and(not Q.Crackshot:IsAvailable()and((E:BuffRemains(Q.BetweentheEyes)<4 or Q.ImprovedBetweenTheEyes:IsAvailable()or Q.GreenskinsWickers:IsAvailable())and E:BuffDown(Q.GreenskinsWickers))))then if S then return Q.BetweentheEyes else if I(Q.BetweentheEyes)then return"\067\097\115\116 \066\101\116\119\101\101\110 \116\104\101 \069\121\101\115"end end end if not U and(Q.BetweentheEyes:IsReady()and L:IsSpellInRange(Q.BetweentheEyes))then if Q.Crackshot:IsAvailable()and(Q.Vanish:CooldownRemains()>45 or Q.UnderhandedUpperhand:IsAvailable()and(Q.WithoutATrace:IsAvailable()and(E:BuffRemains(Q.AdrenalineRush)>10 or E:BuffDown(Q.AdrenalineRush)and Q.AdrenalineRush:CooldownRemains()>45)))then if N.CastWithTTD(Q.BetweentheEyes,false,20,false,A)then return"\067\097\115\116 \066\101\116\119\101\101\110 \116\104\101 \069\121\101\115"end end end if Q.SliceandDice:IsCastable()and((l.FilteredFightRemains(J,"\062",E:BuffRemains(Q.SliceandDice),true)or E:BuffRemains(Q.SliceandDice)==0)and E:BuffRefreshable(Q.SliceandDice))then if S then return Q.SliceandDice else if I(Q.SliceandDice)then return"\067\097\115\116 \083\108\105\099\101 \097\110\100 \068\105\099\101"end end end if Q.ColdBlood:IsCastable()and(E:BuffDown(Q.ColdBlood)and L:IsSpellInRange(Q.Dispatch))then if O.Cast(Q.ColdBlood,true)then return"\067\097\115\116 \067\111\108\100 \066\108\111\111\100"end end if Q.CoupDeGrace:IsCastable()and L:IsSpellInRange(Q.Dispatch)then if S then return Q.CoupDeGrace else if I(Q.CoupDeGrace)then return"\067\097\115\116 \067\111\117\112 \100\101 \071\114\097\099\101"end end end if Q.Dispatch:IsCastable()and L:IsSpellInRange(Q.Dispatch)then if S then return Q.Dispatch else if I(Q.Dispatch)then return"\067\097\115\116 \068\105\115\112\097\116\099\104"end end end end local function iy(S)local B if S:ID()==Q.Vanish:ID()or S:ID()==Q.Shadowmeld:ID()then B=Iy(true)if S:ID()==Q.Vanish:ID()then if R(Q.Vanish,true)then return"\067\097\115\116 \086\097\110\105\115\104"end return false elseif S:ID()==Q.Shadowmeld:ID()then if R(Q.Shadowmeld,true)then return"\067\097\115\116 \083\104\097\100\111\119\109\101\108\100"end return false end elseif S:ID()==Q.AdrenalineRush:ID()then D=E:ComboPointsMax()if not E:StealthUp(true,true)then B=Zy(true)else B=Iy(true)end if R(Q.AdrenalineRush,true)then return"\067\097\115\116 \065\100\114\101\110\097\108\105\110\101 \082\117\115\104"end return false end local T={S,B}h=t(unpack(T))if h then return"\124 "..T[2]:Name()end return false end local function ty()if o()and(Q.Vanish:IsReady()and(O.ToggleIconFrame:GetToggle(1)and(L:IsSpellInRange(Q.Dispatch)and(Ry()and(Q.UnderhandedUpperhand:IsAvailable()and(Q.Subterfuge:IsAvailable()and((E:BuffUp(Q.AdrenalineRush)or Q.AdrenalineRush:IsReady()or not Q.WithoutATrace:IsAvailable()and Q.Crackshot:IsAvailable())and(ky()or not Q.Crackshot:IsAvailable()and(oy or not Q.HiddenOpportunity:IsAvailable())))))))))then h=N.CastWithTTD(Q.Vanish,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h.."\040\049\041"end end if o()and(Q.Vanish:IsReady()and(O.ToggleIconFrame:GetToggle(1)and(L:IsSpellInRange(Q.Dispatch)and(Ry()and(not Q.UnderhandedUpperhand:IsAvailable()and(Q.Crackshot:IsAvailable()and ky()))))))then h=N.CastWithTTD(Q.Vanish,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h.."\040\050\041"end end if Q.Vanish:IsReady()and(Ry()and(not Q.UnderhandedUpperhand:IsAvailable()and(not Q.Crackshot:IsAvailable()and(Q.HiddenOpportunity:IsAvailable()and(E:BuffDown(Q.AudacityBuff)and(E:BuffStack(Q.Opportunity)<6 and oy()))))))then h=N.CastWithTTD(Q.Vanish,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h.."\040\051\041"end end if Q.Vanish:IsReady()and Ry()then if not Q.UnderhandedUpperhand:IsAvailable()and(not Q.Crackshot:IsAvailable()and(not Q.HiddenOpportunity:IsAvailable()and(not Q.FatefulEnding:IsAvailable()and(E:BuffDown(Q.FateboundLuckyCoin)and(E:BuffStack(Q.FateboundCoinTails)>=5 or E:BuffStack(Q.FateboundCoinHeads)>=5)or E:BuffUp(Q.FateboundLuckyCoin and not Q.BetweentheEyes:IsReady())))))then h=N.CastWithTTD(Q.Vanish,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h.."\040\052\041"end end end if Q.Vanish:IsReady()and Ry()then if not Q.UnderhandedUpperhand:IsAvailable()and(not Q.Crackshot:IsAvailable()and(not Q.HiddenOpportunity:IsAvailable()and(not Q.FatefulEnding:IsAvailable()and(Q.TakeEmBySurprise:IsAvailable()and E:BuffDown(Q.TakeEmBySurpriseBuff)))))then h=N.CastWithTTD(Q.Vanish,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h.."\040\053\041"end end end if Q.Shadowmeld:IsAvailable()and(Q.Shadowmeld:IsReady()and(O.ToggleIconFrame:GetToggle(1)and(L:IsSpellInRange(Q.Dispatch)and(ky()and not Q.Vanish:IsReady()))))then h=N.CastWithTTD(Q.Shadowmeld,true,Y.Outlaw.TimeToDie.Stealth,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h end end end local function xy()if O.DebugON()then end if o()and(Q.AdrenalineRush:IsCastable()and(N.TTDCheck(Y.Outlaw.TimeToDie.AdrenalineRush,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)and(not E:BuffUp(Q.AdrenalineRush)and(not ky()or not Q.ImprovedAdrenalineRush:IsAvailable())or E:StealthUp(true,true)and(Q.Crackshot:IsAvailable()and(Q.ImprovedAdrenalineRush:IsAvailable()and r<=2)))))then if Q.ImprovedAdrenalineRush:IsAvailable()then h=iy(Q.AdrenalineRush)if h then return"\065\082 \070\105\110\105\115\104\101\114 \077\097\099\114\111 \049 "..h end else if R(Q.AdrenalineRush,true)then return"\067\097\115\116 \065\100\114\101\110\097\108\105\110\101 \082\117\115\104"end end end if Q.BladeFlurry:IsReady()then if s>=2 and E:BuffRemains(Q.BladeFlurry)<E:GCD()then if O.Cast(Q.BladeFlurry,true)then return"\067\097\115\116 \066\108\097\100\101 \070\108\117\114\114\121"end end end if Q.BladeFlurry:IsReady()and d then if Q.DeftManeuvers:IsAvailable()and(not ky()and(s>=3 and f==s+x(E:BuffUp(Q.Broadside))or s>=5))then if O.Cast(Q.BladeFlurry,true)then return"\067\097\115\116 \066\108\097\100\101 \070\108\117\114\114\121"end end end if Q.RolltheBones:IsReady()then if cy()or Ly()==0 or q.APLVar.RtB_Buffs.MaxRemains<=8 and(Q.Vanish:CooldownRemains()<=3 and Q.Crackshot:IsAvailable())then if O.Cast(Q.RolltheBones,true)then return"\067\097\115\116 \082\111\108\108 \116\104\101 \066\111\110\101\115"end end end if Q.KeepItRolling:IsReady()and(Ly()>=4 and(q.APLVar.RtB_Buffs.MinRemains<3 or E:BuffUp(Q.Broadside)))then if O.Cast(Q.KeepItRolling,true)then return"\067\097\115\116 \075\101\101\112 \105\116 \082\111\108\108\105\110\103"end end if o()and(Q.GhostlyStrike:IsAvailable()and(L:IsSpellInRange(Q.SinisterStrike)and(Q.GhostlyStrike:IsReady()and(D<N.CPMaxSpend()and(L:TimeToDie()>=8 or Y.Commons.Enabled.IgnoreTtdOnBoss and H or z.Buggedmobs[L:NPCID()])))))then if O.Cast(Q.GhostlyStrike,true)then return"\067\097\115\116 \071\104\111\115\116\108\121 \083\116\114\105\107\101"end end if o()and(Y.Commons.Enabled.Trinket1 or Y.Commons.Enabled.Trinket2)then if X(M.ImperfectAscendancySerum)then if not E:StealthUp(true,true)or l.BossFilteredFightRemains("\060\061",22)then if N.CastWithTTD(M.ImperfectAscendancySerum,true,Y.Outlaw.TimeToDie.Trinkets,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)then return"\073\109\112\101\114\102\101\099\116 \065\115\099\101\110\100\097\110\099\121 \083\101\114\117\109"end end end if X(M.MadQueensMandate)then if not E:StealthUp(true,true)or l.BossFilteredFightRemains("\060\061",5)then if N.CastWithTTD(M.MadQueensMandate,true,Y.Outlaw.TimeToDie.Trinkets,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)then return"\077\097\100 \081\117\101\101\110\115 \077\097\110\100\097\116\101"end end end end if Q.KillingSpree:IsCastable()and(L:IsSpellInRange(Q.KillingSpree)and(ky()and not E:StealthUp(true,true)))then if N.CastWithTTD(Q.KillingSpree,true,Y.Outlaw.TimeToDie.KillingSpree,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)then return"\067\097\115\116 \075\105\108\108\105\110\103 \083\112\114\101\101"end end if not E:StealthUp(true,true)and(not Q.Crackshot:IsAvailable()or Q.BetweentheEyes:IsReady())then h=ty()if h then return h end end if o()and(Q.ThistleTea:IsCastable()and(not E:BuffUp(Q.ThistleTea)and(a>=150 or l.BossFilteredFightRemains("\060",Q.ThistleTea:Charges()*6))))then h=N.CastWithTTD(Q.ThistleTea,true,Y.Outlaw.TimeToDie.ThistleTea,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)if h then return h end end if Q.BladeRush:IsCastable()and(L:IsSpellInRange(Q.Ambush)and(e>4 and not E:StealthUp(true,true)))then if O.Cast(Q.BladeRush,true)then return"\067\097\115\116 \066\108\097\100\101 \082\117\115\104"end end if o()and Y.Commons.Enabled.Potions then local S=z.PotionSelected()if S and(S:IsReady()and(E:BloodlustUp()or l.BossFilteredFightRemains("\060",30)or E:BuffUp(Q.AdrenalineRush)))then O.CastMacro(3,nil,nil,S)return"\067\097\115\116 \080\111\116\105\111\110"end end if Y.Commons.Enabled.Racials then if o()and Q.BloodFury:IsCastable()then if O.Cast(Q.BloodFury,true)then return"\067\097\115\116 \066\108\111\111\100 \070\117\114\121"end end if o()and Q.Berserking:IsCastable()then if O.Cast(Q.Berserking,true)then return"\067\097\115\116 \066\101\114\115\101\114\107\105\110\103"end end if o()and Q.Fireblood:IsCastable()then if O.Cast(Q.Fireblood,true)then return"\067\097\115\116 \070\105\114\101\098\108\111\111\100"end end if o()and Q.AncestralCall:IsCastable()then if R(Q.AncestralCall,true)then return"\067\097\115\116 \065\110\099\101\115\116\114\097\108 \067\097\108\108"end end end if o()and(Y.Commons.Enabled.Trinket1 or Y.Commons.Enabled.Trinket2)then local S=E:GetUseableItems(n,13)or E:GetUseableItems(n,14)local B local T=100 if S then B=S:OnUseSpell()T=(B and(B.MaximumRange>0 and B.MaximumRange<=100))and B.MaximumRange or 100 end if S and(E:BuffUp(Q.BetweentheEyes)or l.BossFilteredFightRemains("\060",20)or S:HasStatAnyDps())then if X(S)and N.CastWithTTD(S,true,Y.Outlaw.TimeToDie.Trinkets,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)then return"\071\101\110\101\114\105\099 \117\115\101\095\105\116\101\109\115 \102\111\114 "..S:Name()end end end end local function Cy()if o()and(Q.EchoingReprimand:IsReady()and L:IsSpellInRange(Q.EchoingReprimand))then if O.Cast(Q.EchoingReprimand,true)then return"\067\097\115\116 \069\099\104\111\105\110\103 \082\101\112\114\105\109\097\110\100"end end if Q.Ambush:IsCastable()and(L:IsSpellInRange(Q.Ambush)and(Q.HiddenOpportunity:IsAvailable()and E:BuffUp(Q.AudacityBuff)))then if O.CastPooling(Q.SinisterStrike)then return"\067\097\115\116 \065\109\098\117\115\104 \040\072\105\103\104-\080\114\105\111 \066\117\102\102\101\100\041"end end if Q.FanTheHammer:IsAvailable()and(L:IsSpellInRange(Q.PistolShot)and(Q.Audacity:IsAvailable()and(Q.HiddenOpportunity:IsAvailable()and(E:BuffUp(Q.Opportunity)and E:BuffDown(Q.AudacityBuff)))))then if O.CastPooling(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116 \040\065\117\100\097\099\105\116\121\041"end end if Q.FanTheHammer:IsAvailable()and(L:IsSpellInRange(Q.PistolShot)and(E:BuffUp(Q.Opportunity)and(E:BuffStack(Q.Opportunity)>=6 or E:BuffRemains(Q.Opportunity)<2)))then if O.CastPooling(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116 \040\070\116\072 \068\117\109\112\041"end end if Q.FanTheHammer:IsAvailable()and(L:IsSpellInRange(Q.PistolShot)and(E:BuffUp(Q.Opportunity)and(f>=1+(x(Q.QuickDraw:IsAvailable())+x(E:BuffUp(Q.Broadside)))*(Q.FanTheHammer:TalentRank()+1)or r<=x(Q.Ruthlessness:IsAvailable()))))then if O.CastPooling(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116"end end if not Q.FanTheHammer:IsAvailable()and(L:IsSpellInRange(Q.PistolShot)and(E:BuffUp(Q.Opportunity)and(e>1.5 or f<=1+x(E:BuffUp(Q.Broadside))or Q.QuickDraw:IsAvailable()or Q.Audacity:IsAvailable()and E:BuffDown(Q.AudacityBuff))))then if O.CastPooling(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116"end end if Q.SinisterStrike:IsCastable()and L:IsSpellInRange(Q.SinisterStrike)then if O.CastPooling(Q.SinisterStrike)then return"\067\097\115\116 \083\105\110\105\115\116\101\114 \083\116\114\105\107\101"end end end local function Vy()if K.General.AutoTab and E:AffectingCombat()then local S=E:GetEnemiesInRange(d)local B=L:GUID()for S,T in pairs(S)do if T:GUID()~=B and(not T:IsFacingBlacklisted()and T:DebuffUp(Q.GhostlyStrike))then O.TopPanelAlternative:ChangeIcon(1,3)return"\065\117\116\111 \116\097\098 \116\111 \116\097\114\103\101\116 \071\083"end end end end local function jy()v=O.ToggleIconFrame:GetToggle(2)d=6 r=E:ComboPoints()D=N.EffectiveComboPoints(r)f=E:ComboPointsDeficit()Sy=E:BuffUp(Q.AdrenalineRush,nil,true)and-50 or 0 g=qy()y=E:EnergyRegen()e=ly(Sy)a=E:EnergyDeficitPredicted(nil,Sy)u=E:GetEnemiesInRange(30)A=l.BossFightRemains()H=true if A==11111 then H=false A=l.FightRemains(u,false)end if k()then J=E:GetEnemiesInRange(d)s=#J else s=1 end h=N.Defense()if h then return h end h=N.Poisons()if h then return h end h=s>0 and(not L:IsInRange(d+2)and N.AutoTarget())if h then return h end if not E:AffectingCombat()and Q.Vanish:TimeSinceLastCast()>1 then if not E:StealthUp(false,false,true)then h=N.Stealth(N.StealthSpell())if h then return h end end if N.CombatCheck()or v and z.TargetIsValid()then if not E:StealthUp(false,false,true)then h=N.Stealth(N.StealthSpell())if h then return h end else if Q.BetweentheEyes:CooldownDown()then G=Q.BetweentheEyes:CooldownRemains()+GetTime()end end if o()and(Y.Commons.Enabled.Trinket1 or Y.Commons.Enabled.Trinket2)then if X(M.ImperfectAscendancySerum)then if N.CastWithTTD(M.ImperfectAscendancySerum,true,Y.Outlaw.TimeToDie.Trinkets,Y.Commons.Enabled.IgnoreTtdOnBoss and H,A)then return"\073\109\112\101\114\102\101\099\116 \065\115\099\101\110\100\097\110\099\121 \083\101\114\117\109"end end end if Q.RolltheBones:IsAvailable()and(Q.RolltheBones:IsReady()and(Ly()==0 or cy()))then if O.Cast(Q.RolltheBones)then return"\067\097\115\116 \082\111\108\108 \116\104\101 \066\111\110\101\115"end end if Q.AdrenalineRush:IsReady()and(o()and(Q.ImprovedAdrenalineRush:IsAvailable()and(r<=2 and E:BuffDown(Q.AdrenalineRush))))then if O.Cast(Q.AdrenalineRush)then return"\067\097\115\116 \065\100\114\101\110\097\108\105\110\101 \082\117\115\104"end end if Q.SliceandDice:IsReady()and E:BuffRemains(Q.SliceandDice)<(1+r)*1.8 then if O.CastPooling(Q.SliceandDice)then return"\067\097\115\116 \083\108\105\099\101 \097\110\100 \068\105\099\101 \040\079\112\101\110\101\114\041"end end if E:StealthUp(true,false)then h=Iy()if h then return"\083\116\101\097\108\116\104 \040\079\112\101\110\101\114\041\058 "..h end if Q.KeepItRolling:IsAvailable()and(L:IsSpellInRange(Q.SinisterStrike)and(Q.GhostlyStrike:IsReady()and Q.EchoingReprimand:IsAvailable()))then if R(Q.GhostlyStrike)then return"\067\097\115\116 \071\104\111\115\116\108\121 \083\116\114\105\107\101 \075\105\082 \040\079\112\101\110\101\114\041"end end if Q.Ambush:IsCastable()and(Q.HiddenOpportunity:IsAvailable()and L:IsSpellInRange(Q.SinisterStrike))then if R(Q.Ambush)then return"\067\097\115\116 \065\109\098\117\115\104 \040\079\112\101\110\101\114\041"end else if Q.SinisterStrike:IsCastable()and L:IsSpellInRange(Q.SinisterStrike)then if R(Q.SinisterStrike)then return"\067\097\115\116 \083\105\110\105\115\116\101\114 \083\116\114\105\107\101 \040\079\112\101\110\101\114\041"end end end elseif ky()then h=Zy()if h then return"\070\105\110\105\115\104 \040\079\112\101\110\101\114\041\058 "..h end end if Q.SinisterStrike:IsCastable()and L:IsSpellInRange(Q.SinisterStrike)then if R(Q.SinisterStrike)then return"\067\097\115\116 \083\105\110\105\115\116\101\114 \083\116\114\105\107\101 \040\079\112\101\110\101\114\041"end end end U=G>GetTime()end U=G>GetTime()if Q.FanTheHammer:IsAvailable()and Q.PistolShot:TimeSinceLastCast()<E:GCDRemains()then r=j(r,N.FanTheHammerCP())D=N.EffectiveComboPoints(r)f=E:ComboPointsDeficit()end if N.CombatCheck()then if O.ToggleIconFrame:GetToggle(3)then h=z.InterruptCycle(Q.Kick,d,true,nil,false)if h then return h end h=z.IncorpCycle(Q.Blind,15,true,nil,false)if h then return h end h=Y.Interrupt.UseBlind and z.InterruptCycle(Q.Blind,15,true,nil,true)if h then return h end h=Y.Interrupt.UseKidneyShot and(r>0 and z.InterruptCycle(Q.KidneyShot,d,true,nil,true))if h then return h end h=Y.Interrupt.UseCheapShop and(E:StealthUp(true,true)and z.InterruptCycle(Q.CheapShot,d,true,nil,true))if h then return h end end h=Y.Commons.Enabled.Shiv and z.SootheCycle(Q.Shiv,9,true,Y.Commons.Enabled["\083\104\105\118 \065\117\116\111 \084\097\114\103\101\116"])if h then return h end h=Y.Outlaw.AutoTabGS and Vy()if h then return h end h=xy()if h then return"\067\068\115\058 "..h end if E:StealthUp(true,true)then h=Iy()if h then return"\083\116\101\097\108\116\104\058 "..h end end if ky()then h=Zy()if h then return"\070\105\110\105\115\104\058 "..(h..(" \067\080\058"..(Fy..(" \099\111\117\110\116\058"..Oy))))end O.Cast(Q.PoolEnergy)return"\070\105\110\105\115\104 \080\111\111\108\105\110\103"end h=Cy()if h then return"\066\117\105\108\100\058 "..h end if Y.Commons.Enabled.Racials then if Q.ArcaneTorrent:IsCastable()and(L:IsSpellInRange(Q.SinisterStrike)and a>15+y)then if O.Cast(Q.ArcaneTorrent,true)then return"\067\097\115\116 \065\114\099\097\110\101 \084\111\114\114\101\110\116"end end if Q.ArcanePulse:IsCastable()and L:IsSpellInRange(Q.SinisterStrike)then if O.Cast(Q.ArcanePulse)then return"\067\097\115\116 \065\114\099\097\110\101 \080\117\108\115\101"end end if Q.LightsJudgment:IsCastable()and L:IsInMeleeRange(5)then if O.Cast(Q.LightsJudgment,true)then return"\067\097\115\116 \076\105\103\104\116\115 \074\117\100\103\109\101\110\116"end end if Q.BagofTricks:IsCastable()and L:IsInMeleeRange(5)then if O.Cast(Q.BagofTricks,true)then return"\067\097\115\116 \066\097\103 \111\102 \084\114\105\099\107\115"end end end if Q.PistolShot:IsCastable()and(L:IsSpellInRange(Q.PistolShot)and(not L:IsInRange(d)and(not E:StealthUp(true,true)and(a<25 and(f>=1 or e<=1.2)))))then if O.Cast(Q.PistolShot)then return"\067\097\115\116 \080\105\115\116\111\108 \083\104\111\116 \040\079\079\082\041"end end if not L:IsSpellInRange(Q.Dispatch)then if i(Q.PoolEnergy,false,"\079\079\082")then return"\080\111\111\108 \069\110\101\114\103\121 \040\079\079\082\041"end else if R(Q.PoolEnergy)then return"\080\111\111\108 \069\110\101\114\103\121"end end end end local function Wy()Y.Outlaw.Display()end O.SetAPL(260,jy,Wy)