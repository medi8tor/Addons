local A,Q=...local T=Q.CDsON()local v=HeroLib local n=HeroCache local w=v.Unit local t=w.Player local U=w.Target local x=v.Spell local I=v.Item local k=T.GUISettingsGet()local m=pairs local B=string.lower local z=tostring local r=math.floor T.MainIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\077\097\105\110\073\099\111\110\070\114\097\109\101",UIParent)T.MainIconPartOverlayFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\077\097\105\110\073\099\111\110\080\097\114\116\079\118\101\114\108\097\121\070\114\097\109\101",UIParent)T.MainIconFrame.Part={}T.MainIconFrame.CooldownFrame=CreateFrame("\067\111\111\108\100\111\119\110","\072\101\114\111\082\111\116\097\116\105\111\110\095\077\097\105\110\073\099\111\110\067\111\111\108\100\111\119\110\070\114\097\109\101",T.MainIconFrame,"\065\082\095\067\111\111\108\100\111\119\110\070\114\097\109\101\084\101\109\112\108\097\116\101")T.SmallIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\083\109\097\108\108\073\099\111\110\070\114\097\109\101",UIParent)T.LeftIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\076\101\102\116\073\099\111\110\070\114\097\109\101",UIParent)T.NameplateIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\078\097\109\101\112\108\097\116\101\073\099\111\110\070\114\097\109\101",UIParent)T.NameplateSuggestedIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\078\097\109\101\112\108\097\116\101\083\117\103\103\101\115\116\101\100\073\099\111\110\070\114\097\109\101",UIParent)T.SuggestedIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\083\117\103\103\101\115\116\101\100\073\099\111\110\070\114\097\109\101",UIParent)T.RightSuggestedIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\082\105\103\104\116\083\117\103\103\101\115\116\101\100\073\099\111\110\070\114\097\109\101",UIParent)T.ToggleIconFrame=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\084\111\103\103\108\101\073\099\111\110\070\114\097\109\101",UIParent)T.TopPanelAlternative={}local g={}local s={}function T.TName()return s end local e=0 v:RegisterForEvent(function(A)if GetTime()>e then local A=GetSpecialization()if A~=nil then A=GetSpecializationInfo(A)if A~=nil then T.TopPanelAlternative:ChangeIcon(A,2)e=GetTime()+3 end end end end,"\080\076\065\089\069\082\095\083\080\069\067\073\065\076\073\090\065\084\073\079\078\095\067\072\065\078\071\069\068","\080\076\065\089\069\082\095\069\078\084\069\082\073\078\071\095\087\079\082\076\068")T.PixelPerfectFrame=function(A,Q)local T="\077\111\076\105\098\080\105\120\101\108\080\101\114\102\101\099\116"local v=UIParent if Q then T=T.."\083\099\114\101\101\110"v=nil end T=T.."\070\114\097\109\101"return A:pixelPerfectFrame(T,v)end T.pixelPerfectFrame=function(A,Q,T)if Q and _G[Q]then return _G[Q]end local v=CreateFrame("\070\114\097\109\101",Q,T)v:SetPoint("\066\079\084\084\079\077\076\069\070\084",0,0)A:PixelPerfectScale(v)v:Show()v:SetScript("\079\110\069\118\101\110\116",A.OnPPEvent)v:RegisterEvent("\068\073\083\080\076\065\089\095\083\073\090\069\095\067\072\065\078\071\069\068")if T~=nil and T~=WorldFrame then v:RegisterEvent("\085\073\095\083\067\065\076\069\095\067\072\065\078\071\069\068")end return v end T.PixelPerfectScale=function(A,Q)local T,v=GetPhysicalScreenSize()local n=Q:GetParent()if not n then Q:SetScale(1)Q:SetAllPoints()n=Q else Q:SetSize(T,v)end local w=n:GetWidth()/T local t=n:GetHeight()/v Q:SetScale(w)end local p=T.GetTexture(x(999900))function T.ResetIcons()T.MainIconFrame:Hide()if k.General.BlackBorderIcon then T.MainIconFrame.Backdrop:Hide()end T.MainIconPartOverlayFrame:Hide()T.MainIconFrame:HideParts()T.SmallIconFrame:HideIcons()T.CastOffGCDOffset=1 T.Nameplate.HideIcons()T.CastLeftOffset=1 T.SuggestedIconFrame:HideIcon()if k.General.BlackBorderIcon then T.SuggestedIconFrame.Backdrop:Hide()end T.CastSuggestedOffset=1 T.RightSuggestedIconFrame:HideIcon()if k.General.BlackBorderIcon then T.RightSuggestedIconFrame.Backdrop:Hide()end T.CastRightSuggestedOffset=1 if k.General.HideToggleIcons then T.ToggleIconFrame:Hide()end if not k.General.HideToggleIcons then T.ToggleIconFrame:SetAlpha(k.General.SetAlpha)end end function T.CreateBackdrop(v,A,Q)if A.Backdrop or not k.General.BlackBorderIcon then return end local n=CreateFrame("\070\114\097\109\101",nil,A,BackdropTemplateMixin and"\066\097\099\107\100\114\111\112\084\101\109\112\108\097\116\101")A.Backdrop=n n:ClearAllPoints()n:SetPoint("\084\079\080\076\069\070\084",A,"\084\079\080\076\069\070\084",-1,1)n:SetPoint("\066\079\084\084\079\077\082\073\071\072\084",A,"\066\079\084\084\079\077\082\073\071\072\084",1,-1)n:SetBackdrop({bgFile="\073\110\116\101\114\102\097\099\101\092\067\104\097\116\070\114\097\109\101\092\067\104\097\116\070\114\097\109\101\066\097\099\107\103\114\111\117\110\100";edgeFile="\073\110\116\101\114\102\097\099\101\092\067\104\097\116\070\114\097\109\101\092\067\104\097\116\070\114\097\109\101\066\097\099\107\103\114\111\117\110\100",tile=false;tileSize=0,edgeSize=1,insets={left=0;right=0,top=0,bottom=0}})n:SetBackdropBorderColor(0,0,0)n:SetBackdropColor(0,0,0,1)if not Q then Q=T.MainFrame:GetFrameStrata()end n:SetFrameStrata(Q)if A:GetFrameLevel()-2>=0 then n:SetFrameLevel(A:GetFrameLevel()-2)else n:SetFrameLevel(0)end end local function d()if GetCVar("\067\111\110\116\114\097\115\116")~="\053\048"then SetCVar("\067\111\110\116\114\097\115\116",50)print("\067\111\110\116\114\097\115\116 \115\104\111\117\108\100 \098\101 \053\048")end if GetCVar("\066\114\105\103\104\116\110\101\115\115")~="\053\048"then SetCVar("\066\114\105\103\104\116\110\101\115\115",50)print("\066\114\105\103\104\116\110\101\115\115 \115\104\111\117\108\100 \098\101 \053\048")end if GetCVar("\071\097\109\109\097")~="\049\046\048\048\048\048\048\048"then SetCVar("\071\097\109\109\097","\049\046\048\048\048\048\048\048")print("\071\097\109\109\097 \115\104\111\117\108\100 \098\101 \049")end if GetCVar("\099\111\108\111\114\098\108\105\110\100\115\105\109\117\108\097\116\111\114")~="\048"then SetCVar("\099\111\108\111\114\098\108\105\110\100\115\105\109\117\108\097\116\111\114",0)end if GetCVar("\100\111\078\111\116\070\108\097\115\104\076\111\119\072\101\097\108\116\104\087\097\114\110\105\110\103")~="\049"then SetCVar("\100\111\078\111\116\070\108\097\115\104\076\111\119\072\101\097\108\116\104\087\097\114\110\105\110\103",1)end if GetCVar("\115\099\114\101\101\110\115\104\111\116\081\117\097\108\105\116\121")~="\049\048"then SetCVar("\115\099\114\101\101\110\115\104\111\116\081\117\097\108\105\116\121",10)end if GetCVar("\110\097\109\101\112\108\097\116\101\083\104\111\119\065\108\108")=="\048"then end if GetCVar("\110\097\109\101\112\108\097\116\101\083\104\111\119\069\110\101\109\105\101\115")~="\049"then SetCVar("\110\097\109\101\112\108\097\116\101\083\104\111\119\069\110\101\109\105\101\115",1)print("\069\110\101\109\121 \110\097\109\101\112\108\097\116\101\115 \115\104\111\117\108\100 \098\101 \101\110\097\098\108\101\100")end if GetCVar("\083\112\101\108\108\081\117\101\117\101\087\105\110\100\111\119")~="\050\053\048"then SetCVar("\083\112\101\108\108\081\117\101\117\101\087\105\110\100\111\119",250)end if GetCVar("\115\121\110\099\104\114\111\110\105\122\101\077\097\099\114\111\115")~="\049"then SetCVar("\115\121\110\099\104\114\111\110\105\122\101\077\097\099\114\111\115",0)end if GetCVar("\115\121\110\099\104\114\111\110\105\122\101\067\111\110\102\105\103 ")~="\049"then SetCVar("\115\121\110\099\104\114\111\110\105\122\101\067\111\110\102\105\103 ",0)end end function T.UpdateMacro(T,A,Q)local v=select(2,UnitClass("\112\108\097\121\101\114"))local n=GetSpecialization()end function g.Init(A)g.MOUSEOVER=1 g.FOCUS=2 g.PLAYER=3 g.PARTYPLAYER=100 for A=1,4,1 do g["\080\065\082\084\089"..A]=10+A end for A=1,40,1 do g["\082\065\073\068"..A]=100+A end end function s.Init(A)s.MOUSEOVER="\077\079\085\083\069\079\086\069\082"s.FOCUS="\070\079\067\085\083"s.PLAYER="\080\076\065\089\069\082"s.PARTYPLAYER="\080\065\082\084\089\080\076\065\089\069\082"for A=1,4,1 do s["\080\065\082\084\089"..A]="\080\065\082\084\089"..A end for A=1,40,1 do s["\082\065\073\068"..A]="\082\065\073\068"..A end end T.Ascended=T.Ascended or{}T.Ascended.SpellID=0 T.Ascended.TargetOffset=0 T.Ascended.SpecID=0 T.Ascended.AutoTab=0 T.Ascended.four=0 T.Ascended.five=0 T.Ascended.six=0 T.Ascended.seven=0 function T.MainIconFrame.Init(A)d()g:Init()s:Init()T.TopPanelAlternative.topIcons=T:PixelPerfectFrame("\084\111\112\073\099\111\110\115")T.TopPanelAlternative.topIcons:SetFrameStrata("\072\073\071\072")T.TopPanelAlternative.Icons={}local Q=1 T.DelayTimer=0 local v=GetSpecialization()if v~=nil then v=GetSpecializationInfo(v)if v~=nil then T.TopPanelAlternative:ChangeIcon(v,2)e=GetTime()+3 end end A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(64)A:SetHeight(64)A:SetPoint("\066\079\084\084\079\077\082\073\071\072\084",T.MainFrame,"\066\079\084\084\079\077\082\073\071\072\084",0,0)A.Texture=A:CreateTexture(nil,"\065\082\084\087\079\082\075")A.Texture:SetAllPoints(A)A.CooldownFrame:SetAllPoints(A)T.MainIconPartOverlayFrame:SetFrameStrata(A:GetFrameStrata())T.MainIconPartOverlayFrame:SetFrameLevel(A:GetFrameLevel()+1)T.MainIconPartOverlayFrame:SetWidth(64)T.MainIconPartOverlayFrame:SetHeight(64)T.MainIconPartOverlayFrame:SetPoint("\076\101\102\116",A,"\076\101\102\116",0,0)T.MainIconPartOverlayFrame.Texture=T.MainIconPartOverlayFrame:CreateTexture(nil,"\065\082\084\087\079\082\075")T.MainIconPartOverlayFrame.Texture:SetAllPoints(T.MainIconPartOverlayFrame)local n=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")A.Keybind=n n:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",14,"\079\085\084\076\073\078\069")n:SetAllPoints(true)n:SetJustifyH("\082\073\071\072\084")n:SetJustifyV("\084\079\080")n:SetPoint("\084\079\080\082\073\071\072\084")n:SetTextColor(.8,.8,.8,1)n:SetText("")local w=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")A.Target=w w:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",10,"\079\085\084\076\073\078\069")w:SetAllPoints(true)w:SetJustifyH("\067\101\110\116\101\114")w:SetJustifyV("\077\073\068\068\076\069")w:SetPoint("\084\079\080\082\073\071\072\084")w:SetTextColor(.8,.8,.8,1)w:SetText("")local t=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\078\111\114\109\097\108")A.Text=t t:SetAllPoints(true)t:SetJustifyH("\067\069\078\084\069\082")t:SetJustifyV("\077\073\068\068\076\069")t:SetPoint("\067\069\078\084\069\082")t:SetTextColor(1,1,1,1)t:SetText("")if k.General.BlackBorderIcon then A.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(A)end A:InitParts()A:Show()end function T.TopPanelAlternative.ChangeIcon(v,A,Q)if A<0 or A>16581374 then print("\073\110\112\117\116 \111\117\116 \111\102 \114\097\110\103\101")return end if Q==0 then T.Ascended.SpellID=A elseif Q==1 then T.Ascended.TargetOffset=A elseif Q==2 then T.Ascended.SpecID=A elseif Q==3 then T.Ascended.AutoTab=A elseif Q==4 then T.Ascended.four=A elseif Q==5 then T.Ascended.five=A elseif Q==6 then T.Ascended.six=A elseif Q==7 then T.Ascended.seven=A end if T.Ascended.AutoTab~=0 then end if T.Ascended.TargetOffset~=0 then end end function T.MainIconFrame.ChangeIcon(t,A,Q,v,n,w)t.ID=w t.Texture:SetTexture(A)if v==false and not v==nil then t.Texture:SetVertexColor(.5,.5,1)elseif n then t.Texture:SetVertexColor(1,.5,.5)if not T.Instant then T.TopPanelAlternative:ChangeIcon(0,0)end else if not T.Instant then if GetTime()>T.DelayTimer then T.TopPanelAlternative:ChangeIcon(w,0)else T.TopPanelAlternative:ChangeIcon(0,0)end end t.Texture:SetVertexColor(1,1,1)end t.Texture:SetAllPoints(t)if Q then t.Keybind:SetText(Q)t.Keybind:SetScale(k.Scaling.ScaleHotkey)else t.Keybind:SetText("")end t.Text:SetText("")if k.General.BlackBorderIcon and not t.Backdrop:IsVisible()then t.Backdrop:Show()end t:SetAlpha(k.General.SetAlpha)if not t:IsVisible()then t:Show()end end function T.MainIconFrame.OverlayText(T,A,Q)local v=T.Text:GetFont()if Q then T.Text:SetFont(v,Q)else T.Text:SetFont(v,12)end T.Text:SetText(A)end function T.MainIconFrame.SetCooldown(v,A,Q)if A==0 or Q==0 then v.CooldownFrame:SetCooldown(0,0)v.CooldownFrame:Hide()T.DelayTimer=0 return end T.DelayTimer=(A+Q)-.3 v.CooldownFrame:SetCooldown(A,Q)end function T.MainIconFrame.InitParts(A)T.MainIconPartOverlayFrame:Show()for Q=1,T.MaxQueuedCasts,1 do local v=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\077\097\105\110\073\099\111\110\080\097\114\116\070\114\097\109\101"..z(Q),UIParent)A.Part[Q]=v v:SetFrameStrata(A:GetFrameStrata())v:SetFrameLevel(A:GetFrameLevel()+1)v:SetWidth(64)v:SetHeight(64)v:SetPoint("\076\101\102\116",A,"\076\101\102\116",0,0)v.Texture=v:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")v.Keybind=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")v.Keybind:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",13,"\079\085\084\076\073\078\069")v.Keybind:SetAllPoints(true)v.Keybind:SetJustifyH("\082\073\071\072\084")v.Keybind:SetJustifyV("\084\079\080")v.Keybind:SetPoint("\084\079\080\082\073\071\072\084")v.Keybind:SetTextColor(.8,.8,.8,1)v.Keybind:SetText("")if k.General.BlackBorderIcon then v.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(v)end v:Show()end end local F,S function T.MainIconFrame.SetupParts(v,A,Q)F=#A S=T.MainIconPartOverlayFrame.Texture:GetWidth()/F local n,w,t,U,x,I,m,B=T.MainIconPartOverlayFrame.Texture:GetTexCoord()for z=1,F,1 do local r=v.Part[z]r:SetWidth(S)r:SetHeight(S*F)r:ClearAllPoints()local g,s=T.MainIconPartOverlayFrame.Texture:GetPoint()if T.MainIconPartOverlayFrame.__MSQ_NormalColor then if z==T.MaxQueuedCasts or z==F then r:SetPoint("\067\101\110\116\101\114",s,"\067\101\110\116\101\114",S/(4-F),0)else r:SetPoint("\067\101\110\116\101\114",s,"\067\101\110\116\101\114",(S/(4-F))*(z-2),0)end else r:SetPoint("\076\101\102\116",s,"\076\101\102\116",S*(z-1),0)end r.Texture:SetTexture(A[z])r.Texture:SetAllPoints(r)if r.Backdrop then if T.MainIconPartOverlayFrame.__MSQ_NormalColor then r.Backdrop:Hide()else r.Backdrop:Show()end end local e=k.General.BlackBorderIcon and not T.MainIconPartOverlayFrame.__MSQ_NormalColor local p=(z-1)/F local d=z/F r.Texture:SetTexCoord(z==1 and(e and n+.08 or n)or x*p,z==1 and(e and w+.08 or w)or e and I+.08 or I,z==1 and(e and t+.08 or t)or m*p,z==1 and(e and U-.08 or U)or e and B-.08 or B,(z==F and e)and x*d-.08 or x*d,e and I+.08 or I,(z==F and e)and m*d-.08 or m*d,e and B-.08 or B)if Q[z]then r.Keybind:SetText(Q[z])r.Keybind:SetScale(k.Scaling.ScaleHotkey)else r.Keybind:SetText("")end if not r:IsVisible()then T.MainIconPartOverlayFrame:Show()r:Show()end end end function T.MainIconFrame.HideParts(A)A.ID=nil T.MainIconPartOverlayFrame:Hide()T.TopPanelAlternative:ChangeIcon(0,0)T.TopPanelAlternative:ChangeIcon(0,3)T.MainIconFrame.Target:SetText("")T.TopPanelAlternative:ChangeIcon(0,1)for Q=1,#A.Part,1 do A.Part[Q].Keybind:SetText("")A.Part[Q]:Hide()end end function T.MainIconFrame.getIconID(A)if A.ID then return A.ID end return nil end function T.SmallIconFrame.Init(A)A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(64)A:SetHeight(32)A:SetPoint("\066\079\084\084\079\077\076\069\070\084",T.MainIconFrame,"\084\079\080\076\069\070\084",0,k.General.BlackBorderIcon and 1 or 0)A.Icon={}A:CreateIcons(1,"\076\069\070\084")A:CreateIcons(2,"\082\073\071\072\084")A:Show()end function T.SmallIconFrame.CreateIcons(v,A,Q)local n=CreateFrame("\070\114\097\109\101","\072\101\114\111\082\111\116\097\116\105\111\110\095\083\109\097\108\108\073\099\111\110\070\114\097\109\101"..z(A),UIParent)v.Icon[A]=n n:SetFrameStrata(v:GetFrameStrata())n:SetFrameLevel(v:GetFrameLevel()-1)n:SetWidth(k.General.BlackBorderIcon and 30 or 32)n:SetHeight(k.General.BlackBorderIcon and 30 or 32)n:SetPoint(Q,v,Q,0,0)n.Texture=n:CreateTexture(nil,"\065\082\084\087\079\082\075")local w=n:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")n.Keybind=w w:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",12,"\079\085\084\076\073\078\069")w:SetAllPoints(true)w:SetJustifyH("\082\073\071\072\084")w:SetJustifyV("\084\079\080")w:SetPoint("\084\079\080\082\073\071\072\084")w:SetTextColor(.8,.8,.8,1)w:SetText("")if k.General.BlackBorderIcon then n.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(n)end n:Show()end function T.SmallIconFrame.ChangeIcon(t,A,Q,v,n,w)local U=t.Icon[A]U.Texture:SetTexture(Q)U.Texture:SetAllPoints(U)if n then U.Texture:SetVertexColor(1,.5,.5)T.Instant=false else T.Instant=true T.TopPanelAlternative:ChangeIcon(w,0)U.Texture:SetVertexColor(1,1,1)end if v then U.Keybind:SetText(v)U.Keybind:SetScale(k.Scaling.ScaleHotkey*.85)else U.Keybind:SetText("")end U:SetAlpha(k.General.SetAlpha)if not U:IsVisible()then U:Show()end end function T.SmallIconFrame.GetIcon(Q,A)local T=Q.Icon[A]if T and T:IsVisible()then return T.Texture:GetTexture()end return nil end function T.SmallIconFrame.GetKeybind(Q,A)local T=Q.Icon[A]if T and T:IsVisible()then return T.Keybind:GetText()end return""end function T.SmallIconFrame.HideIcons(A)for Q=1,#A.Icon,1 do A.Icon[Q]:Hide()end T.TopPanelAlternative:ChangeIcon(0,0)T.Instant=false end function T.LeftIconFrame.Init(A)A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(48)A:SetHeight(48)A:SetPoint("\082\073\071\072\084",T.MainIconFrame,"\076\069\070\084",k.General.BlackBorderIcon and-1 or 0,0)A.Texture=A:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")if k.General.BlackBorderIcon then A.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(A)end local Q=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")A.Keybind=Q Q:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",14,"\079\085\084\076\073\078\069")Q:SetAllPoints(true)Q:SetJustifyH("\082\073\071\072\084")Q:SetJustifyV("\084\079\080")Q:SetPoint("\084\079\080\082\073\071\072\084")Q:SetTextColor(.8,.8,.8,1)Q:SetText("")A:Show()end function T.LeftIconFrame.ChangeIcon(T,A,Q)T.Texture:SetTexture(A)T.Texture:SetAllPoints(T)if k.General.BlackBorderIcon and not T.Backdrop:IsVisible()then T.Backdrop:Show()end if Q then T.Keybind:SetText(Q)T.Keybind:SetScale(k.Scaling.ScaleHotkey)else T.Keybind:SetText("")end T:SetAlpha(k.General.SetAlpha)if not T:IsVisible()then T:Show()end end T.Nameplate={MainInitialized=false,SuggestedInitialized=false}function T.Nameplate.AddIcon(A,Q,v)if k.General.NamePlateIconAnchor=="\068\105\115\097\098\108\101"then return true end local n=B(A.UnitID)local w=C_NamePlate.GetNamePlateForUnit(n)if v then T.TopPanelAlternative:ChangeIcon(1,3)end if w then local v=GetScreenHeight()local n=v>768 and 768/v or 1 local t=w:GetHeight()/n local U if k.General.NamePlateIconAnchor=="\076\105\102\101 \066\097\114"then if _G.ElvUI and _G.ElvUI[1].charSettings.profile.nameplates.enable then U=w.unitFrame.Health t=U:GetWidth()/3.5 elseif _G.ShestakUI and _G.ShestakUI[2].nameplate.enable then U=w.unitFrame.Health t=(U:GetWidth()/n)/3.5 else U=w.UnitFrame.healthBar t=(U:GetWidth()/n)/3.5 end end local x=T.NameplateIconFrame if not T.Nameplate.MainInitialized then x:SetFrameStrata(w:GetFrameStrata())x:SetFrameLevel(w:GetFrameLevel()+50)x:SetWidth(t)x:SetHeight(t)x.Texture=x:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")if k.General.BlackBorderIcon then x.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(x,w:GetFrameStrata())end T.Nameplate.MainInitialized=true end x.Texture:SetTexture(T.GetTexture(Q))x.Texture:SetAllPoints(x)local I=1 x.Texture:SetAlpha(I)x:ClearAllPoints()x:SetAlpha(k.General.SetAlpha)if not x:IsVisible()then if k.General.NamePlateIconAnchor=="\076\105\102\101 \066\097\114"then x:SetPoint("\067\069\078\084\069\082",U)else x:SetPoint("\067\069\078\084\069\082",w)end x:Show()end T.LastUnitCycled=A T.LastUnitCycledTime=GetTime()return true end return false end function T.Nameplate.AddSuggestedIcon(A,Q)if k.General.NamePlateIconAnchor=="\068\105\115\097\098\108\101"then return true end local v=B(A.UnitID)local n=C_NamePlate.GetNamePlateForUnit(v)if n then local v=GetScreenHeight()local w=v>768 and 768/v or 1 local t=n:GetHeight()/w local U if k.General.NamePlateIconAnchor=="\076\105\102\101 \066\097\114"then if _G.ElvUI and _G.ElvUI[1].charSettings.profile.nameplates.enable then U=n.unitFrame.Health t=U:GetWidth()/3.5 elseif _G.ShestakUI and _G.ShestakUI[2].nameplate.enable then U=n.unitFrame.Health t=(U:GetWidth()/w)/3.5 else U=n.UnitFrame.healthBar t=(U:GetWidth()/w)/3.5 end end local x=k.Scaling.ScaleNameplateIcon t=t*x local I=T.NameplateSuggestedIconFrame if not T.Nameplate.SuggestedInitialized then I:SetFrameStrata(n:GetFrameStrata())I:SetFrameLevel(n:GetFrameLevel()+50)I:SetWidth(t)I:SetHeight(t)I.Texture=I:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")if k.General.BlackBorderIcon then I.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(I,n:GetFrameStrata())end T.Nameplate.SuggestedInitialized=true end local m=r(IconFrame:GetWidth()+.5)local B=r(t+.5)if m~=B then IconFrame:SetWidth(t)IconFrame:SetHeight(t)end I.Texture:SetTexture(T.GetTexture(Q))I.Texture:SetAllPoints(I)local z=1 I.Texture:SetAlpha(z)I:ClearAllPoints()I:SetAlpha(k.General.SetAlpha)if not I:IsVisible()then if k.General.NamePlateIconAnchor=="\076\105\102\101 \066\097\114"then I:SetPoint("\082\073\071\072\084",U)else I:SetPoint("\082\073\071\072\084",n)end I:Show()end T.LastUnitCycled=A T.LastUnitCycledTime=GetTime()return true end return false end function T.Nameplate.HideIcons()T.NameplateIconFrame:Hide()T.LeftIconFrame:Hide()T.TopPanelAlternative:ChangeIcon(0,3)T.NameplateSuggestedIconFrame:Hide()end function T.SuggestedIconFrame.Init(A)A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(32)A:SetHeight(32)A:SetPoint("\066\079\084\084\079\077",T.MainIconFrame,"\076\069\070\084",-T.LeftIconFrame:GetWidth()/2,T.LeftIconFrame:GetHeight()/2+(k.General.BlackBorderIcon and 3 or 4))A.Texture=A:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")if k.General.BlackBorderIcon then A.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(A)end local Q=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")A.Keybind=Q Q:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",14,"\079\085\084\076\073\078\069")Q:SetAllPoints(true)Q:SetJustifyH("\082\073\071\072\084")Q:SetJustifyV("\084\079\080")Q:SetPoint("\084\079\080\082\073\071\072\084")Q:SetTextColor(.8,.8,.8,1)Q:SetText("")A:Show()end function T.SuggestedIconFrame.ChangeIcon(n,A,Q,T,v)n.ID=v n.Texture:SetTexture(A)n.Texture:SetAllPoints(n)if T then n.Texture:SetVertexColor(1,.5,.5)else n.Texture:SetVertexColor(1,1,1)end if k.General.BlackBorderIcon and not n.Backdrop:IsVisible()then n.Backdrop:Show()end if Q then n.Keybind:SetText(Q)n.Keybind:SetScale(k.Scaling.ScaleHotkey*.85)else n.Keybind:SetText("")end n:SetAlpha(k.General.SetAlpha)if not n:IsVisible()then n:Show()end end function T.SuggestedIconFrame.HideIcon(A)A.ID=nil T.SuggestedIconFrame:Hide()end function T.SuggestedIconFrame.getIconID(A)if A.ID then return A.ID end return nil end function T.RightSuggestedIconFrame.Init(A)A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(100)A:SetHeight(64)A:SetPoint("\066\079\084\084\079\077",T.MainIconFrame,"\076\069\070\084",T.LeftIconFrame:GetWidth()/2,T.LeftIconFrame:GetHeight()/2+(k.General.BlackBorderIcon and 3 or 4))A.Texture=A:CreateTexture(nil,"\066\065\067\075\071\082\079\085\078\068")if k.General.BlackBorderIcon then A.Texture:SetTexCoord(.08,.92,.08,.92)T:CreateBackdrop(A)end local Q=A:CreateFontString(nil,"\079\086\069\082\076\065\089","\071\097\109\101\070\111\110\116\072\105\103\104\108\105\103\104\116")A.Keybind=Q Q:SetFont("\070\111\110\116\115\092\070\082\073\090\081\084\095\095\046\084\084\070",12,"\079\085\084\076\073\078\069")Q:SetAllPoints(true)Q:SetJustifyH("\067\101\110\116\101\114")Q:SetJustifyV("\084\079\080")Q:SetPoint("\084\079\080\082\073\071\072\084")Q:SetTextColor(.8,.8,.8,1)Q:SetText("")A:Show()end function T.RightSuggestedIconFrame.ChangeIcon(n,A,Q,T,v)n.ID=v n.Texture:SetTexture(A)n.Texture:SetAllPoints(n)if T then n.Texture:SetVertexColor(1,.5,.5)else n.Texture:SetVertexColor(1,1,1)end if k.General.BlackBorderIcon and not n.Backdrop:IsVisible()then n.Backdrop:Show()end if Q then n.Keybind:SetText(Q)n.Keybind:SetScale(k.Scaling.ScaleHotkey*.85)else n.Keybind:SetText("")end n:SetAlpha(k.General.SetAlpha)if not n:IsVisible()then n:Show()end end function T.RightSuggestedIconFrame.HideIcon(A)A.ID=nil T.RightSuggestedIconFrame:Hide()end function T.RightSuggestedIconFrame.getIconID(A)if A.ID then return A.ID end return nil end function T.FocTarget() end T.CastRightSuggestedOffset=1 function T.CastTarget(A,Q,v,n,w,t)if Q and g[Q]then T.TopPanelAlternative:ChangeIcon(g[Q],1)T.MainIconFrame.Target:SetText(Q)T.MainIconFrame.Target:SetScale(k.Scaling.ScaleHotkey)return T.Cast(A,v,n,w,t)else T.MainIconFrame.Target:SetText("")T.TopPanelAlternative:ChangeIcon(0,1)return false end end function T.ToggleIconFrame.Init(A)A:SetFrameStrata(T.MainFrame:GetFrameStrata())A:SetFrameLevel(T.MainFrame:GetFrameLevel()-1)A:SetWidth(64)A:SetHeight(20)if HeroRotationDB and(HeroRotationDB.ButtonsFramePos and type(HeroRotationDB.ButtonsFramePos[2])~="\115\116\114\105\110\103")then A:ResetAnchor()end if HeroRotationDB and HeroRotationDB.ButtonsFramePos then A:SetPoint(HeroRotationDB.ButtonsFramePos[1],_G[HeroRotationDB.ButtonsFramePos[2]],HeroRotationDB.ButtonsFramePos[3],HeroRotationDB.ButtonsFramePos[4],HeroRotationDB.ButtonsFramePos[5])else A:SetPoint("\084\079\080\076\069\070\084",T.MainIconFrame,"\066\079\084\084\079\077\076\069\070\084",0,k.General.BlackBorderIcon and-3 or 0)end local function Q(A)A:StartMoving()end A:SetScript("\079\110\077\111\117\115\101\068\111\119\110",Q)local function v(A)A:StopMovingOrSizing()if not HeroRotationDB then HeroRotationDB={}end local Q,T,v,n,w,t Q,T,v,n,w=A:GetPoint()if not T then t="\085\073\080\097\114\101\110\116"else t=T:GetName()end HeroRotationDB.ButtonsFramePos={Q,t;v,n;w}end A:SetScript("\079\110\077\111\117\115\101\085\112",v)A:SetScript("\079\110\072\105\100\101",v)A:Show()A.Button={}A:AddButton("\067",1,"\067\068\115","\099\100\115")A:AddButton("\065",2,"\065\111\069","\097\111\101")A:AddButton("\079",3,"\079\110\047\079\102\102","\116\111\103\103\108\101")end function T.ToggleIconFrame.ResetAnchor(A)A:SetPoint("\084\079\080\076\069\070\084",T.MainIconFrame,"\066\079\084\084\079\077\076\069\070\084",0,k.General.BlackBorderIcon and-3 or 0)HeroRotationDB.ButtonsFramePos=false end function T.ToggleIconFrame.AddButtonCustom(w,A,Q,v,n)w:AddButton(A,Q+3,v,n,2)T.CmdHandlerPar[n]=Q+3 T.CmdHandlerName[n]=v end function T.ToggleIconFrame.GetToggle(Q,A)return HeroRotationCharDB.Toggles[A+5]end function T.ToggleIconFrame.AddButton(t,A,Q,v,n,w)local U=CreateFrame("\066\117\116\116\111\110","\036\112\097\114\101\110\116\066\117\116\116\111\110"..z(Q),t)w=w or 0 U:SetFrameStrata(t:GetFrameStrata())U:SetFrameLevel(t:GetFrameLevel()-1)U:SetWidth(20)U:SetHeight(20)U:SetPoint("\076\069\070\084",t,"\076\069\070\084",20*(Q-1)+Q,0)if v then U:SetScript("\079\110\069\110\116\101\114",function()Mixin(GameTooltip,BackdropTemplateMixin)GameTooltip:SetOwner(T.ToggleIconFrame,"\065\078\067\072\079\082\095\066\079\084\084\079\077",0,0)GameTooltip:ClearLines()GameTooltip:SetBackdropColor(0,0,0,1)GameTooltip:SetText(v,nil,nil,nil,1,true)GameTooltip:Show()end)U:SetScript("\079\110\076\101\097\118\101",function()GameTooltip:Hide()end)end U:SetNormalFontObject("\071\097\109\101\070\111\110\116\078\111\114\109\097\108\083\109\097\108\108")U.text=A local x=U:CreateTexture()x:SetTexture("\073\110\116\101\114\102\097\099\101\047\066\117\116\116\111\110\115\047\085\073-\083\105\108\118\101\114-\066\117\116\116\111\110-\085\112")x:SetTexCoord(0,.625,0,.7875)x:SetAllPoints()U:SetNormalTexture(x)local I=U:CreateTexture()I:SetTexture("\073\110\116\101\114\102\097\099\101\047\066\117\116\116\111\110\115\047\085\073-\083\105\108\118\101\114-\066\117\116\116\111\110-\072\105\103\104\108\105\103\104\116")I:SetTexCoord(0,.625,0,.7875)I:SetAllPoints()U:SetHighlightTexture(I)local k=U:CreateTexture()k:SetTexture("\073\110\116\101\114\102\097\099\101\047\066\117\116\116\111\110\115\047\085\073-\083\105\108\118\101\114-\066\117\116\116\111\110-\068\111\119\110")k:SetTexCoord(0,.625,0,.7875)k:SetAllPoints()U:SetPushedTexture(k)if type(HeroRotationCharDB)~="\116\097\098\108\101"then HeroRotationCharDB={}end if type(HeroRotationCharDB.Toggles)~="\116\097\098\108\101"then HeroRotationCharDB.Toggles={}end if type(HeroRotationCharDB.Toggles[Q+w])~="\098\111\111\108\101\097\110"then HeroRotationCharDB.Toggles[Q+w]=true end U:SetScript("\079\110\077\111\117\115\101\068\111\119\110",function(A,Q)if Q=="\076\101\102\116\066\117\116\116\111\110"then T.CmdHandler(n)end end)t.Button[Q]=U T.ToggleIconFrame:UpdateButtonText(Q,w)U:Show()end function T.ToggleIconFrame.UpdateButtonText(T,A,Q)Q=Q or 0 if HeroRotationCharDB.Toggles[A+Q]then T.Button[A]:SetFormattedText("\124\099\102\102\048\048\102\102\048\048\037\115\124\114",T.Button[A].text)else T.Button[A]:SetFormattedText("\124\099\102\102\102\102\048\048\048\048\037\115\124\114",T.Button[A].text)end end local q={{2047,192},{65535,224};{2097151;240}}local function Y(A)if A<128 then return string.char(A)end local Q={}for T,v in ipairs(q)do if A<=v[1]then for T=T+1,2,-1 do local v=A%64 A=(A-v)/64 Q[T]=string.char(128+v)end Q[1]=string.char(v[2]+A)break end end return table.concat(Q)end local function V(A,Q)local T=Q or GetBuildInfo()local v=""local n=string.len(T)local w=1 for Q=1,string.len(A),3 do local t=string.sub(A,Q,Q+2)local U=tonumber(t,10)local x=string.byte(T,w)local I=bit.bxor(U,x)v=v..Y(I)w=w%n+1 end return v end if Binds then local A=V(Binds)A=assert(loadstring(A))function T.Binding()A()end end