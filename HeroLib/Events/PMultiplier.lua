local G,U=...local h=HeroCache local w=U.Unit local i=w.Player local Z=w.Pet local M=w.Target local d=U.Spell local O=U.Item local c=pairs local C=GetTime local H={}local W={}function d.RegisterPMultiplier(G,...)local U={...}local h=G:ID()local w=U[1]if type(w)=="\116\097\098\108\101"and w.SpellID then h=(table.remove(U,1)).SpellID end W[h]=G.SpellID H[G.SpellID]={Buffs=U,Units={}}end local function k(G)local U=G:Name()if U then return"\089\111\117 \102\111\114\103\111\116 \116\111 \114\101\103\105\115\116\101\114 \116\104\101 \115\112\101\108\108\058 "..(U.." \105\110 \080\077\117\108\116\105\112\108\105\101\114 \104\097\110\100\108\101\114\046")else return"\089\111\117 \102\111\114\103\111\116 \116\111 \114\101\103\105\115\116\101\114 \116\104\101 \115\112\101\108\108 \111\098\106\101\099\116\046"end end local function Y(G)local U=1 for h=1,#G.Buffs,1 do local w=G.Buffs[h]if type(w)=="\102\117\110\099\116\105\111\110"then U=U*w()else local G=w[1]local h=w[2]if i:BuffUp(G)or G:TimeSinceLastRemovedOnPlayer()<.1 then local G=type(h)if G=="\110\117\109\098\101\114"then U=U*h elseif G=="\102\117\110\099\116\105\111\110"then U=U*h()end end end end return U end U:RegisterForSelfCombatEvent(function(G,U,h,w,i,Z,M,d,O,c,W,k)local n=H[k]if not n then return end local g=Y(n)local o=n.Units[d]if o then o.PMultiplier=g o.Time=C()else n.Units[d]={PMultiplier=g;Time=C(),Applied=false}end end,"\083\080\069\076\076\095\067\065\083\084\095\083\085\067\067\069\083\083")U:RegisterForSelfCombatEvent(function(G,U,h,w,i,Z,M,d,O,c,k,Y)local n=W[Y]if not n then return end local g=H[n]if not g then return end local o=g.Units[d]if o then o.Applied=true else g.Units[d]={PMultiplier=0;Time=C();Applied=true}end end,"\083\080\069\076\076\095\065\085\082\065\095\065\080\080\076\073\069\068","\083\080\069\076\076\095\065\085\082\065\095\082\069\070\082\069\083\072")U:RegisterForSelfCombatEvent(function(G,U,h,w,i,Z,M,d,O,c,C,k)local Y=W[k]if not Y then return end local n=H[Y]if not n then return end local g=n.Units[d]if g then g.Applied=false end end,"\083\080\069\076\076\095\065\085\082\065\095\082\069\077\079\086\069\068")U:RegisterForCombatEvent(function(G,U,h,w,i,Z,M,d)for G,U in c(H)do if U.Units[d]then U.Units[d]=nil end end end,"\085\078\073\084\095\068\073\069\068","\085\078\073\084\095\068\069\083\084\082\079\089\069\068")function w.PMultiplier(U,G)local h=H[G:ID()]if not h then error(k(G))end local w=h.Units local i=w[U:GUID()]return i and(i.Applied and i.PMultiplier)or 0 end function i.PMultiplier(U,G)local h=H[G:ID()]if not h then error(k(G))end return Y(h)end