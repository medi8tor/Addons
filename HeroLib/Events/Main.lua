local G,U=...local h=HeroCache local w=U.Unit local i=w.Player local Z=w.Pet local M=w.Target local d=U.Spell local O=U.Item local c=CombatLogGetCurrentEventInfo local C=CreateFrame local H=pairs local W=select local k=string.find local Y=string.sub local n=table.insert local g=table.remove local o=C("\070\114\097\109\101","\072\101\114\111\076\105\098\095\069\118\101\110\116\070\114\097\109\101",UIParent)local b={}local y={}local T={}local m={}local K={}local t={}local F={"\069\078\086\073\082\079\078\077\069\078\084\065\076","\082\065\078\071\069","\083\080\069\076\076\095\066\085\073\076\068\073\078\071";"\083\080\069\076\076\095\080\069\082\073\079\068\073\067";"\083\080\069\076\076","\083\087\073\078\071"}local A=#F function U.RegisterForEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not b[w]then b[w]={G}o:RegisterEvent(w)else n(b[w],G)end end end function U.UnregisterForEvent(h,G,U)if b[U]then for h,w in H(b[U])do if w==G then g(b[U],h)if#b[U]==0 then o:UnregisterEvent(U)end return end end end end o:SetScript("\079\110\069\118\101\110\116",function(G,U,...)for G,h in H(b[U])do h(U,...)end end)function U.RegisterForCombatEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not y[w]then y[w]={G}else n(y[w],G)end end end function U.RegisterForSelfCombatEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not T[w]then T[w]={G}else n(T[w],G)end end end function U.RegisterForPetCombatEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not m[w]then m[w]={G}else n(m[w],G)end end end function U.RegisterForCombatPrefixEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not K[w]then K[w]={G}else n(K[w],G)end end end function U.RegisterForCombatSuffixEvent(U,G,...)local h={...}for U=1,#h,1 do local w=h[U]if not t[w]then t[w]={G}else n(t[w],G)end end end function U.UnregisterForCombatEvent(h,G,U)if y[U]then for h,w in H(y[U])do if w==G then g(y[U],h)return end end end end function U.UnregisterForSelfCombatEvent(h,G,U)if T[U]then for h,w in H(T[U])do if w==G then g(T[U],h)return end end end end function U.UnregisterForPetCombatEvent(h,G,U)if m[U]then for h,w in H(m[U])do if w==G then g(m[U],h)return end end end end function U.UnregisterForCombatPrefixEvent(h,G,U)if K[U]then for U,h in H(K[U])do if h==G then g(K,U)return end end end end function U.UnregisterForCombatSuffixEvent(h,G,U)if t[U]then for h,w in H(t[U])do if w==G then g(t[U],h)return end end end end local function a(G,U,h,...)if y[h]then for G,w in H(y[h])do w(U,h,...)end end if T[h]then if W(2,...)==i:GUID()then for G,w in H(T[h])do w(U,h,...)end end end if m[h]then if W(2,...)==Z:GUID()then for G,w in H(m[h])do w(U,h,...)end end end for G=1,A,1 do if h then local w,i=k(h,F[G])if w and i then local G,Z=Y(h,w,i),Y(h,i+1)if K[G]then for G,w in H(K[G])do w(U,h,...)end end if t[Z]then for G,w in H(t[Z])do w(U,h,...)end end end end end end U:RegisterForEvent(function(G)a(G,c())end,"\067\079\077\066\065\084\095\076\079\071\095\069\086\069\078\084\095\085\078\070\073\076\084\069\082\069\068")