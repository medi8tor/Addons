local K,V=...local s=HeroDBC.DBC local w=HeroLib local p=HeroCache local N=w.Unit local d=N.Player local R=N.Pet local y=N.Target local C=w.Spell local T=w.MultiSpell local o=w.Item local I=N.MouseOver local u=HeroRotation()local j=u.Cast local l=u.CastLeftNameplate local Y=u.AoEON local q=u.CDsON local v=(u.Commons()).Everyone.num local n=(u.Commons()).Everyone.bool local F=GetTime local k=math.min local r=C_Timer.After local A=GetWeaponEnchantInfo local J local U=C.Shaman.Elemental local Q=o.Shaman.Elemental local B=u.GUISettingsGet()local Z={}local i=(u.Commons()).Everyone local G=(u.Commons()).Shaman local m={General=B.General,Commons=B.APL.Shaman.Commons,Elemental=B.APL.Shaman.Elemental,Elemental_Defensives=B.APL.Shaman.Elemental.Defensives;Elemental_TTD=B.APL.Shaman.Elemental_TTD;Elemental_CDUSE=B.APL.Shaman.Elemental_CDUSE}local D,x local H,h local f,S local t,O local g,X local e,z local a,c local L local E=(100+50*v(U.SwellingMaelstrom:IsAvailable()))+25*v(U.PrimordialCapacity:IsAvailable())local M=11111 local P=11111 local b,W local KE,VE local sE=C(440313)local wE G.ClusterTargets=0 local pE=0 local function NE()local K,V=d:GetTrinketData(Z)if pE<5 and(K.ID==0 or V.ID==0 or K.SpellID>0 and not K.Usable or V.SpellID>0 and not V.Usable)then pE=pE+1 r(5,function()NE()end)return end D=K.Object x=V.Object H=K.Spell f=K.Range t=K.CastTime h=V.Spell S=V.Range O=V.CastTime g=K.Cooldown X=V.Cooldown e=K.Blacklisted z=V.Blacklisted a=K.ID==Q.SpymastersWeb:ID()c=V.ID==Q.SpymastersWeb:ID()end NE()w:RegisterForEvent(function()pE=0 NE()end,"\080\076\065\089\069\082\095\069\081\085\073\080\077\069\078\084\095\067\072\065\078\071\069\068")w:RegisterForEvent(function()E=(100+50*v(U.SwellingMaelstrom:IsAvailable()))+25*v(U.PrimordialCapacity:IsAvailable())U.PrimordialWave:RegisterInFlightEffect(327162)U.PrimordialWave:RegisterInFlight()U.LavaBurst:RegisterInFlight()end,"\076\069\065\082\078\069\068\095\083\080\069\076\076\095\073\078\095\084\065\066")U.PrimordialWave:RegisterInFlightEffect(327162)U.PrimordialWave:RegisterInFlight()U.LavaBurst:RegisterInFlight()local function dE()return 50-(F()-G.LastRollingThunderTick)end local function RE(K)local V,s for K,w in pairs(K)do local p=w:DebuffRemains(U.FlameShockDebuff)if not V or p<V then V=p s=w end end return V,s end local function yE(K)return K:DebuffRemains(U.FlameShockDebuff)end local function CE(K)return K:DebuffRemains(U.LightningRodDebuff)end local function TE(K)return K:DebuffDown(U.LightningRodDebuff)and U.LightningRod:IsAvailable()or L>E-30 end local function oE(K)return(K:DebuffRemains(U.FlameShockDebuff)<2 or U.FlameShockDebuff:AuraActiveCount()==0)and((K:DebuffRemains(U.FlameShockDebuff)<U.PrimordialWave:CooldownRemains()or not U.PrimordialWave:IsAvailable())and(K:DebuffRemains(U.FlameShockDebuff)<U.LiquidMagmaTotem:CooldownRemains()or not U.LiquidMagmaTotem:IsAvailable()))end local function IE(K)return K:DebuffRemains(U.FlameShockDebuff)<6 end local function uE(K)return L>E-15 or K:DebuffRemains(U.LightningRodDebuff)<d:GCD()or M<5 end local function jE(K)return K:DebuffRefreshable(U.FlameShockDebuff)end local function lE(K)return K:DebuffUp(U.FlameShockDebuff)end local function YE(K)return K:DebuffRemains(U.FlameShockDebuff)>2 end local function qE(K)return K:NPCID()==204560 end local function vE(K)return K:CastSpellID()==408805 end local function nE()return(I:Exists()or not m.Elemental.CursorCheck)and not d:IsCameraBusy()end local function FE()if i.TargetIsValid()then local K=y:MinDistance()or 5 local V=y:MaxDistance()or 40 K=math.max(K-8,5)V=math.min(V+8,40)local s=d:GetEnemiesInRange(K)local w=d:GetEnemiesInRange(V)local p=#w if V-K>16 then p=p-#s end p=math.max(p,1)return p else return#d:GetEnemiesInRange(40)end end local kE local rE local function AE(K)return rE and m.Elemental_TTD.IgnoreWhenBoss or i.Buggedmobs[y:NPCID()]or i.ISSolo()and m.Elemental_TTD.IgnoreWhenSolo or K==0 or P>=K and P<7777 end local function JE(K)return K~="\078\111\116 \085\115\101\100"and((K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115"or K=="\115\109\097\108\108 \067\068\115"and m.Elemental_CDUSE.smallcdswithCooldowns or K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115 \111\114 \065\111\069"or K=="\111\110 \069\110\101\109\121\099\111\117\110\116 \111\114 \067\111\111\108\100\111\119\110\115"or K=="\111\110 \066\111\115\115 \111\114 \119\105\116\104 \067\111\111\108\100\111\119\110\115")and q()or K=="\097\108\119\097\121\115"or(K=="\111\110 \066\111\115\115 \111\110\108\121"or K=="\111\110 \066\111\115\115 \111\114 \111\110 \069\110\101\109\121\099\111\117\110\116"or K=="\111\110 \066\111\115\115 \111\114 \119\105\116\104 \067\111\111\108\100\111\119\110\115")and(rE or y:IsDummy())or K=="\119\105\116\104 \066\108\111\111\100\108\117\115\116 \111\110\108\121"and d:BloodlustUp()or K=="\115\109\097\108\108 \067\068\115"and Smallcds or(K=="\111\110 \065\079\069"or K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115 \111\114 \065\111\069")and G.ClusterTargets>=2 or(K=="\111\110 \069\110\101\109\121\099\111\117\110\116 \111\114 \067\111\111\108\100\111\119\110\115"or K=="\111\110 \069\110\101\109\121\099\111\117\110\116"or K=="\111\110 \066\111\115\115 \111\114 \111\110 \069\110\101\109\121\099\111\117\110\116")and G.ClusterTargets>=m.Elemental_CDUSE.Enemycount)end local UE=nil local function QE()if d:IsMoving()then if not UE then UE=F()end return F()-UE else if UE then UE=nil end return 0 end end local function BE()if U.AstralShift:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=m.Elemental.Defensives.AstralShiftHP)then if j(U.AstralShift)then return"\065\115\116\114\097\108\083\104\105\102\116"end end if U.HealingStreamTotem:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=m.Elemental.Defensives.HealingStreamTotemHP)then if j(U.HealingStreamTotem)then return"\072\101\097\108\105\110\103\083\116\114\101\097\109\084\111\116\101\109"end end if U.StoneBulkwarkTotem:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=m.Elemental.Defensives.StoneBulkwarkTotemHP)then if j(U.StoneBulkwarkTotem)then return"\083\116\111\110\101\066\117\108\107\119\097\114\107\084\111\116\101\109"end end if U.HealingSurge:IsReady()and((d:BuffUp(U.SpiritwalkersGraceBuff)or not d:IsMoving())and d:HealthPercentage()<=m.Elemental.Defensives.HealingSurgeHP)then if j(U.HealingSurge)then return"\072\101\097\108\105\110\103\083\117\114\103\101"end end if U.EarthElemental:IsCastable()and(d:AffectingCombat()and(d:HealthPercentage()<=m.Elemental.Defensives.EarthElemental and IsEarthElemental))then if j(U.EarthElemental)then return"\069\097\114\116\104\069\108\101\109\101\110\116\097\108"end end if U.AncestralGuidance:IsCastable()and(d:AffectingCombat()and(m.Elemental.Defensives.AncestralGuidanceCount~=0 and(not m.Elemental.Defensives.AncestralGuidanceHP~=0 and i.AoELogicWithCount(m.Elemental.Defensives.AncestralGuidanceHP,m.Elemental.Defensives.AncestralGuidanceCount,nil,kE))))then if j(U.AncestralGuidance)then return"\065\110\099\101\115\116\114\097\108\071\117\105\100\097\110\099\101"end end end local function ZE()if U.Stormkeeper:IsViable()and IsStormkeeper then if j(U.Stormkeeper,true)then return"\115\116\111\114\109\107\101\101\112\101\114 \112\114\101\099\111\109\098\097\116 \050"end end if U.StormElemental:IsReady()and(IsStormElemental and not G.StormElemental.GreaterActive)then if j(U.StormElemental,true)then return"\115\116\111\114\109\095\101\108\101\109\101\110\116\097\108 \112\114\101\099\111\109\098\097\116 \054"end end if U.Stormkeeper:IsViable()and(IsStormkeeper and not d:StormkeeperUp())then if j(U.Stormkeeper,true)then return"\115\116\111\114\109\107\101\101\112\101\114 \112\114\101\099\111\109\098\097\116 \056"end end if U.PrimordialWave:IsViable()and IsPrimordialWave then if j(U.PrimordialWave)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \112\114\101\099\111\109\098\097\116 \049\048"end end if U.AncestralSwiftness:IsReady()and d:BuffDown(U.AncestralSwiftness)then if j(U.AncestralSwiftness,true)then return"\097\110\099\101\115\116\114\097\108\095\115\119\105\102\116\110\101\115\115 \112\114\101\099\111\109\098\097\116 \049\050"end end if U.LavaBurst:IsViable()then if j(U.LavaBurst)then return"\108\097\118\097\098\117\114\115\116 \112\114\101\099\111\109\098\097\116 \049\050"end end end local function iE()if U.FireElemental:IsReady()and(IsFireElemental and not G.FireElemental.GreaterActive)then if j(U.FireElemental,true)then return"\102\105\114\101\095\101\108\101\109\101\110\116\097\108 \097\111\101 \050"end end if U.StormElemental:IsReady()and(IsStormElemental and not G.StormElemental.GreaterActive)then if j(U.StormElemental,true)then return"\115\116\111\114\109\095\101\108\101\109\101\110\116\097\108 \097\111\101 \052"end end if U.Stormkeeper:IsViable()and(IsStormkeeper and not d:StormkeeperUp())then if j(U.Stormkeeper,true)then return"\115\116\111\114\109\107\101\101\112\101\114 \097\111\101 \054"end end if U.TotemicRecall:IsCastable()and(U.LiquidMagmaTotem:CooldownRemains()>15 and(U.FlameShockDebuff:AuraActiveCount()<k(G.ClusterTargets,6)-2 or U.FireElemental:IsAvailable()))then if j(U.TotemicRecall,true)then return"\116\111\116\101\109\105\099\095\114\101\099\097\108\108 \097\111\101 \056"end end if U.LiquidMagmaTotem:IsReady()and IsLiquidMagmaTotem then if j(U.LiquidMagmaTotem,true)then return"\108\105\113\117\105\100\095\109\097\103\109\097\095\116\111\116\101\109 \097\111\101 \049\048"end end if U.PrimordialWave:IsViable()and(IsPrimordialWave and(d:BuffUp(U.SurgeofPowerBuff)or not U.SurgeofPower:IsAvailable()or L<60-5*v(U.EyeoftheStorm:IsAvailable())))then if i.CastTargetIf(U.PrimordialWave,VE,"\109\105\110",yE,nil,40)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \097\111\101 \049\050"end end if U.AncestralSwiftness:IsReady()and d:BuffDown(U.AncestralSwiftness)then if j(U.AncestralSwiftness,true)then return"\097\110\099\101\115\116\114\097\108\095\115\119\105\102\116\110\101\115\115 \097\111\101 \049\052"end end if U.FlameShock:IsCastable()then local K,V=RE(VE)if V:DebuffRefreshable(U.FlameShockDebuff)then if d:BuffUp(U.SurgeofPowerBuff)and(U.LightningRod:IsAvailable()and(K<V:TimeToDie()-16 and(U.FlameShockDebuff:AuraActiveCount()<k(G.ClusterTargets,6)and not U.LiquidMagmaTotem:IsAvailable())))then if y:GUID()==V:GUID()then if j(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \109\097\105\110-\116\097\114\103\101\116 \049\054"end else if I:GUID()==V:GUID()and I:IsSpellInRange(U.FlameShock)then if u.CastTarget(U.FlameShock,(u.TName()).MOUSEOVER)then return"\070\108\097\109\101\083\104\111\099\107 \109\111\117\115\101\111\118\101\114"end end if l(V,U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \111\102\102-\116\097\114\103\101\116 \049\054"end end end if d:BuffUp(U.PrimordialWaveBuff)and(d:StormkeeperUp()and(L<(60-5*v(U.EyeoftheStorm:IsAvailable()))-(8+2*v(U.FlowofPower:IsAvailable()))*U.FlameShockDebuff:AuraActiveCount()and(G.ClusterTargets>=6 and U.FlameShockDebuff:AuraActiveCount()<6)))then if y:GUID()==V:GUID()then if j(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \109\097\105\110-\116\097\114\103\101\116 \049\056"end else if I:GUID()==V:GUID()and I:IsSpellInRange(U.FlameShock)then if u.CastTarget(U.FlameShock,(u.TName()).MOUSEOVER)then return"\070\108\097\109\101\083\104\111\099\107 \109\111\117\115\101\111\118\101\114"end end if l(V,U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \111\102\102-\116\097\114\103\101\116 \049\056"end end end if U.FireElemental:IsAvailable()and((d:BuffUp(U.SurgeofPowerBuff)or not U.SurgeofPower:IsAvailable())and(V:DebuffRemains(U.FlameShockDebuff)<V:TimeToDie()-5 and(U.FlameShockDebuff:AuraActiveCount()<6 or V:DebuffRemains(U.FlameShockDebuff)>0)))then if y:GUID()==V:GUID()then if j(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \109\097\105\110-\116\097\114\103\101\116 \050\048"end else if I:GUID()==V:GUID()and I:IsSpellInRange(U.FlameShock)then if u.CastTarget(U.FlameShock,(u.TName()).MOUSEOVER)then return"\070\108\097\109\101\083\104\111\099\107 \109\111\117\115\101\111\118\101\114"end end if l(V,U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \111\102\102-\116\097\114\103\101\116 \050\048"end end end end end if U.TempestAbility:IsReady()and(UseTempest and(AE(m.Elemental_TTD.TempestTTD)and((d:BuffUp(U.SpiritwalkersGraceBuff)or not d:IsMoving())and(not d:IsCasting(U.TempestAbility)and d:BuffDown(U.ArcDischargeBuff)))))then if j(U.LightningBolt)then return"\084\101\109\112\101\115\116\065\098\105\108\105\116\121 \097\111\101 \050\050"end end if U.Ascendance:IsCastable()and IsAscendance then if j(U.Ascendance,true)then return"\097\115\099\101\110\100\097\110\099\101 \097\111\101 \051\050"end end if U.LavaBeam:IsViable()and(G.ClusterTargets>=6 and(d:BuffUp(U.SurgeofPowerBuff)and d:BuffRemains(U.AscendanceBuff)>U.LavaBeam:CastTime()))then if j(U.LavaBeam)then return"\108\097\118\097\095\098\101\097\109 \097\111\101 \051\052"end end if U.ChainLightning:IsViable()and(G.ClusterTargets>=6 and d:BuffUp(U.SurgeofPowerBuff))then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \051\054"end end if U.LavaBurst:IsViable()and(d:BuffUp(U.PrimordialWaveBuff)and(d:StormkeeperUp()and(L<60-5*v(U.EyeoftheStorm:IsAvailable())and(G.ClusterTargets>=6 and U.SurgeofPower:IsAvailable()))))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \097\111\101 \051\056"end end if U.LavaBurst:IsViable()and(d:BuffUp(U.PrimordialWaveBuff)and(d:BuffRemains(U.PrimordialWaveBuff)<4 or d:BuffUp(U.LavaSurgeBuff)))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \097\111\101 \052\048"end end if U.LavaBurst:IsViable()and(d:BuffUp(U.LavaSurgeBuff)and(not d:MotEUp()and(U.MasteroftheElements:IsAvailable()and U.FireElemental:IsAvailable())))then if i.CastCycle(U.LavaBurst,VE,lE,40)then return"\108\097\118\097\095\098\117\114\115\116 \097\111\101 \052\050"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and(U.PrimordialWave:CooldownRemains()<d:GCD()and(U.SurgeofPower:IsAvailable()and(d:BuffUp(U.EchoesofGreatSunderingBuff)or not U.EchoesofGreatSundering:IsAvailable()))))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \097\111\101 \052\052"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and((U.LightningRodDebuff:AuraActiveCount()==0 and U.LightningRod:IsAvailable()or L>E-30)and(d:BuffUp(U.EchoesofGreatSunderingBuff)or not U.EchoesofGreatSundering:IsAvailable())))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \097\111\101 \052\054"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and(d:StormkeeperUp()and(G.ClusterTargets>=6 and(U.SurgeofPower:IsAvailable()and(d:BuffUp(U.EchoesofGreatSunderingBuff)or not U.EchoesofGreatSundering:IsAvailable())))))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \097\111\101 \052\056"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and((d:MotEUp()or G.ClusterTargets>=5)and((d:BuffUp(U.FusionofElementsNature)or d:BuffRemains(U.AscendanceBuff)>9 or d:BuffDown(U.AscendanceBuff))and((d:BuffUp(U.EchoesofGreatSunderingBuff)or not U.EchoesofGreatSundering:IsAvailable())and U.FireElemental:IsAvailable()))))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \097\111\101 \053\048"end end if U.ElementalBlast:IsViable()and(UseSpender and(U.EchoesofGreatSundering:IsAvailable()and(d:BuffDown(U.EchoesofGreatSunderingBuff)and(U.LightningRodDebuff:AuraActiveCount()==0 or L>E-30))))then if j(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \097\111\101 \053\050"end end if U.EarthShock:IsReady()and(UseSpender and(U.EchoesofGreatSundering:IsAvailable()and(d:BuffDown(U.EchoesofGreatSunderingBuff)and(U.LightningRodDebuff:AuraActiveCount()==0 or L>E-30))))then if j(U.EarthShock)then return"\101\097\114\116\104\095\115\104\111\099\107 \097\111\101 \053\052"end end if U.Icefury:IsViable()and(U.FusionofElements:IsAvailable()and not(d:BuffUp(U.FusionofElementsNature)or d:BuffUp(U.FusionofElementsFire)))then if j(U.Icefury)then return"\105\099\101\102\117\114\121 \097\111\101 \053\054"end end if U.LavaBurst:IsViable()and(U.MasteroftheElements:IsAvailable()and(not d:MotEUp()and(d:BuffDown(U.AscendanceBuff)and U.FireElemental:IsAvailable())))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \097\111\101 \053\056"end end if U.LavaBeam:IsViable()and(d:StormkeeperUp()and(d:BuffUp(U.SurgeofPowerBuff)or G.ClusterTargets<6))then if j(U.LavaBeam)then return"\108\097\118\097\095\098\101\097\109 \097\111\101 \054\048"end end if U.ChainLightning:IsViable()and(d:StormkeeperUp()and(d:BuffUp(U.SurgeofPowerBuff)or G.ClusterTargets<6))then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \054\050"end end if U.LavaBeam:IsViable()and(d:PotMUp()and(d:BuffRemains(U.AscendanceBuff)>U.LavaBeam:CastTime()and not d:StormkeeperUp()))then if j(U.LavaBeam)then return"\108\097\118\097\095\098\101\097\109 \097\111\101 \054\052"end end if U.ChainLightning:IsViable()and(d:PotMUp()and not d:StormkeeperUp())then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \054\054"end end if U.LavaBeam:IsViable()and((d:MotEUp()and G.ClusterTargets>=4 or G.ClusterTargets>=5)and(d:BuffRemains(U.AscendanceBuff)>U.LavaBeam:CastTime()and not d:StormkeeperUp()))then if j(U.LavaBeam)then return"\108\097\118\097\095\098\101\097\109 \097\111\101 \054\056"end end if U.LavaBurst:IsViable()and U.DeeplyRootedElements:IsAvailable()then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \097\111\101 \055\048"end end if U.LavaBeam:IsViable()and d:BuffRemains(U.AscendanceBuff)>U.LavaBeam:CastTime()then if j(U.LavaBeam)then return"\108\097\118\097\095\098\101\097\109 \097\111\101 \055\050"end end if U.ChainLightning:IsViable()then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \055\052"end end if U.FlameShock:IsCastable()and d:IsMoving()then if i.CastCycle(U.FlameShock,VE,jE,40)then return"\102\108\097\109\101\095\115\104\111\099\107 \109\111\118\105\110\103 \097\111\101 \055\054"end end if U.FrostShock:IsCastable()and d:IsMoving()then if j(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \109\111\118\105\110\103 \097\111\101 \055\056"end end end local function GE()if U.FireElemental:IsCastable()and(IsFireElemental and not G.FireElemental.GreaterActive)then if j(U.FireElemental,true)then return"\102\105\114\101\095\101\108\101\109\101\110\116\097\108 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050"end end if U.StormElemental:IsCastable()and(IsStormElemental and not G.StormElemental.GreaterActive)then if j(U.StormElemental,true)then return"\115\116\111\114\109\095\101\108\101\109\101\110\116\097\108 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052"end end if U.Stormkeeper:IsViable()and(IsStormkeeper and(d:BuffDown(U.AscendanceBuff)and not d:StormkeeperUp()))then if j(U.Stormkeeper,true)then return"\115\116\111\114\109\107\101\101\112\101\114 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054"end end if U.TotemicRecall:IsCastable()and(U.LiquidMagmaTotem:CooldownRemains()>15 and(G.ClusterTargets>1 and U.FireElemental:IsAvailable()))then if j(U.TotemicRecall,true)then return"\116\111\116\101\109\105\099\095\114\101\099\097\108\108 \115\105\110\103\108\101\095\116\097\114\103\101\116 \056"end end if U.LiquidMagmaTotem:IsCastable()and(y:IsInRange(40)and(IsLiquidMagmaTotem and(d:BuffDown(U.AscendanceBuff)and(U.FireElemental:IsAvailable()or G.ClusterTargets>1))))then if j(U.LiquidMagmaTotem,true)then return"\108\105\113\117\105\100\095\109\097\103\109\097\095\116\111\116\101\109 \115\105\110\103\108\101\095\116\097\114\103\101\116 \049\048"end end if U.PrimordialWave:IsViable()and(IsPrimordialWave and(G.ClusterTargets==1 or d:BuffUp(U.SurgeofPowerBuff)or not U.SurgeofPower:IsAvailable()or L<60-5*v(U.EyeoftheStorm:IsAvailable())or U.LiquidMagmaTotem:IsAvailable()))then if i.CastTargetIf(U.PrimordialWave,VE,"\109\105\110",yE,nil,40)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \115\105\110\103\108\101\095\116\097\114\103\101\116 \049\050"end end if U.AncestralSwiftness:IsReady()and(d:BuffDown(U.AncestralSwiftness)and(d:BuffDown(U.PrimordialWaveBuff)or not d:StormkeeperUp()or not U.ElementalBlast:IsAvailable()))then if j(U.AncestralSwiftness,true)then return"\097\110\099\101\115\116\114\097\108\095\115\119\105\102\116\110\101\115\115 \115\105\110\103\108\101\095\116\097\114\103\101\116 \049\052"end end if U.FlameShock:IsCastable()and(G.ClusterTargets==1 and((y:DebuffRemains(U.FlameShockDebuff)<2 or U.FlameShockDebuff:AuraActiveCount()==0)and((y:DebuffRemains(U.FlameShockDebuff)<U.PrimordialWave:CooldownRemains()or not U.PrimordialWave:IsAvailable())and((y:DebuffRemains(U.FlameShockDebuff)<U.LiquidMagmaTotem:CooldownRemains()or not U.LiquidMagmaTotem:IsAvailable())and(d:BuffDown(U.SurgeofPowerBuff)and U.FireElemental:IsAvailable())))))then if j(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \049\054"end end if U.FlameShock:IsCastable()and(U.FlameShockDebuff:AuraActiveCount()<G.ClusterTargets and(G.ClusterTargets>1 and((U.DeeplyRootedElements:IsAvailable()or U.Ascendance:IsAvailable()or U.PrimordialWave:IsAvailable()or U.SearingFlames:IsAvailable()or U.MagmaChamber:IsAvailable())and((d:BuffDown(U.SurgeofPowerBuff)and d:StormkeeperUp()or not U.SurgeofPower:IsAvailable()or U.Ascendance:CooldownUp()and U.Ascendance:IsAvailable())and not U.LiquidMagmaTotem:IsAvailable()))))then if i.CastTargetIf(U.FlameShock,VE,"\109\105\110",yE,nil,40)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \049\056"end end if U.FlameShock:IsCastable()and(G.ClusterTargets>1 and((U.DeeplyRootedElements:IsAvailable()or U.Ascendance:IsAvailable()or U.PrimordialWave:IsAvailable()or U.SearingFlames:IsAvailable()or U.MagmaChamber:IsAvailable())and((d:BuffUp(U.SurgeofPowerBuff)and not d:StormkeeperUp()or not U.SurgeofPower:IsAvailable())and U.FireElemental:IsAvailable())))then if i.CastTargetIf(U.FlameShock,VE,"\109\105\110",yE,IE,40)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050\048"end end if U.TempestAbility:IsReady()and(UseTempest and(AE(m.Elemental_TTD.TempestTTD)and((d:BuffUp(U.SpiritwalkersGraceBuff)or not d:IsMoving())and not d:IsCasting(U.TempestAbility))))then if j(U.LightningBolt)then return"\116\101\109\112\101\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050\050"end end if U.LightningBolt:IsViable()and(d:StormkeeperUp()and d:BuffUp(U.SurgeofPowerBuff))then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050\052"end end if U.LavaBurst:IsViable()and(d:StormkeeperUp()and(not d:MotEUp()and(not U.SurgeofPower:IsAvailable()and U.MasteroftheElements:IsAvailable())))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050\054"end end if U.LightningBolt:IsViable()and(d:StormkeeperUp()and(not U.SurgeofPower:IsAvailable()and(d:MotEUp()or not U.MasteroftheElements:IsAvailable())))then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \050\056"end end if U.LightningBolt:IsViable()and(d:BuffUp(U.SurgeofPowerBuff)and(d:BuffDown(U.AscendanceBuff)and U.EchoChamber:IsAvailable()))then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \051\048"end end if U.Ascendance:IsCastable()and(IsAscendance and U.LavaBurst:ChargesFractional()<1)then if j(U.Ascendance,true)then return"\097\115\099\101\110\100\097\110\099\101 \115\105\110\103\108\101\095\116\097\114\103\101\116 \051\050"end end if U.LavaBurst:IsViable()and(d:BuffUp(U.LavaSurgeBuff)and U.FireElemental:IsAvailable())then if i.CastCycle(U.LavaBurst,VE,lE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \051\052"end end if U.LavaBurst:IsViable()and d:BuffUp(U.PrimordialWaveBuff)then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \051\054"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and(d:MotEUp()and((d:BuffUp(U.EchoesofGreatSunderingBuff)or G.ClusterTargets>1 and(not U.EchoesofGreatSundering:IsAvailable()and not U.ElementalBlast:IsAvailable()))and((d:BuffUp(U.FusionofElementsNature)or L>E-15 or d:BuffRemains(U.AscendanceBuff)>9 or d:BuffDown(U.AscendanceBuff))and U.FireElemental:IsAvailable()))))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \115\105\110\103\108\101\095\116\097\114\103\101\116 \051\056"end end if U.ElementalBlast:IsViable()and(UseSpender and(d:MotEUp()and((d:BuffUp(U.FusionofElementsNature)or d:BuffUp(U.FusionofElementsFire)or L>E-15 or d:BuffRemains(U.AscendanceBuff)>6 or d:BuffDown(U.AscendanceBuff))and U.FireElemental:IsAvailable())))then if j(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\048"end end if U.EarthShock:IsReady()and(UseSpender and(d:MotEUp()and((d:BuffUp(U.FusionofElementsNature)or L>E-15 or d:BuffRemains(U.AscendanceBuff)>9 or d:BuffDown(U.AscendanceBuff))and U.FireElemental:IsAvailable())))then if j(U.EarthShock)then return"\101\097\114\116\104\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\050"end end if U.Earthquake:IsReady()and(UseSpender and(y:IsInRange(40)and(Cursorcheck and((d:BuffUp(U.EchoesofGreatSunderingBuff)or G.ClusterTargets>1 and(not U.EchoesofGreatSundering:IsAvailable()and not U.ElementalBlast:IsAvailable()))and((d:StormkeeperUp()or U.PrimordialWave:CooldownRemains()<d:GCD()and(U.SurgeofPower:IsAvailable()and not U.LiquidMagmaTotem:IsAvailable()))and U.StormElemental:IsAvailable())))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\052"end end if U.ElementalBlast:IsViable()and(UseSpender and(d:StormkeeperUp()and U.StormElemental:IsAvailable()))then if j(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\054"end end if U.EarthShock:IsReady()and(UseSpender and(((d:MotEUp()or U.LightningRodDebuff:AuraActiveCount()==0)and(U.Stormkeeper:CooldownRemains()>10 and(dE()>5 or not U.RollingThunder:IsAvailable()))or d:StormkeeperUp())and(U.StormElemental:IsAvailable()and G.ClusterTargets==1)))then if j(U.EarthShock)then return"\101\097\114\116\104\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\056"end end if U.EarthShock:IsReady()and(UseSpender and((U.PrimordialWave:CooldownRemains()<d:GCD()and(U.SurgeofPower:IsAvailable()and not U.LiquidMagmaTotem:IsAvailable())or d:StormkeeperUp())and(U.StormElemental:IsAvailable()and(G.ClusterTargets>1 and(U.EchoesofGreatSundering:IsAvailable()and d:BuffDown(U.EchoesofGreatSunderingBuff))))))then if j(U.EarthShock)then return"\101\097\114\116\104\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \052\057"end end if U.Icefury:IsViable()and(not(d:BuffUp(U.FusionofElementsNature)or d:BuffUp(U.FusionofElementsFire))and(d:BuffStack(U.IcefuryBuff)==2 and(U.FusionofElements:IsAvailable()or d:BuffDown(U.AscendanceBuff))))then if j(U.Icefury)then return"\105\099\101\102\117\114\121 \115\105\110\103\108\101\095\116\097\114\103\101\116 \053\048"end end if U.LavaBurst:IsViable()and d:BuffUp(U.AscendanceBuff)then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \053\050"end end if U.LavaBurst:IsViable()and(U.MasteroftheElements:IsAvailable()and(not d:MotEUp()and U.FireElemental:IsAvailable()))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \053\052"end end if U.LavaBurst:IsViable()and(d:StormkeeperUp()and(U.ElementalReverb:IsAvailable()and(U.EarthShock:IsAvailable()and w.CombatTime()<10)))then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \053\054"end end if U.Earthquake:IsReady()and(UseSpender and(Cursorcheck and((d:BuffUp(U.EchoesofGreatSunderingBuff)or G.ClusterTargets>1 and(not U.EchoesofGreatSundering:IsAvailable()and not U.ElementalBlast:IsAvailable()))and(L>E-35 or M<5))))then if j(U.Earthquakecast)then return"\101\097\114\116\104\113\117\097\107\101 \115\105\110\103\108\101\095\116\097\114\103\101\116 \053\056"end end if U.ElementalBlast:IsViable()and(UseSpender and(L>E-15 or M<5))then if j(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054\048"end end if U.EarthShock:IsReady()and(UseSpender and(L>E-15 or M<5))then if j(U.EarthShock)then return"\101\097\114\116\104\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054\050"end end if U.LightningBolt:IsViable()and d:BuffUp(U.SurgeofPowerBuff)then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054\052"end end if U.Icefury:IsViable()and not(d:BuffUp(U.FusionofElementsNature)or d:BuffUp(U.FusionofElementsFire))then if j(U.Icefury)then return"\105\099\101\102\117\114\121 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054\054"end end if U.FrostShock:IsCastable()and(d:IcefuryUp()and(G.ClusterTargets==1 or d:StormkeeperUp()and U.SurgeofPower:IsAvailable()))then if j(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \054\056"end end if U.ChainLightning:IsViable()and(d:PotMUp()and(G.ClusterTargets>1 and not d:StormkeeperUp()))then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \115\105\110\103\108\101\095\116\097\114\103\101\116 \055\048"end end if U.LightningBolt:IsViable()and(d:PotMUp()and not d:StormkeeperUp())then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \055\050"end end if U.LavaBurst:IsViable()and U.DeeplyRootedElements:IsAvailable()then if i.CastCycle(U.LavaBurst,VE,YE,40)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \055\052"end end if U.ChainLightning:IsViable()and(G.ClusterTargets>1 and not d:StormkeeperUp())then if j(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \115\105\110\103\108\101\095\116\097\114\103\101\116 \055\054"end end if U.LightningBolt:IsViable()then if j(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101\095\116\097\114\103\101\116 \055\056"end end if U.FlameShock:IsCastable()and d:IsMoving()then if i.CastCycle(U.FlameShock,VE,jE,40)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \056\048"end end if U.FlameShock:IsCastable()then if j(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \056\050"end end if U.FrostShock:IsCastable()then if j(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101\095\116\097\114\103\101\116 \056\052"end end end local function mE()if i.ShouldStopCastUpdate()then u.CastMacro(6,true)return"\083\116\111\112 \067\097\115\116 \070\111\114 \083\105\108\101\110\099\101"end InterruptToggle=u.ToggleIconFrame:GetToggle(1)DispelToggle=u.ToggleIconFrame:GetToggle(2)Smallcds=u.ToggleIconFrame:GetToggle(3)UseSpender=u.ToggleIconFrame:GetToggle(4)UseTempest=u.ToggleIconFrame:GetToggle(5)QE()local K=not d:AffectingCombat()or not y:AffectingCombat()or y:IsDummy()KE=d:GetEnemiesInRange(40)EnemiesRangeOOCCount=FE()or#KE kE=i.UnitsinRange(U.HealingSurge)VE=y:GetEnemiesInSplashRange(10)if Y()then G.ClusterTargets=EnemiesRangeOOCCount else G.ClusterTargets=1 end if m.Elemental.ForceAOE and Y()then G.ClusterTargets=99 end if U.PoisonCleansingTotem:IsAvailable()and U.PoisonCleansingTotem:IsReady()then wE=i.DebuffCount(kE,sE)else wE=0 end Cursorcheck=nE()and U.Earthquake1:IsAvailable()or U.Earthquake2:IsAvailable()IsRacials=AE(m.Elemental_TTD.RacialsTTD)and JE(m.Elemental_CDUSE.Racials)IsPotions=AE(m.Elemental_TTD.PotionsTTD)and((m.Elemental_CDUSE.Potionswhensolo or not m.Elemental_CDUSE.Potionswhensolo and not i.ISSolo())and JE(m.Elemental_CDUSE.Potions))IsTrinket1=AE(m.Elemental_TTD.TrinketsTTD)and JE(m.Elemental_CDUSE.Trinket1)IsTrinket2=AE(m.Elemental_TTD.TrinketsTTD)and JE(m.Elemental_CDUSE.Trinket2)IsAscendance=AE(m.Elemental_TTD.AscendanceTTD)and JE(m.Elemental_CDUSE.Ascendance)IsNaturesSwiftness=JE(m.Elemental_CDUSE.NaturesSwiftness)IsEarthElemental=JE(m.Elemental_CDUSE.EarthElemental)IsFireElemental=AE(m.Elemental_TTD.FireElementalTTD)and JE(m.Elemental_CDUSE.FireElemental)IsStormElemental=AE(m.Elemental_TTD.FireElementalTTD)and JE(m.Elemental_CDUSE.StormElemental)IsStormkeeper=AE(m.Elemental_TTD.StormkeeperTTD)and JE(m.Elemental_CDUSE.Stormkeeper)IsLiquidMagmaTotem=nE()and(AE(m.Elemental_TTD.LiquidMagmaTotemTTD)and JE(m.Elemental_CDUSE.LiquidMagmaTotem))IsPrimordialWave=AE(m.Elemental_TTD.PrimordialWaveTTD)and JE(m.Elemental_CDUSE.PrimordialWave)if i.TargetIsValid()or d:AffectingCombat()then TargetinRange=y:IsInRange(40)TargetinkickRange=y:IsSpellInRange(U.WindShear)M=w.BossFightRemains()rE=true P=M if P==11111 then rE=false P=w.FightRemains(VE,false)end L=d:MaelstromP()end if m.Commons.AutoWolf=="\097\108\119\097\121\115"or m.Commons.AutoWolf=="\079\110\108\121 \105\110 \067\111\109\098\097\116"and d:AffectingCombat()or m.Commons.AutoWolf=="\079\110\108\121 \111\117\116 \111\102 \099\111\109\098\097\116"and not d:AffectingCombat()then if d:IsMoving()and(not d:IsMounted()and(d:BuffDown(U.GhostWolf)and not d:AffectingCombat()))then j(U.GhostWolf)return"\071\104\111\115\116 \087\111\108\102"end if d:IsMoving()and(not d:IsMounted()and(d:BuffDown(U.GhostWolf)and(d:AffectingCombat()and(QE()>1 and(not y:IsInRange(40)or not i.TargetIsValid())))))then j(U.GhostWolf)return"\071\104\111\115\116 \087\111\108\102"end end b,W=A()if U.ImprovedFlametongueWeapon:IsAvailable()and((not b or W<600000)and U.FlametongueWeapon:IsCastable())then if j(U.FlametongueWeapon)then return"\102\108\097\109\101\116\111\110\103\117\101\095\119\101\097\112\111\110 \101\110\099\104\097\110\116"end end local V=select(8,A())if U.ThunderstrikeWard:IsReady()and(not V or V~=7587)then if j(U.ThunderstrikeWard)then return"\116\104\117\110\100\101\114\115\116\114\105\107\101\095\119\097\114\100"end end if U.SkyFury:IsReady()and(d:Level()>=16 and(not d:DebuffUp(U.Corruption)and((i.GroupBuffMissing(U.SkyFuryBuff)and(m.Commons.SkyFury=="\099\104\101\099\107 \119\104\111\108\101 \103\114\111\117\112"and(d:IsInRaidArea()or d:IsInDungeonArea()))or d:BuffDown(U.SkyFuryBuff,true)and(m.Commons.SkyFury=="\111\110\108\121 \099\104\101\099\107 \117\115"or m.Commons.SkyFury=="\099\104\101\099\107 \119\104\111\108\101 \103\114\111\117\112"))and not d:IsMounted())))then if u.CastTarget(U.SkyFury,(u.TName()).PLAYER)then return"\083\107\121\070\117\114\121"end end J=i.IncorpCycle(U.Hex,30,false,false)if J then return J end if DispelToggle then J=i.PurgeCycle(U.Purge,40,false,m.Commons.TabForPurge)if J then return J end if U.CleanseSpirit:IsCastable()and(d:IsInDungeonArea()and d:IsInParty())then J=i.DispelCycle(U.CleanseSpirit,"\067\117\114\115\101",nil,kE)if J then return J end end if U.PoisonCleansingTotem:IsAvailable()and U.PoisonCleansingTotem:IsReady()then if i.DispelCycle(U.PoisonCleansingTotem,"\080\111\105\115\111\110",nil,kE)then return u.CastTarget(U.PoisonCleansingTotem)end if wE>1 or U.CleanseSpirit:CooldownDown()and wE>0 then return u.CastTarget(U.PoisonCleansingTotem)end end end local s=U.ElementalOrbit:IsAvailable()and U.EarthShieldSelfBuff or U.EarthShieldOtherBuff if(m.Elemental.Defensives.Earthshieldooc and not d:AffectingCombat()or not m.Elemental.Defensives.Earthshieldooc)and((U.ElementalOrbit:IsAvailable()or m.Elemental.PreferEarthShield)and(U.EarthShield:IsReady()and(d:BuffDown(s)or not d:AffectingCombat()and d:BuffStack(s)<5)))then if u.CastTarget(U.EarthShield,(u.TName()).PLAYER)then return"\069\097\114\116\104\083\104\105\101\108\100"end elseif(m.Elemental.Defensives.Earthshieldooc and not d:AffectingCombat()or not m.Elemental.Defensives.Earthshieldooc)and((U.ElementalOrbit:IsAvailable()or not m.Elemental.PreferEarthShield or not U.EarthShield:IsAvailable())and(U.LightningShield:IsReady()and d:BuffDown(U.LightningShield)))then if j(U.LightningShield)then return"\076\105\103\104\116\110\105\110\103 \083\104\105\101\108\100 \082\101\102\114\101\115\104"end end J=BE()if J then return J end if i.TargetIsValid()then if not m.Elemental.AttackonlyinCombat or m.Elemental.AttackonlyinCombat and y:AffectingCombat()then if not qE(N.Target)then if InterruptToggle then J=i.InterruptCycle(U.WindShear,30,true,nil,false)if J then return J end end if TargetinRange then if not d:AffectingCombat()then J=ZE()if J then return J end end if U.BloodFury:IsCastable()and(IsRacials and(not U.Ascendance:IsAvailable()or d:BuffUp(U.AscendanceBuff)or U.Ascendance:CooldownRemains()>50))then if j(U.BloodFury,true)then return"\098\108\111\111\100\095\102\117\114\121 \109\097\105\110 \050"end end if U.Berserking:IsCastable()and(IsRacials and(not U.Ascendance:IsAvailable()or d:BuffUp(U.AscendanceBuff)))then if j(U.Berserking,true)then return"\098\101\114\115\101\114\107\105\110\103 \109\097\105\110 \052"end end if U.Fireblood:IsCastable()and(IsRacials and(not U.Ascendance:IsAvailable()or d:BuffUp(U.AscendanceBuff)or U.Ascendance:CooldownRemains()>50))then if j(U.Fireblood,true)then return"\102\105\114\101\098\108\111\111\100 \109\097\105\110 \054"end end if U.AncestralCall:IsCastable()and(IsRacials and(not U.Ascendance:IsAvailable()or d:BuffUp(U.AscendanceBuff)or U.Ascendance:CooldownRemains()>50))then if j(U.AncestralCall,true)then return"\097\110\099\101\115\116\114\097\108\095\099\097\108\108 \109\097\105\110 \056"end end if m.Commons.Enabled.Trinkets then if D:IsReady()and(y:IsInRange(f)and(IsTrinket1 and(not e and(not a or(M<45 or w.CombatTime()<P and d:BuffStack(U.SpymastersWebBuff)==40)and U.Stormkeeper:CooldownRemains()<5 or M<22))))then if j(D,true)then return"\117\115\101\095\105\116\101\109 \116\114\105\110\107\101\116\049 \040"..(D:Name().."\041 \109\097\105\110 \049\048")end end if x:IsReady()and(y:IsInRange(S)and(IsTrinket2 and(not z and(not c or(M<45 or w.CombatTime()<P and d:BuffStack(U.SpymastersWebBuff)==40)and U.Stormkeeper:CooldownRemains()<5 or M<22))))then if j(x,true)then return"\117\115\101\095\105\116\101\109 \116\114\105\110\107\101\116\050 \040"..(x:Name().."\041 \109\097\105\110 \049\050")end end end if m.Commons.Enabled.Items then local K,V,s=d:GetUseableItems(Z,16)if K and y:IsInRange(s)then u.CastMacro(1,true,nil,K)return"\119\101\097\112\111\110 \099\097\115\116"end end if U.NaturesSwiftness:IsCastable()and(d:BuffDown(U.NaturesSwiftness)and IsNaturesSwiftness)then if j(U.NaturesSwiftness,true)then return"\110\097\116\117\114\101\115\095\115\119\105\102\116\110\101\115\115 \109\097\105\110 \049\050"end end if U.AncestralSwiftness:IsReady()and d:BuffDown(U.AncestralSwiftness)then if j(U.AncestralSwiftness,true)then return"\097\110\099\101\115\116\114\097\108\095\115\119\105\102\116\110\101\115\115 \109\097\105\110 \049\052"end end if m.Commons.Enabled.Potions then local K=i.PotionSelected()if K and(K:IsReady()and IsPotions)then u.CastMacro(3,nil,nil,K)return"\067\097\115\116 \080\111\116\105\111\110"end end if Y()and G.ClusterTargets>2 then J=iE()if J then return J end if u.CastAnnotated(U.Pool,false,"\080\079\079\076")then return"\080\111\111\108 \102\111\114 \065\111\101\040\041"end end J=GE()if J then return J end if u.CastAnnotated(U.Pool,false,"\080\079\079\076")then return"\080\111\111\108 \102\111\114 \083\105\110\103\108\101\084\097\114\103\101\116\040\041"end end end end end end local function DE()u.ResetToggle()m.Elemental.Display()U.FlameShockDebuff:RegisterAuraTracking()U.LightningRodDebuff:RegisterAuraTracking()u:UpdateMacro("\109\097\099\114\111\049","\047\117\115\101 \049\054")u:UpdateMacro("\109\097\099\114\111\054","\047\115\116\111\112\099\097\115\116\105\110\103")u.ToggleIconFrame:AddButtonCustom("\073",1,"\073\110\116\101\114\114\117\112\116","\105\110\116\101\114\114\117\112\116")u.ToggleIconFrame:AddButtonCustom("\068",2,"\068\105\115\112\101\108","\100\105\115\112\101\108")u.ToggleIconFrame:AddButtonCustom("\083",3,"\115\109\097\108\108\067\068\115","\115\109\097\108\108\099\100\115")u.ToggleIconFrame:AddButtonCustom("\080",4,"\085\115\101\083\112\101\110\100\101\114","\117\115\101\115\112\101\110\100\101\114")u.ToggleIconFrame:AddButtonCustom("\084",5,"\085\115\101\084\101\109\112\101\115\116","\117\115\101\116\101\109\112\101\115\116")u.Print("\069\108\101\109\101\110\116\097\108 \083\104\097\109\097\110 \114\111\116\097\116\105\111\110 \104\097\115 \098\101\101\110 \117\112\100\097\116\101\100 \102\111\114 \112\097\116\099\104 \049\049\046\048\046\050\046 \076\097\115\116 \085\112\100\097\116\101 \049\048\046\049\048\046\050\048\050\052")end u.SetAPL(262,mE,DE)