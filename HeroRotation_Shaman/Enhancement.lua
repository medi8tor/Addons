local K,V=...local s=HeroDBC.DBC local w=HeroLib local p=HeroCache local N=w.Unit local d=N.Player local R=N.Target local y=w.Spell local C=w.MultiSpell local T=w.Item local o=HeroRotation()local I=o.Cast local u=o.AoEON local j=o.CDsON local l=(o.Commons()).Everyone.num local Y=(o.Commons()).Everyone.bool local q=GetSpellBonusDamage local v=GetWeaponEnchantInfo local n=math.max local F=math.min local k=string.match local r=GetTime local A=C_Timer.After local J local U=y.Shaman.Enhancement local Q=T.Shaman.Enhancement local B local Z={Q.AlgetharPuzzleBox:ID(),Q.BeacontotheBeyond:ID(),Q.ElementiumPocketAnvil:ID(),Q.ManicGrieftorch:ID()}local i=o.GUISettingsGet()local G=(o.Commons()).Everyone local m=(o.Commons()).Shaman local D={General=i.General;Commons=i.APL.Shaman.Commons,Enhancement=i.APL.Shaman.Enhancement;Enhancement_Defensives=i.APL.Shaman.Enhancement.Defensives,Enhancement_TTD=i.APL.Shaman.Enhancement_TTD,Enhancement_CDUSE=i.APL.Shaman.Enhancement_CDUSE}local x,H local h,f local S,t local O,g local X,e local z,a local c,L local E,M local P,b local W,KE local VE=0 local sE=U.RagingMaelstrom:IsAvailable()and 10 or 5 local wE=8 local pE=6 local NE=2 local dE=1000 local RE,yE,CE local TE,oE,IE local uE=U.LavaBurst:IsAvailable()and 2 or 1 local jE=U.LightningBolt local lE=11111 local YE=11111 local qE=(m.MoltenWeaponStacks+m.IcyEdgeStacks)+m.CracklingSurgeStacks local vE=y(440313)local nE local FE=0 local function kE()local K,V=d:GetTrinketData(Z)if FE<5 and(K.ID==0 or V.ID==0 or K.SpellID>0 and not K.Usable or V.SpellID>0 and not V.Usable)then FE=FE+1 A(5,function()kE()end)return end x=K.Object H=V.Object h=K.Spell S=K.Range O=K.CastTime f=V.Spell t=V.Range g=V.CastTime X=K.Cooldown e=V.Cooldown z=K.Blacklisted a=V.Blacklisted c=K.ID==Q.AlgetharPuzzleBox:ID()or K.ID==Q.ManicGrieftorch:ID()or K.ID==Q.ElementiumPocketAnvil:ID()or K.ID==Q.BeacontotheBeyond:ID()L=V.ID==Q.AlgetharPuzzleBox:ID()or V.ID==Q.ManicGrieftorch:ID()or V.ID==Q.ElementiumPocketAnvil:ID()or V.ID==Q.BeacontotheBeyond:ID()end kE()w:RegisterForEvent(function()uE=U.LavaBurst:IsAvailable()and 2 or 1 end,"\083\080\069\076\076\083\095\067\072\065\078\071\069\068","\076\069\065\082\078\069\068\095\083\080\069\076\076\095\073\078\095\084\065\066")w:RegisterForEvent(function()FE=0 kE()end,"\080\076\065\089\069\082\095\069\081\085\073\080\077\069\078\084\095\067\072\065\078\071\069\068")w:RegisterForEvent(function()jE=U.LightningBolt lE=11111 YE=11111 end,"\080\076\065\089\069\082\095\082\069\071\069\078\095\069\078\065\066\076\069\068")w:RegisterForCombatEvent(function()qE=(m.MoltenWeaponStacks+m.IcyEdgeStacks)+m.CracklingSurgeStacks end,"\083\080\069\076\076\095\065\085\082\065\095\065\080\080\076\073\069\068")local function rE(K)local V=d:GetEnemiesInRange(K)local s=1 for K,V in pairs(V)do if V:GUID()~=R:GUID()and(V:AffectingCombat()or V:IsDummy())then s=s+1 end end return s end local function AE(K)for V=1,6,1 do local s,w=d:GetTotemInfo(V)if K:Name()==w then return true end end end local function JE()if not U.AlphaWolf:IsAvailable()or d:BuffDown(U.FeralSpiritBuff)then return 0 end local K=F(U.CrashLightning:TimeSinceLastCast(),U.ChainLightning:TimeSinceLastCast())if K>8 or K>U.FeralSpirit:TimeSinceLastCast()then return 0 end return 8-K end U.LightningBolt:RegisterDamageFormula(function()return((q(4)*1.311)*(1+d:MasteryPct()/100))*((U.AmplificationCore:IsAvailable()and AE(U.SurgingTotem))and 1.03 or 1)end)U.ChainLightning:RegisterDamageFormula(function()local K=U.CrashingStorms:IsAvailable()and 5 or 3 return((((q(4)*.73025)*(1+d:MasteryPct()/100))*(U.CrashingStorms:IsAvailable()and 1.4 or 1))*((U.AmplificationCore:IsAvailable()and AE(U.SurgingTotem))and 1.03 or 1))*F(oE,K)end)local function UE(K)return K:DebuffRemains(U.LightningRodDebuff)end local function QE(K)return K:DebuffRemains(U.FlameShockDebuff)end local function BE(K)return d:BuffDown(U.PrimordialWaveBuff)end local function ZE(K)return K:DebuffRefreshable(U.LashingFlamesDebuff)and K:DebuffUp(U.FlameShockDebuff)end local function iE(K)return K:DebuffRefreshable(U.FlameShockDebuff)end local function GE(K)return K:NPCID()==204560 end local function mE(K)return K:CastSpellID()==408805 end local function DE()if i.General.AutoTab and d:AffectingCombat()then o.TopPanelAlternative:ChangeIcon(1,3)return"\065\117\116\111 \116\097\098 \116\111 \116\097\114\103\101\116"end end local function xE()return Q.ManicGrieftorch:IsEquipped()and(Q.ManicGrieftorch:CooldownUp()or Q.ManicGrieftorch:CooldownRemains()<=d:GCDRemains())end local HE local function hE(K)return HE and D.Enhancement_TTD.IgnoreWhenBoss or G.Buggedmobs[R:NPCID()]or G.ISSolo()and D.Enhancement_TTD.IgnoreWhenSolo or K==0 or YE>=K and YE<7777 end local function fE(K)return K~="\078\111\116 \085\115\101\100"and((K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115"or K=="\115\109\097\108\108 \067\068\115"and D.Enhancement_CDUSE.smallcdswithCooldowns or K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115 \111\114 \065\111\069"or K=="\111\110 \069\110\101\109\121\099\111\117\110\116 \111\114 \067\111\111\108\100\111\119\110\115"or K=="\111\110 \066\111\115\115 \111\114 \119\105\116\104 \067\111\111\108\100\111\119\110\115")and j()or K=="\097\108\119\097\121\115"or(K=="\111\110 \066\111\115\115 \111\110\108\121"or K=="\111\110 \066\111\115\115 \111\114 \111\110 \069\110\101\109\121\099\111\117\110\116"or K=="\111\110 \066\111\115\115 \111\114 \119\105\116\104 \067\111\111\108\100\111\119\110\115")and(HE or R:IsDummy())or K=="\119\105\116\104 \066\108\111\111\100\108\117\115\116 \111\110\108\121"and d:BloodlustUp()or K=="\115\109\097\108\108 \067\068\115"and Smallcds or(K=="\111\110 \065\079\069"or K=="\119\105\116\104 \067\111\111\108\100\111\119\110\115 \111\114 \065\111\069")and oE>=2 or(K=="\111\110 \069\110\101\109\121\099\111\117\110\116 \111\114 \067\111\111\108\100\111\119\110\115"or K=="\111\110 \069\110\101\109\121\099\111\117\110\116"or K=="\111\110 \066\111\115\115 \111\114 \111\110 \069\110\101\109\121\099\111\117\110\116")and oE>=D.Enhancement_CDUSE.Enemycount)end local SE=nil local function tE()if d:IsMoving()then if not SE then SE=r()end return r()-SE else if SE then SE=nil end return 0 end end local function OE()if U.AstralShift:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=D.Enhancement.Defensives.AstralShiftHP)then if I(U.AstralShift)then return"\065\115\116\114\097\108\083\104\105\102\116"end end if U.HealingStreamTotem:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=D.Enhancement.Defensives.HealingStreamTotemHP)then if I(U.HealingStreamTotem)then return"\072\101\097\108\105\110\103\083\116\114\101\097\109\084\111\116\101\109"end end if U.StoneBulkwarkTotem:IsCastable()and(d:AffectingCombat()and d:HealthPercentage()<=D.Enhancement.Defensives.StoneBulkwarkTotemHP)then if I(U.StoneBulkwarkTotem)then return"\083\116\111\110\101\066\117\108\107\119\097\114\107\084\111\116\101\109"end end if U.HealingSurge:IsReady()and(VE>=5 and d:HealthPercentage()<=D.Enhancement.Defensives.InstantHealingSurgeHP)then if I(U.HealingSurge)then return"\072\101\097\108\105\110\103\083\117\114\103\101"end end if U.HealingSurge:IsReady()and(not d:IsMoving()and d:HealthPercentage()<=D.Enhancement.Defensives.HealingSurgeHP)then if I(U.HealingSurge)then return"\072\101\097\108\105\110\103\083\117\114\103\101"end end if U.AncestralGuidance:IsCastable()and(d:AffectingCombat()and(D.Enhancement.Defensives.AncestralGuidanceCount~=0 and(not D.Enhancement.Defensives.AncestralGuidanceHP~=0 and G.AoELogicWithCount(D.Enhancement.Defensives.AncestralGuidanceHP,D.Enhancement.Defensives.AncestralGuidanceCount,nil,B))))then if I(U.AncestralGuidance)then return"\065\110\099\101\115\116\114\097\108\071\117\105\100\097\110\099\101"end end if U.EarthElemental:IsCastable()and(d:AffectingCombat()and(d:HealthPercentage()<=D.Enhancement.Defensives.EarthElemental and IsEarthElemental))then if I(U.EarthElemental)then return"\069\097\114\116\104\069\108\101\109\101\110\116\097\108"end end end local function gE()if U.PrimordialWave:IsReady()and(R:IsSpellInRange(U.PrimordialWave)and IsPrimordialWave)then if I(U.PrimordialWave)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \112\114\101\099\111\109\098\097\116 \052"end end if U.FeralSpirit:IsCastable()and(IsFeralSpirit and TargetInMeleeRange)then if I(U.FeralSpirit,true)then return"\102\101\114\097\108\095\115\112\105\114\105\116 \112\114\101\099\111\109\098\097\116 \054"end end if U.FlameShock:IsReady()and R:IsSpellInRange(U.FlameShock)then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \112\114\101\099\111\109\098\097\116 \056"end end end local function XE()if U.Windstrike:IsCastable()and(R:IsInRange(30)and(U.ThorimsInvocation:IsAvailable()and(VE>0 and(jE==U.LightningBolt and not U.ElementalSpirits:IsAvailable()))))then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \115\105\110\103\108\101 \050"end end if U.PrimordialWave:IsReady()and(R:IsSpellInRange(U.PrimordialWave)and(IsPrimordialWave and(R:DebuffDown(U.FlameShockDebuff)and U.MoltenAssault:IsAvailable())))then if I(U.PrimordialWave)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \115\105\110\103\108\101 \052"end end if U.FeralSpirit:IsCastable()and(TargetInMeleeRange and IsFeralSpirit)then if I(U.FeralSpirit,true)then return"\102\101\114\097\108\095\115\112\105\114\105\116 \115\105\110\103\108\101 \054"end end if U.TempestAbility:IsReady()and(UseSpender and(hE(D.Enhancement_TTD.TempestTTD)and(R:IsInRange(40)and(VE==sE or d:BuffStack(U.TempestBuff)==NE and((m.TempestMaelstrom>30 or d:BuffStack(U.AwakeningStormsBuff)==2)and VE>=5)))))then if I(U.LightningBolt)then return"\116\101\109\112\101\115\116 \115\105\110\103\108\101 \049\048"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE==sE and(U.ElementalSpirits:IsAvailable()and(qE>=6 and(U.ElementalBlast:ChargesFractional()>=1.8 or d:BuffUp(U.AscendanceBuff)))))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \049\050"end end if U.DoomWinds:IsCastable()and(R:IsInMeleeRange(5)and(IsDoomWinds and not U.ElementalSpirits:IsAvailable()))then if I(U.DoomWinds,true)then return"\100\111\111\109\095\119\105\110\100\115 \115\105\110\103\108\101 \049\052"end end if U.Windstrike:IsCastable()and(R:IsInRange(30)and(U.ThorimsInvocation:IsAvailable()and(VE>0 and jE==U.LightningBolt)))then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \115\105\110\103\108\101 \049\054"end end if U.Sundering:IsReady()and(R:IsInMeleeRange(11)and(IsSundering and(d:BuffUp(U.AscendanceBuff)and(AE(U.SurgingTotem)and U.Earthsurge:IsAvailable()))))then if I(U.Sundering,true)then return"\115\117\110\100\101\114\105\110\103 \115\105\110\103\108\101 \049\056"end end if U.FlameShock:IsReady()and(R:IsSpellInRange(U.FlameShock)and(R:DebuffDown(U.FlameShockDebuff)and U.LashingFlames:IsAvailable()))then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101 \050\048"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(VE>=sE and(d:BuffUp(U.PrimordialWaveBuff)and U.Tempest:IsAvailable()))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \050\049"end end if U.TempestAbility:IsReady()and(UseSpender and(hE(D.Enhancement_TTD.TempestTTD)and(R:IsInRange(40)and VE>=7)))then if I(U.LightningBolt)then return"\116\101\109\112\101\115\116 \115\105\110\103\108\101 \050\050"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE>=5 and(U.ElementalSpirits:IsAvailable()and(qE>=4 and not U.Tempest:IsAvailable()))or VE>=7 and(qE>=5 and((d:BuffUp(U.IcyEdgeBuff)or d:BuffUp(U.MoltenWeaponBuff))and U.FeralSpirit:CooldownRemains()>=3))or VE>=7 and(qE>=1 and(m.IcyEdgeStacks+m.MoltenWeaponStacks>=1 and(U.ElementalBlast:ChargesFractional()>=1.8 and U.FeralSpirit:CooldownRemains()>=3))))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \050\052"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(VE>=5 and(U.Tempest:IsAvailable()and(VE>=sE-l(U.ElementalSpirits:IsAvailable())*(l(U.Supercharge:IsAvailable())+l(U.StaticAccumulation:IsAvailable()))and d:BuffDown(U.PrimordialWaveBuff))))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \050\054"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(VE>=5 and(d:BuffUp(U.AscendanceBuff)and(jE==U.ChainLightning and(d:BuffRemains(U.AscendanceBuff)>U.Windstrike:CooldownRemains()+d:GCD()and d:BuffDown(U.PrimordialWaveBuff)))))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \050\056"end end if U.Stormstrike:IsReady()and(R:IsSpellInRange(U.Stormstrike)and(not U.ElementalSpirits:IsAvailable()and(d:BuffUp(U.DoomWindsBuff)or U.DeeplyRootedElements:IsAvailable()or U.Stormblast:IsAvailable()and d:BuffUp(U.StormbringerBuff))))then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \115\105\110\103\108\101 \051\048"end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and(d:BuffUp(U.HotHandBuff)and not U.Tempest:IsAvailable()))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \051\049"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE>=5 and(U.ElementalBlast:Charges()==U.ElementalBlast:MaxCharges()and not U.Tempest:IsAvailable()))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \051\050"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(VE>=8 and(d:BuffUp(U.PrimordialWaveBuff)and(d:BuffDown(U.SplinteredElementsBuff)or YE<=12)))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \051\052"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE>=8 and((qE>=2 or not U.ElementalSpirits:IsAvailable())and not U.Tempest:IsAvailable()))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \051\054"end end if U.LavaBurst:IsReady()and(R:IsSpellInRange(U.LavaBurst)and(not U.ThorimsInvocation:IsAvailable()and VE>=5))then if I(U.LavaBurst)then return"\108\097\118\097\095\098\117\114\115\116 \115\105\110\103\108\101 \051\056"end end if U.PrimordialWave:IsReady()and(R:IsSpellInRange(U.PrimordialWave)and IsPrimordialWave)then if I(U.PrimordialWave)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \115\105\110\103\108\101 \052\048"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE>=5 and(qE>=4 and(U.Ascendance:IsAvailable()and(U.ElementalBlast:ChargesFractional()>=1.8 or m.IcyEdgeStacks+m.MoltenWeaponStacks>=4))))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \052\050"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and((VE>=8 or U.StaticAccumulation:IsAvailable()and VE>=5)and(d:BuffDown(U.PrimordialWaveBuff)and(U.Ascendance:IsAvailable()and U.Tempest:IsAvailable())))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \052\052"end end if U.DoomWinds:IsCastable()and(R:IsInMeleeRange(5)and(IsDoomWinds and(U.ElementalSpirits:IsAvailable()and(U.Ascendance:IsAvailable()and U.Tempest:IsAvailable()))))then if I(U.DoomWinds,true)then return"\100\111\111\109\095\119\105\110\100\115 \115\105\110\103\108\101 \052\054"end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and(U.Tempest:IsAvailable()and(d:BuffUp(U.HotHandBuff)or U.MoltenAssault:IsAvailable()and(U.ElementalSpirits:IsAvailable()and(not U.DeeplyRootedElements:IsAvailable()and R:DebuffRemains(U.FlameShockDebuff)<=3)))))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \052\056"end end if U.Stormstrike:IsReady()and(R:IsSpellInRange(U.Stormstrike)and(U.ElementalSpirits:IsAvailable()and(d:BuffUp(U.DoomWindsBuff)or U.DeeplyRootedElements:IsAvailable()or U.Ascendance:IsAvailable()or U.Stormblast:IsAvailable()and d:BuffUp(U.StormbringerBuff))))then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \115\105\110\103\108\101 \053\048"end end if U.FrostShock:IsCastable()and(R:IsSpellInRange(U.FrostShock)and(d:BuffUp(U.HailstormBuff)and(d:BuffUp(U.IceStrikeBuff)and(U.SwirlingMaelstrom:IsAvailable()and(U.Tempest:IsAvailable()and U.Ascendance:IsAvailable())))))then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101 \053\050"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and(VE>=5 and(qE>=4 and(U.DeeplyRootedElements:IsAvailable()and(U.ElementalBlast:ChargesFractional()>=1.8 or m.IcyEdgeStacks+m.MoltenWeaponStacks>=4))))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \115\105\110\103\108\101 \053\052"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and((VE>=8 or U.StaticAccumulation:IsAvailable()and VE>=5)and d:BuffDown(U.PrimordialWaveBuff))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \053\054"end end if U.CrashLightning:IsReady()and(R:IsInMeleeRange(8)and(U.AlphaWolf:IsAvailable()and(d:BuffUp(U.FeralSpiritBuff)and JE()==0)))then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \115\105\110\103\108\101 \053\056"end end if U.FlameShock:IsReady()and(R:IsSpellInRange(U.FlameShock)and(R:DebuffDown(U.FlameShockDebuff)and not U.Tempest:IsAvailable()))then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101 \054\048"end end if U.TotemicRebound:IsAvailable()and F(U.Stormstrike:TimeSinceLastCast(),U.Windstrike:TimeSinceLastCast())>=3.5 or U.AwakeningStorms:IsAvailable()and F(U.Stormstrike:TimeSinceLastCast(),U.Windstrike:TimeSinceLastCast(),U.LightningBolt:TimeSinceLastCast(),U.TempestAbility:TimeSinceLastCast(),U.ChainLightning:TimeSinceLastCast())>=3.5 then if U.Windstrike:IsCastable()and R:IsInRange(30)then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \115\105\110\103\108\101 \054\050"end end if U.Stormstrike:IsReady()and R:IsSpellInRange(U.Stormstrike)then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \115\105\110\103\108\101 \054\052"end end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and(U.LivelyTotems:IsAvailable()and U.LavaLash:TimeSinceLastCast()>=3.5))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \054\054"end end if U.DoomWinds:IsReady()and(R:IsInMeleeRange(5)and(IsDoomWinds and U.ElementalSpirits:IsAvailable()))then if I(U.DoomWinds,true)then return"\100\111\111\109\095\119\105\110\100\115 \115\105\110\103\108\101 \054\056"end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and(U.ElementalAssault:IsAvailable()and(U.Tempest:IsAvailable()and(U.MoltenAssault:IsAvailable()and(U.DeeplyRootedElements:IsAvailable()and R:DebuffUp(U.FlameShockDebuff))))))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \055\048"end end if U.IceStrike:IsReady()and(R:IsSpellInRange(U.IceStrike)and(IsIceStrike and(U.ElementalAssault:IsAvailable()and U.SwirlingMaelstrom:IsAvailable())))then if I(U.IceStrike)then return"\105\099\101\095\115\116\114\105\107\101 \115\105\110\103\108\101 \055\050"end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and(U.ElementalAssault:IsAvailable()and(U.Tempest:IsAvailable()and(U.MoltenAssault:IsAvailable()and R:DebuffUp(U.FlameShockDebuff)))))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \055\051"end end if U.FrostShock:IsCastable()and(R:IsSpellInRange(U.FrostShock)and(d:BuffUp(U.HailstormBuff)and(d:BuffUp(U.IceStrikeBuff)and(U.SwirlingMaelstrom:IsAvailable()and U.Tempest:IsAvailable()))))then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101 \055\052"end end if U.FlameShock:IsReady()and(R:IsSpellInRange(U.FlameShock)and R:DebuffDown(U.FlameShockDebuff))then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101 \055\054"end end if U.LavaLash:IsCastable()and(R:IsSpellInRange(U.LavaLash)and U.LashingFlames:IsAvailable())then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \055\056"end end if U.IceStrike:IsReady()and(R:IsSpellInRange(U.IceStrike)and(IsIceStrike and d:BuffDown(U.IceStrikeBuff)))then if I(U.IceStrike)then return"\105\099\101\095\115\116\114\105\107\101 \115\105\110\103\108\101 \056\048"end end if U.FrostShock:IsReady()and(R:IsSpellInRange(U.FrostShock)and d:BuffUp(U.HailstormBuff))then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101 \056\050"end end if U.CrashLightning:IsReady()and(R:IsInMeleeRange(8)and U.ConvergingStorms:IsAvailable())then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \115\105\110\103\108\101 \056\052"end end if U.LavaLash:IsReady()and R:IsSpellInRange(U.LavaLash)then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \115\105\110\103\108\101 \056\054"end end if U.IceStrike:IsReady()and(R:IsSpellInRange(U.IceStrike)and IsIceStrike)then if I(U.IceStrike)then return"\105\099\101\095\115\116\114\105\107\101 \115\105\110\103\108\101 \056\056"end end if U.Windstrike:IsCastable()and R:IsInRange(30)then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \115\105\110\103\108\101 \057\048"end end if U.Stormstrike:IsReady()and R:IsSpellInRange(U.Stormstrike)then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \115\105\110\103\108\101 \057\050"end end if U.Sundering:IsReady()and(R:IsInMeleeRange(11)and IsSundering)then if I(U.Sundering,true)then return"\115\117\110\100\101\114\105\110\103 \115\105\110\103\108\101 \057\052"end end if U.TempestAbility:IsReady()and(UseSpender and(hE(D.Enhancement_TTD.TempestTTD)and(R:IsInRange(40)and VE>=5)))then if I(U.LightningBolt)then return"\116\101\109\112\101\115\116 \115\105\110\103\108\101 \057\054"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(U.Hailstorm:IsAvailable()and(VE>=5 and d:BuffDown(U.PrimordialWaveBuff)))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \057\056"end end if U.FrostShock:IsReady()and R:IsSpellInRange(U.FrostShock)then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \115\105\110\103\108\101 \049\048\048"end end if U.CrashLightning:IsReady()and R:IsInMeleeRange(8)then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \115\105\110\103\108\101 \049\048\050"end end if U.FireNova:IsReady()and(IsFireNova and R:DebuffUp(U.FlameShockDebuff))then if I(U.FireNova)then return"\102\105\114\101\095\110\111\118\097 \115\105\110\103\108\101 \049\048\052"end end if U.EarthElemental:IsCastable()and(TargetInMeleeRange and IsEarthElemental)then if I(U.EarthElemental,true)then return"\101\097\114\116\104\095\101\108\101\109\101\110\116\097\108 \115\105\110\103\108\101 \049\048\054"end end if U.FlameShock:IsReady()and R:IsSpellInRange(U.FlameShock)then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \115\105\110\103\108\101 \049\048\056"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and(VE>=5 and d:BuffDown(U.PrimordialWaveBuff))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \115\105\110\103\108\101 \049\049\048"end end end local function eE()if U.TempestAbility:IsReady()and(UseSpender and(hE(D.Enhancement_TTD.TempestTTD)and(R:IsInRange(40)and(VE==sE or VE>=5 and(m.TempestMaelstrom>30 or d:BuffStack(U.AwakeningStormsBuff)==2)))))then if I(U.LightningBolt)then return"\116\101\109\112\101\115\116 \097\111\101 \050"end end if U.Windstrike:IsCastable()and(R:IsInRange(30)and(U.ThorimsInvocation:IsAvailable()and(VE>0 and jE==U.ChainLightning)))then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \097\111\101 \052"end end if U.CrashLightning:IsReady()and(R:IsInMeleeRange(8)and(U.CrashingStorms:IsAvailable()and(U.UnrulyWinds:IsAvailable()and oE>=10 or oE>=15)))then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \097\111\101 \054"end end if U.LightningBolt:IsCastable()and(UseSpender and(R:IsSpellInRange(U.LightningBolt)and((not U.Tempest:IsAvailable()or m.TempestMaelstrom<=10 and d:BuffStack(U.AwakeningStormsBuff)<=1)and((U.FlameShockDebuff:AuraActiveCount()==oE or U.FlameShockDebuff:AuraActiveCount()>=6)and(d:BuffUp(U.PrimordialWaveBuff)and(VE==sE and(d:BuffDown(U.SplinteredElementsBuff)or lE<=12)))))))then if I(U.LightningBolt)then return"\108\105\103\104\116\110\105\110\103\095\098\111\108\116 \097\111\101 \056"end end if U.LavaLash:IsReady()and(R:IsSpellInRange(U.LavaLash)and(U.MoltenAssault:IsAvailable()and((U.PrimordialWave:IsAvailable()or U.FireNova:IsAvailable())and(R:DebuffUp(U.FlameShockDebuff)and(U.FlameShockDebuff:AuraActiveCount()<oE and U.FlameShockDebuff:AuraActiveCount()<6)))))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \097\111\101 \049\048"end end if U.PrimordialWave:IsReady()and(IsPrimordialWave and d:BuffDown(U.PrimordialWaveBuff))then if G.CastTargetIf(U.PrimordialWave,TE,"\109\105\110",QE,BE,40)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \097\111\101 \049\050"end end if U.ChainLightning:IsReady()and(UseSpender and(R:IsSpellInRange(U.ChainLightning)and(d:BuffUp(U.ArcDischargeBuff)and VE>=5)))then if I(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \049\052"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and((not U.ElementalSpirits:IsAvailable()or U.ElementalSpirits:IsAvailable()and(U.ElementalBlast:Charges()==uE or qE>=2))and(VE==sE and(not U.CrashingStorms:IsAvailable()or oE<=3)))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \097\111\101 \049\054"end end if U.ChainLightning:IsReady()and(UseSpender and(R:IsSpellInRange(U.ChainLightning)and VE==sE))then if I(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \049\056"end end if U.FeralSpirit:IsCastable()and(TargetInMeleeRange and IsFeralSpirit)then if I(U.FeralSpirit,true)then return"\102\101\114\097\108\095\115\112\105\114\105\116 \097\111\101 \050\048"end end if U.DoomWinds:IsCastable()and(R:IsInMeleeRange(5)and IsDoomWinds)then if I(U.DoomWinds,true)then return"\100\111\111\109\095\119\105\110\100\115 \097\111\101 \050\050"end end if U.CrashLightning:IsReady()and(R:IsInMeleeRange(8)and(d:BuffUp(U.DoomWindsBuff)or d:BuffDown(U.CrashLightningBuff)or U.AlphaWolf:IsAvailable()and(d:BuffUp(U.FeralSpiritBuff)and JE()==0)))then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \097\111\101 \050\052"end end if U.Sundering:IsReady()and(R:IsInMeleeRange(11)and(IsSundering and(d:BuffUp(U.DoomWindsBuff)or U.Earthsurge:IsAvailable())))then if I(U.Sundering,true)then return"\115\117\110\100\101\114\105\110\103 \097\111\101 \050\054"end end if U.FireNova:IsReady()and(IsFireNova and(U.FlameShockDebuff:AuraActiveCount()==6 or U.FlameShockDebuff:AuraActiveCount()>=4 and U.FlameShockDebuff:AuraActiveCount()>=oE))then if I(U.FireNova)then return"\102\105\114\101\095\110\111\118\097 \097\111\101 \050\056"end end if U.LavaLash:IsReady()and U.LashingFlames:IsAvailable()then if G.CastCycle(U.LavaLash,TE,ZE,5,nil,nil,D.Enhancement.AutoTabDot,false)then return"\108\097\118\097\095\108\097\115\104 \097\111\101 \051\048"end end if U.LavaLash:IsReady()and(R:IsSpellInRange(U.LavaLash)and(U.MoltenAssault:IsAvailable()and R:DebuffUp(U.FlameShockDebuff)))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \097\111\101 \051\050"end end if U.IceStrike:IsReady()and(R:IsSpellInRange(U.IceStrike)and(IsIceStrike and(U.Hailstorm:IsAvailable()and d:BuffDown(U.IceStrikeBuff))))then if I(U.IceStrike)then return"\105\099\101\095\115\116\114\105\107\101 \097\111\101 \051\052"end end if U.FrostShock:IsReady()and(R:IsSpellInRange(U.FrostShock)and(U.Hailstorm:IsAvailable()and d:BuffUp(U.HailstormBuff)))then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \097\111\101 \051\054"end end if U.Sundering:IsReady()and(R:IsInMeleeRange(11)and IsSundering)then if I(U.Sundering,true)then return"\115\117\110\100\101\114\105\110\103 \097\111\101 \051\056"end end if U.FlameShock:IsReady()and(R:IsSpellInRange(U.FlameShock)and(U.MoltenAssault:IsAvailable()and R:DebuffDown(U.FlameShockDebuff)))then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \052\048"end end if U.FlameShock:IsReady()and((U.FireNova:IsAvailable()or U.PrimordialWave:IsAvailable())and(U.FlameShockDebuff:AuraActiveCount()<oE and U.FlameShockDebuff:AuraActiveCount()<6))then if G.CastCycle(U.FlameShock,TE,iE,40)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \052\050"end end if U.FireNova:IsReady()and(IsFireNova and U.FlameShockDebuff:AuraActiveCount()>=3)then if I(U.FireNova)then return"\102\105\114\101\095\110\111\118\097 \097\111\101 \052\052"end end if U.Stormstrike:IsReady()and(R:IsSpellInRange(U.Stormstrike)and(d:BuffUp(U.CrashLightningBuff)and(U.DeeplyRootedElements:IsAvailable()or d:BuffStack(U.ConvergingStormsBuff)==pE)))then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \097\111\101 \052\054"end end if U.CrashLightning:IsReady()and(R:IsInMeleeRange(8)and(U.CrashingStorms:IsAvailable()and(d:BuffUp(U.CLCrashLightningBuff)and oE>=4)))then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \097\111\101 \052\056"end end if U.Windstrike:IsReady()and R:IsInRange(30)then if I(U.Windstrike)then return"\119\105\110\100\115\116\114\105\107\101 \097\111\101 \053\048"end end if U.Stormstrike:IsReady()and R:IsSpellInRange(U.Stormstrike)then if I(U.Stormstrike)then return"\115\116\111\114\109\115\116\114\105\107\101 \097\111\101 \053\050"end end if U.IceStrike:IsReady()and(R:IsSpellInRange(U.IceStrike)and IsIceStrike)then if I(U.IceStrike)then return"\105\099\101\095\115\116\114\105\107\101 \097\111\101 \053\052"end end if U.LavaLash:IsReady()and(R:DebuffUp(U.FlameShockDebuff)and R:IsSpellInRange(U.LavaLash))then if I(U.LavaLash)then return"\108\097\118\097\095\108\097\115\104 \097\111\101 \053\054"end end if U.CrashLightning:IsReady()and R:IsInMeleeRange(8)then if I(U.CrashLightning,true)then return"\099\114\097\115\104\095\108\105\103\104\116\110\105\110\103 \097\111\101 \053\056"end end if U.FireNova:IsReady()and(IsFireNova and U.FlameShockDebuff:AuraActiveCount()>=2)then if I(U.FireNova)then return"\102\105\114\101\095\110\111\118\097 \097\111\101 \054\048"end end if U.ElementalBlast:IsReady()and(UseSpender and(R:IsSpellInRange(U.ElementalBlast)and((not U.ElementalSpirits:IsAvailable()or U.ElementalSpirits:IsAvailable()and(U.ElementalBlast:Charges()==uE or qE>=2))and(VE>=5 and(not U.CrashingStorms:IsAvailable()or oE<=3)))))then if I(U.ElementalBlast)then return"\101\108\101\109\101\110\116\097\108\095\098\108\097\115\116 \097\111\101 \054\050"end end if U.ChainLightning:IsReady()and(UseSpender and(R:IsSpellInRange(U.ChainLightning)and VE>=5))then if I(U.ChainLightning)then return"\099\104\097\105\110\095\108\105\103\104\116\110\105\110\103 \097\111\101 \054\052"end end if U.FlameShock:IsReady()and(R:IsSpellInRange(U.FlameShock)and R:DebuffDown(U.FlameShockDebuff))then if I(U.FlameShock)then return"\102\108\097\109\101\095\115\104\111\099\107 \097\111\101 \054\054"end end if U.FrostShock:IsReady()and(R:IsSpellInRange(U.FrostShock)and not U.Hailstorm:IsAvailable())then if I(U.FrostShock)then return"\102\114\111\115\116\095\115\104\111\099\107 \097\111\101 \054\056"end end end local function zE()if d:IsChanneling(Q.ManicGrieftorch.ItemUseSpell)then return"\068\111\110\116 \099\117\116 \084\111\114\099\104"end InterruptToggle=o.ToggleIconFrame:GetToggle(1)DispelToggle=o.ToggleIconFrame:GetToggle(2)Smallcds=o.ToggleIconFrame:GetToggle(3)UseSpender=o.ToggleIconFrame:GetToggle(4)tE()B=G.UnitsinRange(U.HealingSurge)TE=d:GetEnemiesInMeleeRange(10)if u()then oE=#TE IE=rE(40)else oE=1 IE=1 end if U.PoisonCleansingTotem:IsAvailable()and U.PoisonCleansingTotem:IsReady()then nE=G.DebuffCount(B,vE)else nE=0 end IsRacials=hE(D.Enhancement_TTD.RacialsTTD)and fE(D.Enhancement_CDUSE.Racials)IsPotions=hE(D.Enhancement_TTD.PotionsTTD)and((D.Enhancement_CDUSE.Potionswhensolo or not D.Enhancement_CDUSE.Potionswhensolo and not G.ISSolo())and fE(D.Enhancement_CDUSE.Potions))IsTrinket1=hE(D.Enhancement_TTD.TrinketsTTD)and fE(D.Enhancement_CDUSE.Trinket1)IsTrinket2=hE(D.Enhancement_TTD.TrinketsTTD)and fE(D.Enhancement_CDUSE.Trinket2)IsAscendance=hE(D.Enhancement_TTD.AscendanceTTD)and fE(D.Enhancement_CDUSE.Ascendance)IsFireNova=fE(D.Enhancement_CDUSE.FireNova)IsEarthElemental=fE(D.Enhancement_CDUSE.EarthElemental)IsDoomWinds=hE(D.Enhancement_TTD.DoomWindsTTD)and fE(D.Enhancement_CDUSE.DoomWinds)IsFeralSpirit=hE(D.Enhancement_TTD.FeralSpiritTTD)and fE(D.Enhancement_CDUSE.FeralSpirit)IsSundering=hE(D.Enhancement_TTD.SunderingTTD)and fE(D.Enhancement_CDUSE.Sundering)IsIceStrike=fE(D.Enhancement_CDUSE.IceStrike)IsPrimordialWave=hE(D.Enhancement_TTD.PrimordialWaveTTD)and fE(D.Enhancement_CDUSE.PrimordialWave)IsSurgingTotem=hE(D.Enhancement_TTD.SurgingTotemTTD)and fE(D.Enhancement_CDUSE.SurgingTotem)TargetInMeleeRange=R:IsInRange(5)E,P,_,_,M,b=v()if(not E or P<600000)and U.WindfuryWeapon:IsCastable()then if I(U.WindfuryWeapon)then return"\119\105\110\100\102\117\114\121\095\119\101\097\112\111\110 \101\110\099\104\097\110\116"end end if(not M or b<600000)and U.FlametongueWeapon:IsCastable()then if I(U.FlametongueWeapon)then return"\102\108\097\109\101\116\111\110\103\117\101\095\119\101\097\112\111\110 \101\110\099\104\097\110\116"end end if U.SpiritWalk:IsCastable()and d:DebuffUp(U.EntangledDebuff)then if I(U.SpiritWalk)then return"\083\112\105\114\105\116\087\097\108\107 \102\111\114 \101\110\116\097\110\103\108\105\110\103"end end if G.TargetIsValid()or d:AffectingCombat()then lE=w.BossFightRemains()HE=true YE=lE if YE==11111 then HE=false YE=w.FightRemains(TE,false)end VE=d:BuffStack(U.MaelstromWeaponBuff)dE=F(U.FeralSpirit:CooldownRemains()/(4*l(U.WitchDoctorsAncestry:IsAvailable()))+1000*l(not U.FeralSpirit:IsAvailable()),U.DoomWinds:CooldownRemains()+1000*l(not U.DoomWinds:IsAvailable()),U.Ascendance:CooldownRemains()+1000*l(not U.Ascendance:IsAvailable()))RE=(1+l(R:DebuffUp(U.ChaosBrandDebuff))*.05)*(1+l(R:DebuffUp(U.HuntersMarkDebuff)and R:HealthPercentage()>=80)*.05)local K=1.75*U.LightningBolt:Damage()local V=(.2*U.LightningBolt:Damage())*(R:DebuffUp(U.LightningRodDebuff)and 1.75 or 1)yE=U.LightningBolt:Damage()*(1+((l(R:DebuffUp(U.LightningRodDebuff))*RE)*(1+(l(d:BuffUp(U.PrimordialWaveBuff))*U.FlameShockDebuff:AuraActiveCount())*K))*V)CE=U.ChainLightning:Damage()*(1+((l(R:DebuffUp(U.LightningRodDebuff))*RE)*F(oE,3+2*l(U.CrashingStorms:IsAvailable())))*V)end if d:AffectingCombat()then if d:PrevGCD(1,U.ChainLightning)then jE=U.ChainLightning elseif d:PrevGCD(1,U.LightningBolt)then jE=U.LightningBolt end end if D.Commons.AutoWolf=="\097\108\119\097\121\115"or D.Commons.AutoWolf=="\079\110\108\121 \105\110 \067\111\109\098\097\116"and d:AffectingCombat()or D.Commons.AutoWolf=="\079\110\108\121 \111\117\116 \111\102 \099\111\109\098\097\116"and not d:AffectingCombat()then if d:IsMoving()and(not d:IsMounted()and(d:BuffDown(U.GhostWolf)and not d:AffectingCombat()))then I(U.GhostWolf)return"\071\104\111\115\116 \087\111\108\102"end if d:IsMoving()and(not d:IsMounted()and(d:BuffDown(U.GhostWolf)and(d:AffectingCombat()and(tE()>1 and(not R:IsInMeleeRange(8)or not G.TargetIsValid())))))then I(U.GhostWolf)return"\071\104\111\115\116 \087\111\108\102"end end J=G.IncorpCycle(U.Hex,30,false,false)if J then return J end if DispelToggle then J=G.PurgeCycle(U.Purge,40,false,D.Commons.TabForPurge)if J then return J end if U.CleanseSpirit:IsCastable()and(d:IsInDungeonArea()and d:IsInParty())then J=G.DispelCycle(U.CleanseSpirit,"\067\117\114\115\101",nil,B)if J then return J end end if U.PoisonCleansingTotem:IsAvailable()and U.PoisonCleansingTotem:IsReady()then if G.DispelCycle(U.PoisonCleansingTotem,"\080\111\105\115\111\110",nil,B)then return o.CastTarget(U.PoisonCleansingTotem)end if nE>1 or U.CleanseSpirit:CooldownDown()and nE>0 then return o.CastTarget(U.PoisonCleansingTotem)end end end local K=U.ElementalOrbit:IsAvailable()and U.EarthShieldSelfBuff or U.EarthShieldOtherBuff if(D.Enhancement.Defensives.Earthshieldooc and not d:AffectingCombat()or not D.Enhancement.Defensives.Earthshieldooc)and((U.ElementalOrbit:IsAvailable()or D.Enhancement.PreferEarthShield)and(U.EarthShield:IsReady()and(d:BuffDown(K)or not d:AffectingCombat()and d:BuffStack(K)<5)))then if o.CastTarget(U.EarthShield,(o.TName()).PLAYER)then return"\069\097\114\116\104\083\104\105\101\108\100"end elseif(D.Enhancement.Defensives.Earthshieldooc and not d:AffectingCombat()or not D.Enhancement.Defensives.Earthshieldooc)and((U.ElementalOrbit:IsAvailable()or not D.Enhancement.PreferEarthShield or not U.EarthShield:IsAvailable())and(U.LightningShield:IsReady()and d:BuffDown(U.LightningShield)))then if I(U.LightningShield)then return"\108\105\103\104\116\110\105\110\103\095\115\104\105\101\108\100 \109\097\105\110 \051"end end if U.SkyFury:IsReady()and(d:Level()>=16 and(not d:DebuffUp(U.Corruption)and((G.GroupBuffMissing(U.SkyFuryBuff)and(D.Commons.SkyFury=="\099\104\101\099\107 \119\104\111\108\101 \103\114\111\117\112"and(d:IsInRaidArea()or d:IsInDungeonArea()))or d:BuffDown(U.SkyFuryBuff,true)and(D.Commons.SkyFury=="\111\110\108\121 \099\104\101\099\107 \117\115"or D.Commons.SkyFury=="\099\104\101\099\107 \119\104\111\108\101 \103\114\111\117\112"))and not d:IsMounted())))then if o.CastTarget(U.SkyFury,(o.TName()).PLAYER)then return"\083\107\121\070\117\114\121"end end J=OE()if J then return J end if G.TargetIsValid()then if not D.Enhancement.AttackonlyinCombat or D.Enhancement.AttackonlyinCombat and R:AffectingCombat()then if not GE(N.Target)then if not d:AffectingCombat()then J=gE()if J then return J end end if InterruptToggle then J=G.InterruptCycle(U.WindShear,30,true,nil,false)J=G.InterruptCycle(U.Thunderstorm,10,false,nil,true,true)end J=oE>0 and(not R:IsInRange(5)and DE())if J then return J end if D.Commons.Enabled.Potions and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or YE%300<=30 or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable()))then local K=G.PotionSelected()if K and(K:IsReady()and IsPotions)then o.CastMacro(3,nil,nil,K)return"\067\097\115\116 \080\111\116\105\111\110"end end if J then return J end if D.Commons.Enabled.Trinkets then if x:IsReady()and(TargetInMeleeRange and(IsTrinket1 and(not z and(not c and(x:HasUseBuff()and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%X<=x:BuffDuration()or dE>=X or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable())))))))then if I(x,true)then return"\116\114\105\110\107\101\116\049 \109\097\105\110 \056"end end if H:IsReady()and(TargetInMeleeRange and(IsTrinket2 and(not a and(not L and(H:HasUseBuff()and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%e<=H:BuffDuration()or dE>=e or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable())))))))then if I(H,true)then return"\116\114\105\110\107\101\116\050 \109\097\105\110 \049\048"end end if x:IsReady()and(TargetInMeleeRange and(IsTrinket1 and(not z and(not c and not x:HasUseBuff()))))then if I(x,true)then return"\116\114\105\110\107\101\116\049 \109\097\105\110 \049\054"end end if H:IsReady()and(TargetInMeleeRange and(IsTrinket2 and(not a and(not L and not H:HasUseBuff()))))then if I(H,true)then return"\116\114\105\110\107\101\116\050 \109\097\105\110 \049\056"end end end if U.BloodFury:IsCastable()and(IsRacials and(TargetInMeleeRange and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%120<=15 or dE>=120 or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable()))))then if I(U.BloodFury,true)then return"\098\108\111\111\100\095\102\117\114\121 \114\097\099\105\097\108"end end if U.Berserking:IsCastable()and(IsRacials and(TargetInMeleeRange and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%180<=12 or dE>=180 or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable()))))then if I(U.Berserking,true)then return"\098\101\114\115\101\114\107\105\110\103 \114\097\099\105\097\108"end end if U.Fireblood:IsCastable()and(IsRacials and(TargetInMeleeRange and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%120<=8 or dE>=120 or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable()))))then if I(U.Fireblood,true)then return"\102\105\114\101\098\108\111\111\100 \114\097\099\105\097\108"end end if U.AncestralCall:IsCastable()and(IsRacials and(TargetInMeleeRange and(d:BuffUp(U.AscendanceBuff)or d:BuffUp(U.FeralSpiritBuff)or d:BuffUp(U.DoomWindsBuff)or YE%120<=15 or dE>=120 or not U.Ascendance:IsAvailable()and(not U.FeralSpirit:IsAvailable()and not U.DoomWinds:IsAvailable()))))then if I(U.AncestralCall,true)then return"\097\110\099\101\115\116\114\097\108\095\099\097\108\108 \114\097\099\105\097\108"end end if U.PrimordialWave:IsReady()and(IsPrimordialWave and(R:IsSpellInRange(U.PrimordialWave)and d:HasTier(31,2)))then if I(U.PrimordialWave)then return"\112\114\105\109\111\114\100\105\097\108\095\119\097\118\101 \109\097\105\110 \050\050"end end if U.FeralSpirit:IsCastable()and(TargetInMeleeRange and(IsFeralSpirit and(U.ElementalSpirits:IsAvailable()or U.AlphaWolf:IsAvailable()and oE>1)))then if I(U.FeralSpirit,true)then return"\102\101\114\097\108\095\115\112\105\114\105\116 \109\097\105\110 \050\052"end end if U.SurgingTotem:IsReady()and(IsSurgingTotem and TargetInMeleeRange)then if o.CastTarget(U.SurgingTotem,(o.TName()).PLAYER)then return"\115\117\114\103\105\110\103\095\116\111\116\101\109 \109\097\105\110 \050\054"end end if U.Ascendance:IsCastable()and(IsAscendance and(TargetInMeleeRange and(R:DebuffUp(U.FlameShockDebuff)and(jE==U.LightningBolt and oE==1 or jE==U.ChainLightning and oE>1))))then if I(U.Ascendance)then return"\097\115\099\101\110\100\097\110\099\101 \109\097\105\110 \050\056"end end if u()and oE>1 then J=eE()if J then return J end end if not u()or oE<2 then J=XE()if J then return J end end if o.CastAnnotated(U.Pool,false,"\087\065\073\084")then return"\087\097\105\116\047\080\111\111\108 \082\101\115\111\117\114\099\101\115"end end end end end local function aE()o.ResetToggle()D.Enhancement.Display()U.FlameShockDebuff:RegisterAuraTracking()o.ToggleIconFrame:AddButtonCustom("\073",1,"\073\110\116\101\114\114\117\112\116","\105\110\116\101\114\114\117\112\116")o.ToggleIconFrame:AddButtonCustom("\068",2,"\068\105\115\112\101\108","\100\105\115\112\101\108")o.ToggleIconFrame:AddButtonCustom("\083",3,"\115\109\097\108\108\067\068\115","\115\109\097\108\108\099\100\115")o.ToggleIconFrame:AddButtonCustom("\080",4,"\085\115\101\083\112\101\110\100\101\114","\117\115\101\115\112\101\110\100\101\114")o.Print("\069\110\104\097\110\099\101\109\101\110\116 \083\104\097\109\097\110 \114\111\116\097\116\105\111\110 \104\097\115 \098\101\101\110 \117\112\100\097\116\101\100 \102\111\114 \112\097\116\099\104 \049\049\046\048\046\050\046 \076\097\115\116 \085\112\100\097\116\101 \049\048\046\049\048\046\050\048\050\052")end o.SetAPL(263,zE,aE)