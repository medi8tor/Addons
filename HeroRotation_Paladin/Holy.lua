local k,U=...local Q=HeroDBC.DBC local u=HeroLib local T=HeroCache local z=u.Unit local A=z.Player local h=z.Target local Z,x=z.Focus,z.MouseOver local g=z.Pet local O=u.Spell local E=u.Item local s=HeroRotation()local e=s.AoEON local G=s.CDsON local M=s.Cast local I=s.CastTarget local q=(s.Commons()).Everyone local l=(s.Commons()).Everyone.num local n=(s.Commons()).Everyone.bool local R=math.floor local K=GetTotemInfo local P=GetTime local C=O.Paladin.Holy local a=E.Paladin.Holy local function d(k)return k:NPCID()==204560 end local function J(k)return k:NPCID()==204773 end local function B(k)return k:NPCID()==204449 or k:NPCID()==208459 or k:NPCID()==208461 or k:NPCID()==207800 or k:NPCID()==194646 or k:NPCID()==212590 end local function r()return B(h)and not A:CanAttack(h)end local F={a.ScreamingBlackDragonScale:ID();a.BroodkeepersPromise:ID()}local i=q.converArrayToList({48707;48792,198589;187827,102342,61336,363916;186265;45438,116849;122783,122278,642,498,6940,33206;47585;31224;108271,104773,108416,118038;342245,363916})local V,o local S local v,D local H=s.GUISettingsGet()local w={General=H.General;Commons=H.APL.Paladin.Commons;Holy=H.APL.Paladin.Holy;AoE=not A:IsInRaid()and H.APL.Paladin.HolyAoE or H.APL.Paladin.HolyRaidAoE,AoE2=not A:IsInRaid()and H.APL.Paladin.HolyAoE2 or H.APL.Paladin.HolyRaidAoE2,Healing=not A:IsInRaid()and H.APL.Paladin.HolyHealing or H.APL.Paladin.HolyRaidHealing,SpecialHealing=not A:IsInRaid()and H.APL.Paladin.HolySpecialHealing or H.APL.Paladin.HolyRaidSpecialHealing;Cooldowns=H.APL.Paladin.HolyCooldowns;TyrSettings=H.APL.Paladin.HolyTyrs;DaySettings=H.APL.Paladin.HolyDaybreak;Blessings=H.APL.Paladin.HolyBlessings}local function m()for k=1,4,1 do local U,Q,u,T=K(k)if Q==C.Consecration:Name()then return R(((u+T)-P())+.5)or 0 end end return 0 end local function c(k)local U=k:Name()for k=1,4,1 do local Q,u,T,z=K(k)if u and(U and strfind(U,u,1,true))then local k=math.floor(((T+z)-P())+.5)if k>0 then return k end end end return 0 end local Y=q.converArrayToList({260741,428542})local function f(k,U,Q)return U<Q or q.unitHasDebuffFromList(Y,k)end local p=q.converArrayToList({438473,438879,448847;257326;272711,439365;438877,451222;436246,440468;324909,320614,272662,270590,269266;449444;438495})local j=q.converArrayToList({440468;446717,441216,437533,439341,451102;432117,434252,426826,448888,434093,456751;451939,451871,451965,460092;327397;320596;454439,428535;425974;428879;465012;424879,439577,443494;423324,427329,323149;321669,322614;321821;322756,335141,333485;333633;321754;463182;457664,450095,450077,449444;443507;451222,426734,434655,439792;426771,429427})local L local function y(k)if A:IsInRaid()then return false end for k,U in ipairs(k)do if p[U:CastSpellID()]or p[U:ChannelSpellID()]then return true end end return false end local function b(k)if A:IsInRaid()then return false end for k,U in ipairs(k)do if j[U:CastSpellID()]or j[U:ChannelSpellID()]then return true end end return false end local X=q.converArrayToList({193530,19574,360952;190319,12472;12042,365350,13750;114050,114051;205180,265187;265273;31884,231895;107574,1719,47568,49028;152279;200166;194223;383410;102560;390414,106951;102543;375087})local N=q.converArrayToList({225963;200182,196354;225484;196376,260741,426660,412505,255814,255434;264150;411700;411958;264556;201733,267907,260551;257407;426659;376634,385181})local W={[1]=true;[3]=true,[4]=true;[6]=true;[8]=true,[9]=true;[10]=true}local t={[1]=true,[2]=true;[4]=true;[5]=true;[6]=true;[7]=true,[8]=true,[11]=true,[12]=true}local function kM(k,U)return U[k]or false end local function UM(k)local U=nil local Q=w.Blessings if Q.ManualBlessings then U=A:IsInRaid()and z(Q.BlessingofAutumnRaid)or z(Q.BlessingofAutumnParty)if U and not U:IsDeadOrGhost()then return U end end for k,Q in pairs(k)do if Q:Role()=="\068\065\077\065\071\069\082"and kM(Q:ClassID(),W)then if q.unitHasBuffFromList(X,Q)then return Q end U=Q break end end return U or A end local function QM(k)local U=nil local Q=w.Blessings if Q.SummerOnSelf then return A end if Q.ManualBlessings then U=A:IsInRaid()and z(Q.BlessingOfSummerRaid)or z(Q.BlessingOfSummerParty)if U and not U:IsDeadOrGhost()then return U end end for k,Q in pairs(k)do if Q:Role()=="\068\065\077\065\071\069\082"and kM(Q:ClassID(),t)then if q.unitHasBuffFromList(X,Q)then return Q end if not U then U=Q break end end end return U or A end local function uM(k)local U=nil local Q=w.Cooldowns if Q.ManualSacredWeapon then U=A:IsInRaid()and z(Q.SacredWeaponRaidUnit)or z(Q.SacredWeaponPartyUnit)if U and not U:IsDeadOrGhost()then return U end end for k,Q in pairs(k)do if Q:Role()=="\068\065\077\065\071\069\082"then if q.unitHasBuffFromList(X,Q)then return Q end if not U then U=Q break end end end return U or A end local function TM()local k=nil local U=w.Blessings if U.ManualBlessings then if A:IsInRaid()then k=z(U.BlessingOFSpringRaid)else k=z(U.BlessingOFSpringParty)end if k and(not k:IsDeadOrGhost()and k:IsSpellInRange(C.HolyShock))then return k end end return k or A end local function zM()local k=nil local U=w.Blessings if U.ManualBlessings then k=A:IsInRaid()and z(U.BlessingOfWinterRaid)or z(U.BlessingOfWinterParty)if k and(not k:IsDeadOrGhost()and(k:Role()=="\072\069\065\076\069\082"and k:IsSpellInRange(C.HolyShock)))then return k end end return k or A end local function AM(k)for k,U in pairs(k)do if U:Role()~="\084\065\078\075"and U:DebuffDown(C.ForbearanceDebuff)then local k=U:HealthPercentageWeighted()if not A:IsInRaid()and(w.SpecialHealing.UseBoP and(q.unitHasDebuffFromList(q.DebuffList.Bleed,U)or q.unitHasDebuffFromList(N,U)))or k<=w.SpecialHealing.BoPHP then return U end end end return nil end local function hM(k)if w.SpecialHealing.BoSHP==0 then return nil end local U=nil local Q=100 local u=false local T=false for k,z in pairs(k)do if A~=z then local k=z:HealthPercentage()local h=w.SpecialHealing.BoSHP if q.unitHasBuffFromList(i,z)then h=15 break end if not u and not A:IsInRaid()then T=b(L)or y(L)u=true end if k<=h or T then if k<Q then Q=k U=z if k<=15 then return U end end end end end return U end local function ZM()if C.DevotionAura:IsReady()and(not A:IsMounted()and A:BuffDown(C.DevotionAuraBuff,true))then M(C.DevotionAura)return"\068\101\118\111 \065\117\114\097 \067\097\115\116"end if C.CrusaderAura:IsReady()and(A:IsMounted()and A:BuffDown(C.CrusaderAura,true))then M(C.CrusaderAura)return"\067\114\117\115\097\100\101\114 \065\117\114\097 \067\097\115\116"end end local function xM(k,U,Q,u,T)local z,h,Z=A:GetUseableItems(F,13)if z and q.AoELogic(k,U,T)then if M(z)then return"\116\114\105\110\107\101\116\049 \116\114\105\110\107\101\116\115 \050"end end local x,g,O=A:GetUseableItems(F,14)if x and q.AoELogic(Q,u,T)then if M(x)then return"\116\114\105\110\107\101\116\050 \116\114\105\110\107\101\116\115 \052"end end end local function gM(k,U)local Q=nil local u=math.huge for k,T in pairs(k)do if T:BuffUp(U,nil,true)then local k=T:HealthPercentageWeighted()if k<u then u=k Q=T end end end if Q then return Q else return nil end end local function OM(k)local U=A local Q=U:HealthPercentageWeighted()+U:IncomingHeals()local u=nil local T=math.huge for k,z in pairs(k)do local A=z:HealthPercentageWeighted()+z:IncomingHeals()if z:Role()=="\084\065\078\075"then if not(z:ClassID()==6)and z:HealthPercentage()>=65 then A=A*1.9 elseif z:PowerPercentage()>20 then A=A*1.2 end end if A<Q then Q=A U=z end if z:Role()=="\084\065\078\075"then if u==nil or A<T then T=A u=z end end end return U,u end local function EM(k)local U=UnitGUID("\116\097\114\103\101\116\116\097\114\103\101\116")if k~=nil then for k,Q in pairs(k)do if Q:GUID()==U and(h:CastSpellID()==320788 or h:CastSpellID()==323730)then if Q~=nil then return Q end end end end end local sM=nil local eM=nil local GM=nil local MM,IM,qM,lM,nM,RM,KM,PM,CM,aM,dM,JM local BM,rM,FM,iM,VM,oM,SM,vM,DM,HM,wM,mM,cM,YM,fM,pM,jM,LM,yM local bM local XM,NM,WM,tM,ku,Uu,Qu,uu local Tu,zu,Au,hu,Zu local function xu()if C.DivineProtection:IsCastable()and(w.Holy.DivineProtectionHP>0 and((A:HealthPercentageWeighted()<=w.Holy.DivineProtectionHP or not A:IsInRaid()and(b(L)or y(L)))and A:BuffDown(C.DivineShield)))then s.Cast(C.DivineProtection)return"\068\105\118\105\110\101 \080\114\111\116\101\099\116\105\111\110 \072\080\058"..A:HealthPercentageWeighted()end if C.DivineShield:IsCastable()and(w.Holy.BubbleHP>0 and(A:HealthPercentage()<=w.Holy.BubbleHP and(A:BuffDown(C.ForbearanceDebuff)and(A:BuffDown(C.DivineProtection)or A:HealthPercentage()<10))))then s.Cast(C.DivineShield)return"\068\105\118\105\110\101 \083\104\105\101\108\100 \072\080\058"..A:HealthPercentage()end end local function gu()w.AoE=not A:IsInRaid()and H.APL.Paladin.HolyAoE or H.APL.Paladin.HolyRaidAoE w.AoE2=not A:IsInRaid()and H.APL.Paladin.HolyAoE2 or H.APL.Paladin.HolyRaidAoE2 w.Healing=not A:IsInRaid()and H.APL.Paladin.HolyHealing or H.APL.Paladin.HolyRaidHealing w.SpecialHealing=not A:IsInRaid()and H.APL.Paladin.HolySpecialHealing or H.APL.Paladin.HolyRaidSpecialHealing HM=s.ToggleIconFrame:GetToggle(1)wM=s.ToggleIconFrame:GetToggle(3)uu=s.ToggleIconFrame:GetToggle(5)Au=s.ToggleIconFrame:GetToggle(6)D=q.UnitsinRange(C.HolyShock)o=#A:GetEnemiesInMeleeRange(5)aM=s.ToggleIconFrame:GetToggle(2)V=A:GetEnemiesInMeleeRange(8)bM=h:IsInMeleeRange(5)L=A:GetEnemiesInMeleeRange(40)Zu=EM(D)if e()then S=#V>0 and#V or 1 else S=1 end MM,IM=q.GetLowestHealthUnit(D)if IM then lM=IM:HealthPercentage()yM=math.min(lM+IM:IncomingHeals(),100)else lM=100 yM=100 end if MM then qM=MM:HealthPercentageWeighted()jM=MM:HealthPercentage()hu=math.min(qM+MM:IncomingHeals(),100)LM=math.min(jM+MM:IncomingHeals(),100)else qM=100 jM=100 hu=100 LM=100 end nM=gM(D,C.TyrsDeliveranceBuff)KM=A:BuffUp(C.SealofClarity)and 2 or 3 PM=A:BuffUp(C.DivinePurposeBuff)or A:HolyPower()>=KM or A:BuffUp(C.ShiningRighteousness)CM=A:BuffUp(C.DivinePurposeBuff)and A:BuffRemains(C.DivinePurposeBuff)<2 Tu=C.EternalFlame:IsAvailable()and C.EternalFlame or C.WoG JM=q.BuffCount(D,C.BoV)BM=s.ToggleIconFrame:GetToggle(4)Qu=C.BarrierofFaith:IsAvailable()and(A:BuffUp(C.BlessingofDawn)and A:BuffStack(C.BlessingofDawn)>=2 or A:BuffDown(C.Infusion)or not C.HolyShock:IsReady())or not C.BarrierofFaith:IsAvailable()if C.BlessingofSummer:IsAvailable()then if C.BlessingofAutumn:IsReady()then tM=UM(D)end if C.BlessingofSpring:IsReady()then WM=TM()end if C.BlessingofSummer:IsReady()then XM=QM(D)end if C.BlessingofWinter:IsReady()then NM=zM()end end if C.SacredWeapon:IsReady()then zu=uM(D)end if C.BlessingofSacrifice:IsReady()then ku=not A:IsInRaid()and(w.SpecialHealing.UseBoS and hM(D))or MM end if C.BlessingofProtection:IsReady()then Uu=AM(D)end end local function Ou()if C.DevotionAura:IsReady()and(not A:IsMounted()and A:BuffDown(C.DevotionAuraBuff,true))then M(C.DevotionAura)return"\068\101\118\111 \065\117\114\097 \067\097\115\116"end if qM>=45 and(J(h)and((C.Cleanse:CooldownDown()or not C.ImprovedCleanse:IsAvailable())and h:IsInRange(40)))then if C.HolyShock:IsReady()then M(C.HolyShock)return end if PM and Tu:IsReady()then M(Tu)return end end if qM>=35 and(r()and(h:HealthPercentage()>0 and h:HealthPercentage()<100))then if C.HolyShock:IsReady()then M(C.HolyShock)return end if PM and Tu:IsReady()then M(Tu)return end end if C.Intercession:IsReady()then if h:UnitIsFriend()and(h:IsAPlayer()and(h:Exists()and h:IsDeadOrGhost()))then s.Cast(C.Intercession)return"\073\110\116\101\114\099\101\115\115\105\111\110 \111\110 \084\097\114\103\101\116"end if x:UnitIsFriend()and(x:IsAPlayer()and(x:Exists()and x:IsDeadOrGhost()))then s.CastTarget(C.Intercession,(s.TName()).MOUSEOVER)return"\073\110\116\101\114\099\101\115\115\105\111\110 \111\110 \077\111\117\115\101\111\118\101\114"end end if uu and(A:IsInParty()or A:IsInRaid())then if qM<=30 then s.CastMacro(2,true)end end if not uu then if C.LoH:IsReady()and A:AffectingCombat()then if sM==nil then sM=MM end if sM:HealthPercentage()>w.SpecialHealing.LoHHP and sM:HealthPercentage()>0 then sM=nil eM=nil GM=nil end if sM~=nil then if sM:DebuffDown(C.ForbearanceDebuff)and(sM:HealthPercentage()<=w.SpecialHealing.LoHHP and sM:HealthPercentage()>0)then if eM==nil then eM=P()GM=math.random(150,800)/1000 elseif P()>=eM+GM then if sM:HealthPercentage()<=w.SpecialHealing.LoHHP then sM:Cast(C.LoH)end eM=nil return"\076\111\072"end end end end if A:HealthPercentage()>=30 and A:AffectingCombat()then if C.BlessingofSacrifice:IsReady()then if ku~=nil and(not ku==MM and ku~=A)then ku:Cast(C.BlessingofSacrifice)return"\066\108\101\115\115\105\110\103 \111\102 \083\097\099 - \076\111\103\105\099"end if ku==MM and ku~=A then if ku:HealthPercentageWeighted()<=w.SpecialHealing.BoSHP then ku:Cast(C.BlessingofSacrifice)return"\066\108\101\115\115\105\110\103 \111\102 \083\097\099"end end end end if C.BlessingofProtection:IsReady()then if Uu~=nil then Uu:Cast(C.BlessingofProtection)return"\066\111\080 \067\097\115\116\101\100 \119\105\116\104 \076\111\103\105\099"end end if A:AffectingCombat()then if C.AvengingWrath:IsReady()and q.AoELogicWithCountUnweighted(w.AoE.AWHP,w.AoE.AWCount,w.Cooldowns.AWUsage,D)then s.Cast(C.AvengingWrath,false)return"\065\118\101\110\103\105\110\103 \087\114\097\116\104 \067\097\115\116\101\100 \080\101\114 \083\101\116\116\105\110\103\115"end if C.AvengingCrusader:IsReady()and q.AoELogicWithCountUnweighted(w.AoE.ACHP,w.AoE.ACCount,w.Cooldowns.ACUsage,D)then M(C.AvengingCrusader,false)return"\065\118\101\110\103\105\110\103 \067\114\117\115\097\100\101\114 \067\097\115\116\101\100 \080\101\114 \083\101\116\116\105\110\103\115"end if C.AuraMastery:IsReady()and q.AoELogicWithCountUnweighted(w.AoE.AMHP,w.AoE.AMCount,w.Cooldowns.AMUsage,D)then M(C.AuraMastery,false)return"\065\117\114\097 \077\097\115\116\101\114\121 \067\097\115\116\101\100 \080\101\114 \083\101\116\116\105\110\103\115"end end if C.BoV:CooldownRemains()>=8.5 or JM>1 or not C.BoV:IsAvailable()then if C.HolyPrism:IsReady()and(qM>45 and(h:IsInRange(40)and(A:AffectingCombat()and(h:AffectingCombat()and(q.TargetIsValid()and q.AoELogicWithCount(w.AoE2.HPHP,w.AoE2.HPCount,w.Cooldowns.HPUsage,D))))))then M(C.HolyPrism)return"\072\111\108\121 \080\114\105\115\109 \111\110 \084\097\114\103\101\116 \112\101\114 \083\101\116\116\105\110\103\115"end if C.HolyPrism:IsReady()and(qM<=45 and q.AoELogicWithCount(w.AoE2.HPHP,w.AoE2.HPCount,w.Cooldowns.HPUsage,D))then MM:Cast(C.HolyPrism)return"\072\111\108\121 \080\114\105\115\109 \111\110 \076\111\119\101\116 \085\110\105\116 \112\101\114 \083\101\116\116\105\110\103\115"end end if C.BoV:IsReady()and(A:AffectingCombat()and(q.AoELogicWithCountUnweighted(w.AoE.BoVHP,w.AoE.BoVCount,w.Cooldowns.BoVUsage,D)or w.Cooldowns.BoVUsage=="\087\105\116\104 \076\111\103\105\099"and(b(L)or y(L))))then MM:Cast(C.BoV)return"\066\111\086 \067\097\115\116\101\100 \080\101\114 \083\101\116\116\105\110\103\115"end mM=false if mM and(A:IsInRaid()and not A:AffectingCombat())then mM=false end cM=false if cM and(A:IsInRaid()and not A:AffectingCombat())then cM=false end if not w.Holy.ManualBeacon then if IM~=nil then if C.BoL:IsReady()and(not cM and(IM:BuffDown(C.BoL)and(IM:BuffDown(C.BoF)and q.BuffCount(D,C.BoL)<1)))then IM:Cast(C.BoL)if A:IsInRaid()then cM=true end return"\066\111\076 \079\110 \076\111\119\101\115\116 \084\097\110\107"end end if C.BoF:IsReady()and(not mM and(A:BuffDown(C.BoF)and(A:BuffDown(C.BoL)and q.BuffCount(D,C.BoF)<1)))then A:Cast(C.BoF)if A:IsInRaid()then mM=true end return"\066\111\070 \079\110 \080\108\097\121\101\114"end end if A:AffectingCombat()then if zu~=nil then if C.SacredWeapon:IsReady()then zu:Cast(C.SacredWeapon)return"\083\097\099\114\101\100 \087\101\097\112\111\110"end end if C.HolyBulwark:IsReady()then if w.Healing.HBTank then if IM~=nil then if lM<=w.Healing.HBHP then IM:Cast(C.HolyBulwark)return"\072\111\108\121 \066\117\108\119\097\114\107"end end end if w.Healing.HBTank and(qM<=25 and qM<=w.Healing.HBHP)or not w.Healing.HBTank and qM<=w.Healing.HBHP then MM:Cast(C.HolyBulwark)return"\072\111\108\121 \066\117\108\119\097\114\107"end end end if C.HandofDivintiy:IsReady()and(not A:IsMoving()and(w.TyrSettings.BeforeTyrs and(q.AoELogicWithCount(w.AoE.TyrsHP,w.AoE.TyrsCount,"\087\105\116\104 \076\111\103\105\099",D)and(not A:IsInRaid()and(A:IsInParty()and qM>=60)or A:IsInRaid()))))then M(C.HandofDivintiy)return"\072\097\110\100 \111\102 \068\105\118\105\110\105\116\121 \098\101\102\111\114\101 \084\121\114\115"end if C.TyrsDeliverance:IsReady()and((q.AoELogicWithCount(w.AoE.TyrsHP,w.AoE.TyrsCount,"\087\105\116\104 \076\111\103\105\099",D)or A:BuffUp(C.HandofDivintiy)and w.AoE.TyrsHP>0)and not A:IsMoving())then M(C.TyrsDeliverance)return"\084\121\114\'\115 \098\097\115\101\100 \111\110 \083\101\116\116\105\110\103\115 \097\110\100\047\111\114 \072\097\110\100 \111\102 \068\105\118\105\110\105\116\121 \066\117\102\102"end if C.HandofDivintiy:IsReady()and(not A:IsMoving()and(qM<=w.SpecialHealing.HandofDivinityHP and(qM>=45 and not A:IsMoving())))then M(C.HandofDivintiy)return"\072\097\110\100 \111\102 \068\105\118\105\110\105\116\121 \078\111\114\109\097\108"end if C.BoV:CooldownRemains()>=8.5 or JM>1 or not C.BoV:IsAvailable()then if MM~=nil then if C.DivineToll:IsReady()and q.AoELogicWithCountUnweighted(w.AoE.DivineTollHP,w.AoE.DivineTollCount,w.Cooldowns.DTUsage,D)then MM:Cast(C.DivineToll)return"\068\105\118\105\110\101 \084\111\108\108 \118\105\097 \083\101\116\116\105\110\103\115 \111\114 \105\110 \080\097\114\116\121"end end end if A:BuffUp(C.DivineFavorBuff)and(C.FoL:IsReady()and(not A:PrevGCD(1,C.FoL)and(not A:IsCasting()and((hu<=w.SpecialHealing.FoLBoth and A:BuffUp(C.Infusion)or hu<=w.SpecialHealing.FoLDFHP)and not A:IsMoving()))))then MM:Cast(C.FoL)return"\070\111\076 \102\111\114 \068\105\118\105\110\101 \070\097\118\111\114"end if A:BuffUp(C.DivineFavorBuff)and(C.HolyLight:IsReady()and(not A:PrevGCD(1,C.HolyLight)and(not A:IsCasting()and((hu<=w.SpecialHealing.HLBoth and A:BuffUp(C.Infusion)or hu<=w.SpecialHealing.HLDFHP)and not A:IsMoving()))))then MM:Cast(C.HolyLight)return"\072\111\108\121 \076\105\103\104\116 \102\111\114 \068\105\118\105\110\101 \070\097\118\111\114"end if IM~=nil then if not C.HolyShock:IsReady()and(not A:IsInRaid()or A:IsInRaid()and A:HolyPower()>4)then if C.FoL:IsReady()and(not A:IsMoving()and(A:BuffUp(C.Infusion)and yM<=w.Healing.FoLIHP))then IM:Cast(C.FoL)return"\070\111\076 \073\110\102\117\115\105\111\110 \080\114\105\111\114\105\116\121 - \084\097\110\107"end end if Tu:IsReady()and(PM and lM<=w.Healing.WoGTankHP)then IM:Cast(Tu)return"\087\111\071 \111\110 \084\097\110\107"end end if IM~=nil then if C.BarrierofFaith:IsReady()and IM:BuffDown(C.BarrierofFaith)then IM:Cast(C.BarrierofFaith)return"\066\097\114\114\105\101\114 \111\102 \070\097\105\116\104"end end if not PM or not C.HolyShock:IsReady()then if C.FoL:IsReady()and(A:BuffDown(C.HandofDivintiyBuff)and(A:BuffDown(C.TyrsDeliverancePlayerBuff)and(not A:IsMoving()and(hu<=w.Healing.FoLHP or A:BuffUp(C.Infusion)and hu<=w.Healing.FoLIHP))))then MM:Cast(C.FoL)return"\070\111\076 \069\109\101\114\103\101\110\099\121 \111\114 \073\110\102\117\115\105\111\110 \080\114\105\111\114\105\116\121 - \085\110\105\116 \076\111\119\101\115\116"end end if hu>=65 and(A:AffectingCombat()and C.BlessingofSummer:IsAvailable())then if C.BlessingofAutumn:IsReady()and tM~=nil then tM:Cast(C.BlessingofAutumn)return"\066\108\101\115\115\105\110\103 \111\102 \065\117\116\109\117\110 \067\097\115\116"end if C.BlessingofSpring:IsReady()and WM~=nil then WM:Cast(C.BlessingofSpring)return"\066\108\101\115\115\105\110\103 \111\102 \083\112\114\105\110\103 \067\097\115\116"end if C.BlessingofWinter:IsReady()and NM~=nil then NM:Cast(C.BlessingofWinter)return"\066\108\101\115\115\105\110\103 \111\102 \087\105\110\116\101\114"end if C.BlessingofSummer:IsReady()and XM~=nil then XM:Cast(C.BlessingofSummer)return"\066\108\101\115\115\105\110\103 \111\102 \083\117\109\109\101\114"end end if A:BuffUp(C.TyrsDeliverancePlayerBuff)and C.BoundlessSalvation:IsAvailable()then if nM~=nil then if C.HolyLight:IsReady()and(A:BuffUp(C.HandofDivintiy)and(nM:HealthPercentage()<=w.TyrSettings.TyrHLHP or A:BuffRemains(C.HandofDivintiy)<=6))then nM:Cast(C.HolyLight)return"\072\111\108\121 \076\105\103\104\116 \111\110 \084\121\114\'\115 \084\097\114\103\101\116"end if C.HolyShock:IsReady()and(A:HolyPower()<5 and A:BuffDown(C.RisingSunlight)or A:HolyPower()<3 and A:BuffUp(C.RisingSunlight))then nM:Cast(C.HolyShock)return"\072\111\108\121 \083\104\111\099\107 \111\110 \084\121\114\'\115 \084\097\114\103\101\116"end if C.FoL:IsReady()and(nM:HealthPercentage()<=w.TyrSettings.TyrFoLHP and not A:IsMoving())then nM:Cast(C.FoL)return"\070\108\097\115\104 \111\102 \076\105\103\104\116 \111\110 \084\121\114\'\115 \084\097\114\103\101\116"end end end if A:BuffDown(C.TyrsDeliverancePlayerBuff)or not C.BoundlessSalvation:IsAvailable()then if C.HolyLight:IsReady()and(A:BuffUp(C.HandofDivintiy)and(qM<=w.SpecialHealing.HandofDivinityHP or A:BuffRemains(C.HandofDivintiy)<=6))then MM:Cast(C.HolyLight)return"\072\111\108\121 \076\105\103\104\116 \119\105\116\104 \072\111\068"end end if A:BuffUp(C.AvengingCrusader)then if JM>=1 then if Tu:IsReady()and(PM and(qM<=w.Healing.WoGHP or CM))then MM:Cast(Tu)return"\087\111\071 \111\110 \066\111\086 \085\110\105\116 \068\117\114\105\110\103 \065\067"end end if C.Judgment:IsReady()and(h:IsInRange(30)and(qM<=90 and q.TargetIsValid()))then M(C.Judgment)return"\074\117\100\103\101\109\101\110\116 \068\117\114\105\110\103 \065\067"end if BM and(C.LoD:IsReady()and(PM and(A:BuffDown(C.EmpyreanLegacy)and(q.AoELogicWithCount(w.AoE.LoDHP,w.AoE.LoDCount,"\087\105\116\104 \076\111\103\105\099",D)or CM))))then M(C.LoD)return"\076\111\068 \068\117\114\105\110\103 \065\099"end if C.CrusaderStrike:IsReady()and(bM and(qM<=90 and q.TargetIsValid()))then M(C.CrusaderStrike)return"\067\114\117\115\097\100\101\114 \083\116\114\105\107\101 \068\117\114\105\110\103 \065\067"end if C.HolyShock:IsReady()and qM<=w.Healing.HolyShockHP then MM:Cast(C.HolyShock)return"\072\111\108\121 \083\104\111\099\107 \068\117\114\105\110\103 \065\067"end if C.HammerofWrath:IsReady()and(h:IsInRange(30)and q.TargetIsValid())then M(C.HammerofWrath)return"\072\097\109\109\101\114 \111\102 \087\114\097\116\104 \068\117\114\105\110\103 \065\067"end end if C.VenerationTalent:IsAvailable()then if(C.EternalFlame:IsAvailable()and not PM or not C.EternalFlame:IsAvailable())and(C.HammerofWrath:IsReady()and(h:IsInRange(30)and q.TargetIsValid()))then s.Cast(C.HammerofWrath)return"\072\097\109\109\101\114 \111\102 \087\114\097\116\104 \086\101\110\101\114\097\116\105\111\110"end end if q.TargetIsValid()and(h:AffectingCombat()and(C.Judgment:IsReady()and(h:IsInRange(30)and(qM<=90 or A:BuffUp(C.AwakeningMaxBuff)and q.AoELogicWithCount(75,3,"\087\105\116\104 \076\111\103\105\099",D)or A:BuffUp(C.AwakeningMaxBuff)and A:BuffRemains(C.AwakeningMaxBuff)<3))))then s.Cast(C.Judgment)return"\074\117\100\103\101\109\101\110\116 \119\105\116\104 \065\119\097\107\101\110\105\110\103 \077\097\120 \066\117\102\102 \080\114\105\111\114\105\116\121"end if JM>=1 then if(not A:IsInRaid()or A:BuffUp(C.EmpyreanLegacy))and(Tu:IsReady()and(PM and(qM<=w.Healing.WoGHP or q.AoELogicWithCount(w.AoE.LoDHP,w.AoE.LoDCount,"\087\105\116\104 \076\111\103\105\099",D)or CM)))then MM:Cast(Tu)return"\087\111\071 \100\117\114\105\110\103 \066\111\086"end if A:IsInRaid()and(BM and(C.LoD:IsReady()and(PM and(A:BuffDown(C.EmpyreanLegacy)and(q.AoELogicWithCount(w.AoE.LoDHP,w.AoE.LoDCount,"\087\105\116\104 \076\111\103\105\099",D)or CM)))))then M(C.LoD)return"\076\111\068 \105\110 \082\097\105\100 \068\117\114\105\110\103 \066\111\086"end end if BM and(Tu:IsReady()and(PM and(Qu and(qM<=w.Healing.WoGOverHP or CM))))then MM:Cast(Tu)return"\087\111\071 \079\118\101\114 \076\111\068"end if JM<1 then if BM and(Qu and(C.LoD:IsReady()and(PM and(A:BuffDown(C.EmpyreanLegacy)and(q.AoELogicWithCount(w.AoE.LoDHP,w.AoE.LoDCount,"\087\105\116\104 \076\111\103\105\099",D)or CM)))))then M(C.LoD)return"\076\111\068"end end if Tu:IsReady()and(Qu and(PM and(qM<=w.Healing.WoGHP or CM)))then MM:Cast(Tu)return"\087\111\071"end if C.FoL:IsReady()and(not A:IsMoving()and(A:BuffUp(C.Infusion)and hu<=w.Healing.FoLIHP))then MM:Cast(C.FoL)return"\070\111\076 \070\111\114 \073\110\102\117\115\105\111\110"end if C.HolyShock:IsReady()then iM=f(MM,jM,w.Healing.HolyShockHP)VM=f(MM,jM,w.Healing.HolyShock2HP)oM=iM and A:BuffDown(C.RisingSunlight)SM=VM and(C.HolyShock:Charges()==2 and A:BuffDown(C.RisingSunlight))vM=qM<=w.Healing.HolyShockRHP and A:BuffUp(C.RisingSunlight)DM=A:HolyPower()<5 and A:BuffDown(C.RisingSunlight)or A:HolyPower()<4 and A:BuffUp(C.RisingSunlight)or w.Holy.Overcap if(oM or SM or vM)and DM then MM:Cast(C.HolyShock)return"\072\111\108\121 \083\104\111\099\107 \067\097\115\116"end end if q.TargetIsValid()and h:AffectingCombat()then if C.HammerofWrath:IsReady()and h:IsInRange(30)then s.Cast(C.HammerofWrath)return"\072\097\109\109\101\114 \111\102 \087\114\097\116\104"end if C.Judgment:IsReady()and(h:IsInRange(30)and(qM<=90 or A:BuffUp(C.AwakeningMaxBuff)))then s.Cast(C.Judgment)return"\074\117\100\103\101\109\101\110\116"end if C.CrusaderStrike:IsReady()and((A:HolyPower()<5 or w.Holy.Overcap)and bM)then s.Cast(C.CrusaderStrike)return"\067\114\117\115\097\100\101\114 \083\116\114\105\107\101"end end if C.FoL:IsReady()and(not A:IsMoving()and(qM<=w.Healing.FoLHP or A:BuffUp(C.Infusion)and hu<=w.Healing.FoLIHP))then MM:Cast(C.FoL)return"\070\111\076 \070\111\114 \073\110\102\117\115\105\111\110 \111\114 \078\111\114\109\097\108"end if C.HolyLight:IsReady()and((not A:IsMoving()or A:BuffUp(C.HandofDivintiy))and(hu<=w.Healing.HLHP or A:BuffUp(C.Infusion)and hu<=w.Healing.HLIHP))then MM:Cast(C.HolyLight)return"\072\111\108\121 \076\105\103\104\116 \070\111\114 \073\110\102\117\115\105\111\110 \111\114 \078\111\114\109\097\108"end end if q.TargetIsValid()and((qM>=45 or uu)and(not d(h)and(h:AffectingCombat()or w.Holy.AttackOOC and HM)))then if C.Consecration:IsReady()and(h:IsInRange(8)and(not A:IsMoving()and c(C.Consecration)<=0))then M(C.Consecration)return"\099\111\110\115\101\099\114\097\116\105\111\110 \112\114\105\111\114\105\116\121 \050\048"end if C.ShieldoftheRighteous:IsUsable()and(bM and(A:HolyPower()>=3 and(A:BuffUp(C.AvengingWrathBuff)and hu>=55 or Au or uu)))then s.Cast(C.ShieldoftheRighteous)return"\115\104\105\101\108\100\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \112\114\105\111\114\105\116\121 \050"end if C.HammerofWrath:IsReady()and(h:IsInRange(30)and(A:HolyPower()<5 or w.Holy.Overcap or uu))then M(C.HammerofWrath)return"\104\097\109\109\101\114\095\111\102\095\119\114\097\116\104 \112\114\105\111\114\105\116\121 \052"end if C.DivineToll:IsReady()and(uu and(w.Holy.UseDTDPS and h:IsInRange(40)))then M(C.DivineToll)return"\068\105\118\105\110\101 \084\111\108\108 \102\111\114 \068\080\083 \079\110\108\121"end if C.HammerofWrath:IsReady()and(h:IsInRange(30)and(A:HolyPower()<5 or w.Holy.Overcap or uu))then M(C.HammerofWrath)return"\104\097\109\109\101\114\095\111\102\095\119\114\097\116\104 \112\114\105\111\114\105\116\121 \049\052"end if C.Judgment:IsReady()and(h:IsInRange(30)and(A:HolyPower()<5 or w.Holy.Overcap or uu))then M(C.Judgment)return"\106\117\100\103\109\101\110\116 \112\114\105\111\114\105\116\121 \049\054"end if C.HolyShock:IsReady()and(h:IsInRange(40)and(w.Holy.UseHolyShockDPS and(A:HolyPower()<5 or w.Holy.Overcap)or uu))then M(C.HolyShock)return"\104\111\108\121\095\115\104\111\099\107 \112\114\105\111\114\105\116\121 \050\050"end if C.CrusaderStrike:IsReady()and(bM and(A:HolyPower()<5 or w.Holy.Overcap or uu))then M(C.CrusaderStrike)return"\099\114\117\115\097\100\101\114\095\115\116\114\105\107\101 \112\114\105\111\114\105\116\121 \050\052"end if C.HolyPrism:IsReady()and(S>=2 or uu)then A:Cast(C.HolyPrism)return"\104\111\108\121\095\112\114\105\115\109 \111\110 \115\101\108\102 \112\114\105\111\114\105\116\121 \050\054"end end end local function Eu()if not A:IsInRaid()and q.ShouldStopCastUpdate()then s.CastMacro(6,true)return"\083\116\111\112 \067\097\115\116 \070\111\114 \083\105\108\101\110\099\101"end if not A:AffectingCombat()then v=ZM()if v then return v end end if not A:IsMounted()and(q.TargetIsValid()or A:AffectingCombat()or HM)then if wM then v=q.InterruptCycle(C.Rebuke,5,true,nil,false,false)if v then return v end if C.Rebuke:CooldownDown()or not C.Rebuke:IsAvailable()then if C.BlindingLight:IsReady()and w.Holy.UseBL then v=q.InterruptCycle(C.BlindingLight,10,false,nil,true,true)if v then return v end end if C.HammerofJustice:IsReady()then v=q.InterruptCycle(C.HammerofJustice,10,false,nil,true)if v then return v end end end end if C.BlessingofFreedom:IsReady()and w.Holy.UseFreedom then if Zu~=nil then if Zu:Cast(C.BlessingofFreedom)then return"\066\108\101\115\115\105\110\103 \111\102 \070\114\101\101\100\111\109 \070\114\111\122\101\110 \066\105\110\100\115"end end end if C.BlessingofFreedom:IsReady()and w.Holy.UseFreedom then v=q.DispelCycle(C.BlessingofFreedom,"\082\111\111\116\068\105\115\112\101\108",nil,D)if v then return v end v=q.DispelCycle(C.BlessingofFreedom,"\083\110\097\114\101\082\111\111\116",nil,D)if v then return v end v=q.DispelCycle(C.BlessingofFreedom,"\070\114\101\101\100\111\109\068\105\115\112\101\108",nil,D)if v then return v end end if aM then if not A:IsInRaid()then if C.Cleanse:IsReady()then if C.ImprovedCleanse:IsAvailable()then v=q.AfflictedLogic(C.Cleanse)if v then return v end end v=q.DispelCycle(C.Cleanse,"\077\097\103\105\099",nil,D)if v then return v end if C.ImprovedCleanse:IsAvailable()then v=q.DispelCycle(C.Cleanse,"\080\111\105\115\111\110",nil,D)if v then return v end v=q.DispelCycle(C.Cleanse,"\068\105\115\101\097\115\101",nil,D)if v then return v end end end end if A:IsInRaid()and C.Cleanse:IsReady()then v=q.DispelCycle(C.Cleanse,"\082\097\105\100",nil,D)if v then return v end end end if A:IsInRaid()and C.BlessingofFreedom:IsReady()then if A:DebuffUp(O(424495),true)or A:DebuffUp(O(424497),true)then A:Cast(C.BlessingofFreedom)return end end if C.Repentance:IsReady()and(not A:IsInRaid()and A:AffectingCombat())then v=q.IncorpCycle(C.Repentance,30,false,false)if v then return v end end if C.TurnEvil:IsReady()and(not A:IsInRaid()and(not C.Repentance:IsAvailable()or C.Repentance:CooldownDown()))then v=q.IncorpCycle(C.TurnEvil,40,false,false)if v then return v end end if w.Holy.AutoTabMelee and(o>0 and(not bM and A:CanAttack(h)))then s.TopPanelAlternative:ChangeIcon(1,3)return"\065\117\116\111 \116\097\098 \116\111 \109\101\108\101\101"end v=xu()if v then return v end v=A:AffectingCombat()and xM(w.Cooldowns.Trinket1HP,w.Cooldowns.Trinket1Use,w.Cooldowns.Trinket2HP,w.Cooldowns.Trinket2Use,D)if v then return v end if q.TargetIsValid()or A:AffectingCombat()then v=Ou()end if v then return v end end end local function su()s.ResetToggle()w.Holy.Display()s:UpdateMacro("\109\097\099\114\111\049","\047\117\115\101 \049\054")s:UpdateMacro("\109\097\099\114\111\050","\047\104\114 \100\112\115\111\110\108\121")s:UpdateMacro("\109\097\099\114\111\054","\047\115\116\111\112\099\097\115\116\105\110\103")s.ToggleIconFrame:AddButtonCustom("\079",1,"\079\079\067","\111\111\099")s.ToggleIconFrame:AddButtonCustom("\068",2,"\068\105\115\112\101\108","\100\105\115\112\101\108")s.ToggleIconFrame:AddButtonCustom("\075",3,"\075\105\099\107","\107\105\099\107")s.ToggleIconFrame:AddButtonCustom("\076",4,"\076\105\103\104\116 \111\102 \068\097\119\110","\108\105\103\104\116\111\102\100\097\119\110")s.ToggleIconFrame:AddButtonCustom("\068\080",5,"\068\080\083 \079\110\108\121","\100\112\115\111\110\108\121")s.ToggleIconFrame:AddButtonCustom("\083",6,"\083\104\105\101\108\100 \111\102 \116\104\101 \082\105\103\104\116\101\111\117\115","\115\104\105\101\108\100\111\102\116\104\101\114\105\103\104\116\101\111\117\115")s.Print("\072\111\108\121 \080\097\108\097\100\105\110 \114\111\116\097\116\105\111\110 \104\097\115 \098\101\101\110 \117\112\100\097\116\101\100 \102\111\114 \080\114\101-\080\097\116\099\104")end s.SetAPL(65,Eu,su,gu)