local k,U=...local Q=HeroDBC.DBC local u=HeroLib local T=HeroCache local z=u.Unit local A=z.Player local h=z.Target local Z=z.MouseOver local x=z.Pet local g=u.Spell local O=u.Item local E=HeroRotation()local s=E.AoEON local e=E.CDsON local G=E.Cast local M=(E.Commons()).Everyone.num local I=(E.Commons()).Everyone.bool local q=math.max local l=math.min local n=g.Paladin.Protection local R=O.Paladin.Protection local K={R.ManicGrieftorch:ID()}local P={{n.HammerofJustice;"\067\097\115\116 \072\097\109\109\101\114 \111\102 \074\117\115\116\105\099\101 \040\073\110\116\101\114\114\117\112\116\041",function()return true end}}local C local a local d,J local B,r local F=5 local i local V=11111 local o=11111 local S,v,D,H local w local m=A:GetEquipment()local c=m[13]and O(m[13])or O(0)local Y=m[14]and O(m[14])or O(0)u:RegisterForEvent(function()m=A:GetEquipment()c=m[13]and O(m[13])or O(0)Y=m[14]and O(m[14])or O(0)end,"\080\076\065\089\069\082\095\069\081\085\073\080\077\069\078\084\095\067\072\065\078\071\069\068")local function f()return R.ManicGrieftorch:IsEquipped()and(R.ManicGrieftorch:CooldownUp()or R.ManicGrieftorch:CooldownRemains()<=A:GCDRemains())end local function p()return R.AlgetharPuzzleBox:IsEquipped()and(R.AlgetharPuzzleBox:CooldownUp()or R.AlgetharPuzzleBox:CooldownRemains()<=A:GCDRemains())end u:RegisterForEvent(function()V=11111 o=11111 end,"\080\076\065\089\069\082\095\082\069\071\069\078\095\069\078\065\066\076\069\068")local j=E.GUISettingsGet()local L=(E.Commons()).Everyone local y=(E.Commons()).Paladin local b={General=j.General,Commons=j.APL.Paladin.Commons,ProtectionDefensives=j.APL.Paladin.ProtectionDefensives,Protection=j.APL.Paladin.Protection;ProtTTD=j.APL.Paladin.ProtTTD}local function X()if j.General.AutoTab and A:AffectingCombat()then E.TopPanelAlternative:ChangeIcon(1,3)return"\065\117\116\111 \116\097\098 \116\111 \116\097\114\103\101\116"end end local function N(k)return i or L.ISSolo()or k==0 or L.Buggedmobs[h:NPCID()]or o>=k and o<7777 end local function W(k,U)return k~="\078\111\116 \085\115\101\100"and(N(b.ProtTTD.TrinketsTTD)and(k=="\087\105\116\104 \067\111\111\108\100\111\119\110\115"and E.CDsON()or k=="\087\105\116\104 \083\109\097\108\108 \111\114 \067\111\111\108\100\111\119\110\115"and(SmallCDToggle or E.CDsON())or k=="\087\105\116\104 \083\109\097\108\108 \067\068\115"and SmallCDToggle or k=="\079\110 \077\111\098\099\111\117\110\116"and B>=b.Protection.Mobcount or k=="\079\110 \077\111\098\099\111\117\110\116 \111\114 \067\111\111\108\100\111\119\110\115"and(B>=b.Protection.Mobcount or e())or k=="\065\108\119\097\121\115"or k=="\079\110 \066\111\115\115\101\115"and i or k=="\077\111\098\099\111\117\110\116 \111\114 \066\111\115\115"and(i or B>=b.Protection.Mobcount)))or k=="\079\110 \072\101\097\108\116\104\080\101\114\099\101\110\116"and(U~=nil and A:HealthPercentageWeighted()<U)end local function t()return A:BuffUp(n.ArdentDefender)or A:BuffUp(n.GuardianofAncientKings)or A:BuffUp(n.DivineShield)end local function kM()return b.Protection.Consecration or not A:IsMoving()end local UM={225963,200182;196354,225484,196376,260741,426660,412505;255814;255434;264150,411700,411958,264556;201733,267907,260551;257407;426659}local function QM(k)local U=nil for k,Q in pairs(k)do if A~=Q then if Q:Role()~="\084\065\078\075"and((b.ProtectionDefensives.BoPDebuff and(L.unitHasDebuffFromList(L.DebuffList.Bleed,Q)or L.unitHasDebuffFromList(UM,Q))or Q:HealthPercentageWeighted()<=b.ProtectionDefensives.BoPHP)and Q:DebuffDown(n.ForbearanceDebuff))then U=Q end end end return U end local function uM(k)local U=b.ProtectionDefensives.IntercessionUnit if U=="\065\108\108"then for k,U in pairs(k)do if U:IsDeadOrGhost()then return U end end return nil end local Q={None={},Tank={"\084\065\078\075"},Healer={"\072\069\065\076\069\082"};["\084\097\110\107 \097\110\100 \072\101\097\108\101\114"]={"\084\065\078\075";"\072\069\065\076\069\082"},DD={"\068\065\077\065\071\069\082"}}local u=Q[U]or{}for k,U in pairs(k)do local Q=U:Role()local T=U:IsDeadOrGhost()for k,u in ipairs(u)do if Q==u and T then return U end end end return nil end local function TM(k)local U=UnitGUID("\116\097\114\103\101\116\116\097\114\103\101\116")if k~=nil then for k,Q in pairs(k)do if Q:GUID()==U and(h:CastSpellID()==320788 or h:CastSpellID()==323730)then if Q~=nil then return Q end end end end end local function zM(k)return k:DebuffRemains(n.JudgmentDebuff)end local function AM()return A:BuffDown(n.DevotionAura)and(A:BuffDown(n.ConcentrationAura)and A:BuffDown(n.CrusaderAura))end local function hM()if not n.OfDuskandDawn:IsAvailable()then return-1 end return(6-y.HPGCount)-A:BuffStack(n.BlessingofDawnBuff)*3 end local function ZM()if n.DevotionAura:IsCastable()and AM()then if G(n.DevotionAura)then return"\100\101\118\111\116\105\111\110\095\097\117\114\097 \112\114\101\099\111\109\098\097\116 \054"end end if n.LightsJudgment:IsCastable()and(h:IsInMeleeRange(5)and RacialsSetting)then if G(n.LightsJudgment)then return"\108\105\103\104\116\115\095\106\117\100\103\109\101\110\116 \112\114\101\099\111\109\098\097\116 \056"end end if n.ArcaneTorrent:IsCastable()and(h:IsInMeleeRange(8)and RacialsSetting)then if G(n.ArcaneTorrent)then return"\097\114\099\097\110\101\095\116\111\114\114\101\110\116 \112\114\101\099\111\109\098\097\116 \049\048"end end if n.Consecration:IsCastable()and(kM()and h:IsInMeleeRange(5))then if G(n.Consecration)then return"\099\111\110\115\101\099\114\097\116\105\111\110 \112\114\101\099\111\109\098\097\116 \049\050"end end if n.AvengersShield:IsCastable()and(h:IsSpellInRange(n.AvengersShield)and h:IsSpellInRange(n.AvengersShield))then if G(n.AvengersShield)then return"\097\118\101\110\103\101\114\115\095\115\104\105\101\108\100 \112\114\101\099\111\109\098\097\116 \049\048"end end if n.Judgment:IsReady()and(h:IsSpellInRange(n.Judgment)and h:IsSpellInRange(n.Judgment))then if G(n.Judgment)then return"\106\117\100\103\109\101\110\116 \112\114\101\099\111\109\098\097\116 \049\050"end end end local function xM()if A:HealthPercentage()<=b.ProtectionDefensives.LoHHP and(n.LayonHands:IsCastable()and A:DebuffDown(n.ForbearanceDebuff))then if G(n.LayonHands,nil)then return"\108\097\121\095\111\110\095\104\097\110\100\115 \100\101\102\101\110\115\105\118\101 \050"end end if n.GuardianofAncientKings:IsCastable()and((A:HealthPercentageWeighted()<=b.ProtectionDefensives.GoAKHP and A:BuffDown(n.ArdentDefenderBuff)or b.ProtectionDefensives.TankBusters and A:IncomingSpell(L.TankBustersList2))and not t())then if G(n.GuardianofAncientKingsCast,nil)then return"\103\117\097\114\100\105\097\110\095\111\102\095\097\110\099\105\101\110\116\095\107\105\110\103\115 \100\101\102\101\110\115\105\118\101 \052"end end if n.ArdentDefender:IsCastable()and((A:HealthPercentageWeighted()<=b.ProtectionDefensives.ArdentDefenderHP or b.ProtectionDefensives.TankBusters and A:IncomingSpell(L.TankBustersList2))and not t())then if G(n.ArdentDefender,nil)then return"\097\114\100\101\110\116\095\100\101\102\101\110\100\101\114 \100\101\102\101\110\115\105\118\101 \054"end end if n.WordofGlory:IsReady()and(A:BuffUp(n.ShiningLightFreeBuff)and(n.FaithintheLight:IsAvailable()and(not A:BuffUp(n.FaithintheLightBuff)and b.ProtectionDefensives.WordofGloryFaithintheLight)))then if G(n.WordofGlory)then return"\119\111\114\100\095\111\102\095\103\108\111\114\121 \070\097\105\116\104\105\110\116\104\101\076\105\103\104\116\066\117\102\102"end end if n.WordofGlory:IsReady()and((A:HealthPercentageWeighted()<=b.ProtectionDefensives.WordofGloryPlayerHP or A:HealthPercentageWeighted()<=b.ProtectionDefensives.FreeWordofGloryPlayerHP and A:BuffUp(n.ShiningLightFreeBuff))and not A:HealingAbsorbed())then if G(n.WordofGlory)then return"\119\111\114\100\095\111\102\095\103\108\111\114\121 \100\101\102\101\110\115\105\118\101 \056"end end if A:HealthPercentageWeighted()<=b.ProtectionDefensives.BubbleHP and(n.DivineShield:IsCastable()and A:DebuffDown(n.ForbearanceDebuff))then if G(n.DivineShield,nil)then return"\068\105\118\105\110\101 \083\104\105\101\108\100 \100\101\102\101\110\115\105\118\101"end end end local function gM()S=L.UnitsinRange(n.FlashofLight)v=L.GetLowestHealthUnit(S)D=v:HealthPercentageWeighted()H=uM(S)BoPTarget=QM(S)if not v:DebuffUp(n.ForbearanceDebuff)then if n.LayonHands:IsReady()and D<=b.ProtectionDefensives.LoHPartyHP then v:Cast(n.LayonHands)return"\076\097\121 \111\110 \072\097\110\100\115 \080\097\114\116\121"end end if n.BlessingofProtection:IsReady()then if BoPTarget~=nil and BoPTarget~=A then BoPTarget:Cast(n.BlessingofProtection)return"\066\108\101\115\115\105\110\103 \111\102 \080\114\111\116\101\099\116\105\111\110 \080\097\114\116\121"end end if n.Intercession:IsReady()then if Z:UnitIsFriend()and(Z:UnitIsPlayer()and(Z:Exists()and Z:IsDeadOrGhost()))then E.CastTarget(n.Intercession,(E.TName()).MOUSEOVER)return"\073\110\116\101\114\099\101\115\115\105\111\110 \111\110 \077\111\117\115\101\111\118\101\114"end if b.ProtectionDefensives.IntercessionTarget and(h:UnitIsFriend()and(h:Exists()and h:IsDeadOrGhost()))then E.Cast(n.Intercession)return"\073\110\116\101\114\099\101\115\115\105\111\110 \111\110 \084\097\114\103\101\116"end end if n.BlessingofSacrifice:IsReady()and(D<=b.ProtectionDefensives.BlessingOfSacrificeHP and(A:HealthPercentage()>90 and A:BuffDown(n.BlessingofProtection)))then v:Cast(n.BlessingofSacrifice)return"\066\108\101\115\115\105\110\103\111\102\083\097\099\114\105\102\105\099\101 \080\097\114\116\121"end if n.WordofGlory:IsReady()and(D<=b.ProtectionDefensives.WordofGloryPartyHP or D<=b.ProtectionDefensives.FreeWordofGloryPartyHP and A:BuffUp(n.ShiningLightFreeBuff))then v:Cast(n.WordofGlory)return"\087\111\114\100 \111\102 \071\108\111\114\121 \080\097\114\116\121"end end local function OM()if n.LightsJudgment:IsCastable()and(RacialsSetting and(h:IsInRange(5)and h:IsSpellInRange(n.LightsJudgment)))then if G(n.LightsJudgment,false,nil,not h:IsSpellInRange(n.LightsJudgment))then return"\108\105\103\104\116\115\095\106\117\100\103\109\101\110\116 \099\111\111\108\100\111\119\110\115 \050"end end if n.AvengingWrath:IsCastable()and(AvengingWrathSetting and h:IsInRange(5))then if G(n.AvengingWrath,false)then return"\097\118\101\110\103\105\110\103\095\119\114\097\116\104 \099\111\111\108\100\111\119\110\115 \052"end end if n.Sentinel:IsCastable()and(AvengingWrathSetting and h:IsInRange(5))then if G(n.Sentinel,false)then return"\115\101\110\116\105\110\101\108 \099\111\111\108\100\111\119\110\115 \054"end end if b.Commons.Enabled.Potions and(PotionSetting and A:BuffUp(n.AvengingWrathBuff))then local k=L.PotionSelected()if k and k:IsReady()then E.CastMacro(3,nil,nil,k)return"\067\097\115\116 \080\111\116\105\111\110"end end if n.MomentofGlory:IsCastable()and(A:BuffUp(n.AvengingWrathBuff)and A:BuffRemains(n.AvengingWrathBuff)<15 or(u.CombatTime()>10 or n.AvengingWrath:CooldownRemains()>15)and(n.AvengersShield:CooldownDown()and(n.Judgment:CooldownDown()and n.HammerofWrath:CooldownDown())))then if G(n.MomentofGlory,false)then return"\109\111\109\101\110\116\095\111\102\095\103\108\111\114\121 \099\111\111\108\100\111\119\110\115 \049\048"end end if n.DivineToll:IsCastable()and(DivineTollSetting and B>=3)then if G(n.DivineToll)then return"\100\105\118\105\110\101\095\116\111\108\108 \099\111\111\108\100\111\119\110\115 \049\050"end end if n.BastionofLight:IsCastable()and(A:BuffUp(n.AvengingWrathBuff)or n.AvengingWrath:CooldownRemains()<=30)then if G(n.BastionofLight,false)then return"\098\097\115\116\105\111\110\095\111\102\095\108\105\103\104\116 \099\111\111\108\100\111\119\110\115 \049\052"end end if n.Fireblood:IsCastable()and(h:IsInMeleeRange(5)and(RacialsSetting and A:BuffRemains(n.AvengingWrathBuff)>8))then if G(n.Fireblood)then return"\102\105\114\101\098\108\111\111\100 \099\111\111\108\100\111\119\110\115 \049\054"end end end local function EM()if n.HammerofLight:IsReady()and(h:IsInRange(12)and(A:BuffUp(n.BlessingofDawnBuff)or not n.OfDuskandDawn:IsAvailable()or B>=5))then if G(n.EyeofTyr)then return"\104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \050"end end if n.EyeofTyr:IsCastable()and(EyeOfTyrSetting and(h:IsInMeleeRange(8)and(hM()==5 or not n.OfDuskandDawn:IsAvailable())))then if G(n.EyeofTyr)then return"\101\121\101\095\111\102\095\116\121\114 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \052"end end if n.ShieldoftheRighteous:IsReady()and(h:IsInMeleeRange(5)and hM()==4)then if G(n.ShieldoftheRighteous,true)then return"\115\104\105\101\108\100\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \115\116\097\110\100\097\114\100 \054"end end if n.EyeofTyr:IsCastable()and(EyeOfTyrSetting and(h:IsInMeleeRange(8)and(hM()==1 or A:BuffUp(n.BlessingofDawnBuff))))then if G(n.EyeofTyr)then return"\101\121\101\095\111\102\095\116\121\114 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \056"end end if n.HammerofWrath:IsReady()and h:IsSpellInRange(n.HammerofWrath)then if G(n.HammerofWrath)then return"\104\097\109\109\101\114\095\111\102\095\119\114\097\116\104 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \049\048"end end if n.Judgment:IsReady()and h:IsSpellInRange(n.Judgment)then if G(n.Judgment)then return"\106\117\100\103\109\101\110\116 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \049\050"end end if n.BlessedHammer:IsCastable()and h:IsInMeleeRange(5)then if G(n.BlessedHammer)then return"\098\108\101\115\115\101\100\095\104\097\109\109\101\114 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \049\052"end end if n.HammeroftheRighteous:IsCastable()and h:IsInMeleeRange(5)then if G(n.HammeroftheRighteous)then return"\104\097\109\109\101\114\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \049\054"end end if n.CrusaderStrike:IsCastable()and h:IsInMeleeRange(5)then if G(n.CrusaderStrike)then return"\099\114\117\115\097\100\101\114\095\115\116\114\105\107\101 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \049\056"end end if n.DivineToll:IsReady()and(h:IsInRange(30)and DivineTollSetting)then if G(n.DivineToll)then return"\100\105\118\105\110\101\095\116\111\108\108 \104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \050\048"end end end local function sM()if n.LightsGuidance:IsAvailable()and((n.EyeofTyr:CooldownRemains()<2 or n.HammerofLight:IsLearned())and((not n.Redoubt:IsAvailable()or A:BuffStack(n.RedoubtBuff)>=2 or not n.BastionofLight:IsAvailable())and n.HammerofLight:Cost()>0))then local k=EM()if k then return k end end if n.HammerofLight:IsReady()and(h:IsInRange(12)and(A:BuffRemains(n.LightsDeliveranceBuff)<2 or A:BuffRemains(n.ShaketheHeavensBuff)<1 or A:BuffDown(n.ShaketheHeavensBuff)or n.EyeofTyr:CooldownRemains()<1.5 or V<2))then if G(n.EyeofTyr)then return"\104\097\109\109\101\114\095\111\102\095\108\105\103\104\116 \115\116\097\110\100\097\114\100 \050"end end local k=999 if n.RighteousProtector:IsAvailable()then local U=l(n.ShieldoftheRighteous:TimeSinceLastCast(),n.WordofGlory:TimeSinceLastCast())k=q(0,1-l(n.ShieldoftheRighteous:TimeSinceLastCast(),n.WordofGlory:TimeSinceLastCast()))end if n.ShieldoftheRighteous:IsReady()and(h:IsInMeleeRange(5)and((not n.RighteousProtector:IsAvailable()or k==0)and not n.HammerofLight:IsLearned()))then if G(n.ShieldoftheRighteous,true)then return"\115\104\105\101\108\100\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \115\116\097\110\100\097\114\100 \052"end end if n.SacredWeapon:IsCastable()and(A:BuffDown(n.SacredWeaponBuff)or A:BuffRemains(n.SacredWeaponBuff)<6 and(A:BuffDown(n.AvengingWrathBuff)and n.AvengingWrath:CooldownRemains()<=30))then if G(n.SacredWeapon)then return"\104\111\108\121\095\097\114\109\097\109\101\110\116\115 \115\116\097\110\100\097\114\100 \054"end end if n.Judgment:IsReady()and(h:IsSpellInRange(n.Judgment)and(B>3 and(A:BuffStack(n.BulwarkofRighteousFuryBuff)>=3 and A:HolyPower()<3)))then if G(n.Judgment)then return"\106\117\100\103\109\101\110\116 \115\116\097\110\100\097\114\100 \056"end end if A:BuffUp(n.BlessedAssuranceBuff)and B<3 then if n.BlessedHammer:IsCastable()and h:IsInMeleeRange(5)then if G(n.BlessedHammer)then return"\098\108\101\115\115\101\100\095\104\097\109\109\101\114 \115\116\097\110\100\097\114\100 \049\048"end end if n.HammeroftheRighteous:IsCastable()and h:IsInMeleeRange(5)then if G(n.HammeroftheRighteous)then return"\104\097\109\109\101\114\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \115\116\097\110\100\097\114\100 \049\050"end end end if n.CrusaderStrike:IsCastable()and(h:IsInMeleeRange(5)and(A:BuffUp(n.BlessedAssuranceBuff)and B<2))then if G(n.CrusaderStrike)then return"\099\114\117\115\097\100\101\114\095\115\116\114\105\107\101 \115\116\097\110\100\097\114\100 \049\052"end end if n.AvengersShield:IsCastable()and(h:IsSpellInRange(n.AvengersShield)and(A:BuffDown(n.BulwarkofRighteousFuryBuff)and(n.BulwarkofRighteousFury:IsAvailable()and B>=3)))then if G(n.AvengersShield)then return"\097\118\101\110\103\101\114\115\095\115\104\105\101\108\100 \115\116\097\110\100\097\114\100 \049\054"end end if n.HammerofWrath:IsReady()and h:IsSpellInRange(n.HammerofWrath)then if G(n.HammerofWrath)then return"\104\097\109\109\101\114\095\111\102\095\119\114\097\116\104 \115\116\097\110\100\097\114\100 \049\056"end end if n.Judgment:IsReady()and(h:IsSpellInRange(n.Judgment)and(n.Judgment:Charges()>=2 or n.Judgment:FullRechargeTime()<=A:GCD()+.25))then if G(n.Judgment)then return"\106\117\100\103\109\101\110\116 \115\116\097\110\100\097\114\100 \050\048"end end if n.HolyBulwark:IsCastable()and n.HolyBulwark:Charges()==2 then if G(n.HolyBulwark)then return"\104\111\108\121\095\097\114\109\097\109\101\110\116\115 \115\116\097\110\100\097\114\100 \050\050"end end if n.DivineToll:IsReady()and(h:IsInRange(30)and DivineTollSetting)then if G(n.DivineToll)then return"\100\105\118\105\110\101\095\116\111\108\108 \115\116\097\110\100\097\114\100 \050\052"end end if n.Judgment:IsReady()and h:IsSpellInRange(n.Judgment)then if G(n.Judgment)then return"\106\117\100\103\109\101\110\116 \115\116\097\110\100\097\114\100 \050\054"end end if n.AvengersShield:IsCastable()and(h:IsSpellInRange(n.AvengersShield)and not n.LightsGuidance:IsAvailable())then if G(n.AvengersShield)then return"\097\118\101\110\103\101\114\115\095\115\104\105\101\108\100 \115\116\097\110\100\097\114\100 \050\056"end end if n.Consecration:IsCastable()and(kM()and(h:IsInMeleeRange(5)and A:BuffDown(n.ConsecrationBuff)))then if G(n.Consecration)then return"\099\111\110\115\101\099\114\097\116\105\111\110 \115\116\097\110\100\097\114\100 \051\048"end end if n.EyeofTyr:IsCastable()and(EyeOfTyrSetting and(h:IsInMeleeRange(8)and((n.InmostLight:IsAvailable()and B<=1 or B>=3)and not n.LightsDeliverance:IsAvailable())))then if G(n.EyeofTyr)then return"\101\121\101\095\111\102\095\116\121\114 \115\116\097\110\100\097\114\100 \051\050"end end if n.HolyBulwark:IsCastable()then if G(n.HolyBulwark)then return"\104\111\108\121\095\097\114\109\097\109\101\110\116\115 \115\116\097\110\100\097\114\100 \051\052"end end if n.BlessedHammer:IsCastable()and h:IsInMeleeRange(5)then if G(n.BlessedHammer)then return"\098\108\101\115\115\101\100\095\104\097\109\109\101\114 \115\116\097\110\100\097\114\100 \051\054"end end if n.HammeroftheRighteous:IsCastable()and h:IsInMeleeRange(5)then if G(n.HammeroftheRighteous)then return"\104\097\109\109\101\114\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \115\116\097\110\100\097\114\100 \051\056"end end if n.CrusaderStrike:IsCastable()and h:IsInMeleeRange(5)then if G(n.CrusaderStrike)then return"\099\114\117\115\097\100\101\114\095\115\116\114\105\107\101 \115\116\097\110\100\097\114\100 \052\048"end end if n.AvengersShield:IsCastable()and h:IsSpellInRange(n.AvengersShield)then if G(n.AvengersShield)then return"\097\118\101\110\103\101\114\115\095\115\104\105\101\108\100 \115\116\097\110\100\097\114\100 \052\056"end end if n.EyeofTyr:IsCastable()and(EyeOfTyrSetting and(h:IsInMeleeRange(8)and not n.LightsDeliverance:IsAvailable()))then if G(n.EyeofTyr)then return"\101\121\101\095\111\102\095\116\121\114 \115\116\097\110\100\097\114\100 \053\048"end end if n.ArcaneTorrent:IsCastable()and(h:IsInMeleeRange(8)and(RacialsSetting and A:HolyPower()<5))then if G(n.ArcaneTorrent)then return"\097\114\099\097\110\101\095\116\111\114\114\101\110\116 \115\116\097\110\100\097\114\100 \053\056"end end if n.Consecration:IsCastable()and(kM()and(h:IsInMeleeRange(5)and A:BuffDown(n.SanctificationEmpowerBuff)))then if G(n.Consecration)then return"\099\111\110\115\101\099\114\097\116\105\111\110 \115\116\097\110\100\097\114\100 \054\048"end end end local function eM()if f()and(A:AffectingCombat()and((c:ID()==R.ManicGrieftorch:ID()and Trinket1Setting or Y:ID()==R.ManicGrieftorch:ID()and Trinket2Setting)and(N(b.ProtTTD.TrinketsTTD)and h:IsInRange(40))))then if G(R.ManicGrieftorch)then return"\109\097\110\105\099\095\103\114\105\101\102\116\111\114\099\104"end end if R.ElementiumPocketAnvil:IsEquippedAndReady()and(A:AffectingCombat()and((c:ID()==R.ElementiumPocketAnvil:ID()and Trinket1Setting or Y:ID()==R.ElementiumPocketAnvil:ID()and Trinket2Setting)and h:IsInRange(5)))then if G(R.ElementiumPocketAnvil)then return"\069\108\101\109\101\110\116\105\117\109\080\111\099\107\101\116\065\110\118\105\108"end end if A:BuffUp(n.AvengingWrathBuff)or not n.AvengingWrath:IsAvailable()or n.Sentinel:IsAvailable()or V<=40 then local k,U,Q=A:GetUseableItems(K)if k then if(U==13 and Trinket1Setting or U==14 and Trinket2Setting)and(h:IsInRange(Q)and(b.Commons.Enabled.Trinkets and A:BuffDown(n.ConcoctionKissofDeathBuff)))then if G(k,false)then return"\071\101\110\101\114\105\099 \117\115\101\095\105\116\101\109\115 \102\111\114 "..(U..k:Name())end end end end end local function GM()if A:IsChanneling(R.ManicGrieftorch.ItemUseSpell)then return"\068\111\110\116 \099\117\116 \084\111\114\099\104"end if(c:ID()==R.ConcoctionKissofDeath:ID()or Y:ID()==R.ConcoctionKissofDeath:ID())and(A:BuffUp(n.ConcoctionKissofDeathBuff)and A:BuffRemains(n.ConcoctionKissofDeathBuff)<1)then if G(R.ConcoctionKissofDeath,true)then return"\067\111\110\099\111\099\116\105\111\110\075\105\115\115\111\102\068\101\097\116\104 \099\111\111\108\100\111\119\110\115 \056"end end S=L.UnitsinRange(n.FlashofLight)UnitForFreezingBinds=TM(S)SmallCDToggle=E.ToggleIconFrame:GetToggle(1)TabToggle=E.ToggleIconFrame:GetToggle(2)InterruptToggle=E.ToggleIconFrame:GetToggle(3)DispelToggle=E.ToggleIconFrame:GetToggle(4)d=A:GetEnemiesInRange(8)J=A:GetEnemiesInRange(30)S=L.UnitsinRange(n.FlashofLight)if s()then B=#d r=#J else B=1 r=1 end RacialsSetting=W(b.Protection.RacialsSetting)and N(b.ProtTTD.RacialsTTD)Trinket1Setting=W(b.Protection.Trinket1Setting,b.Protection.TrinketHP)Trinket2Setting=W(b.Protection.Trinket2Setting,b.Protection.TrinketHP)PotionSetting=W(b.Protection.PotionSetting)and not L.ISSolo()DivineTollSetting=W(b.Protection.DivineTollSetting)and(N(b.ProtTTD.DivineTollTTD)and h:IsInRange(30))AvengingWrathSetting=W(b.Protection.AvengingWrathSetting)and N(b.ProtTTD.AvengingWrathTTD)EyeOfTyrSetting=W(b.Protection.EyeOfTyrSetting)and N(15)if L.TargetIsValid()or A:AffectingCombat()then C=A:ActiveMitigationNeeded()a=A:IsTankingAoE(8)or A:IsTanking(h)V=u.BossFightRemains()i=true o=V if o==11111 then i=false o=u.FightRemains(d,false)end end if n.DevotionAura:IsCastable()and(A:BuffDown(n.DevotionAura,true)and AM())then if G(n.DevotionAura)then return"\100\101\118\111\116\105\111\110\095\097\117\114\097 \112\114\101\099\111\109\098\097\116 \050"end end if n.RiteofSanctification:IsCastable()then if E.CastLeft(n.RiteofSanctification)then return"\114\105\116\101\095\111\102\095\115\097\110\099\116\105\102\105\099\097\116\105\111\110 \112\114\101\099\111\109\098\097\116 \050"end end if n.RiteofAdjuration:IsCastable()then if E.CastLeft(n.RiteofAdjuration)then return"\114\105\116\101\095\111\102\095\097\100\106\117\114\097\116\105\111\110 \112\114\101\099\111\109\098\097\116 \052"end end if L.TargetIsValid()then if not A:AffectingCombat()and b.Protection.AttackOutOfCombat then w=ZM()if w then return w end end if n.CleanseToxins:IsReady()and(b.Protection.UseCleanse and DispelToggle)then w=L.DispelCycle(n.CleanseToxins,"\080\111\105\115\111\110")if w then return w end w=L.DispelCycle(n.CleanseToxins,"\068\105\115\101\097\115\101")if w then return w end w=L.AfflictedLogic(n.CleanseToxins)if w then return w end if w then return w end end if n.BlessingofFreedom:IsReady()and b.Protection.UseFreedom then if UnitForFreezingBinds then if UnitForFreezingBinds:Cast(n.BlessingofFreedom)then return"\066\108\101\115\115\105\110\103 \111\102 \070\114\101\101\100\111\109 \070\114\111\122\101\110 \066\105\110\100\115"end end if A:DebuffElapsed(n.EntangledDebuff)>2 then if A:Cast(n.BlessingofFreedom)then return"\066\108\101\115\115\105\110\103 \111\102 \070\114\101\101\100\111\109 \101\110\116\097\110\103\108\105\110\103"end end w=L.DispelCycle(n.BlessingofFreedom,"\082\111\111\116\068\105\115\112\101\108",nil,S)if w then return w end w=L.DispelCycle(n.BlessingofFreedom,"\083\110\097\114\101\082\111\111\116",nil,S)if w then return w end w=L.DispelCycle(n.BlessingofFreedom,"\070\114\101\101\100\111\109\068\105\115\112\101\108",nil,S)if w then return w end end if InterruptToggle then w=L.InterruptCycle(n.Rebuke,5,true,nil,false)if w then return w end w=not A:IsMoving()and L.InterruptCycle(n.HammerofJustice,10,false,nil,true)if w then return w end w=not A:IsMoving()and L.InterruptCycle(n.BlindingLight,10,false,nil,true,true)if w then return w end end if h:AffectingCombat()or b.Protection.AttackOutOfCombat then if a then w=xM()if w then return w end end if A:AffectingCombat()and(A:IsInParty()and not A:IsInRaid())then w=gM()if w then return w end end if n.Consecration:IsCastable()and(kM()and(h:IsInMeleeRange(5)and((u.CombatTime()<5 or b.ProtectionDefensives.MostDefensive)and(A:BuffDown(n.ConsecrationBuff)or A:BuffStack(n.DivineGuidanceBuff)>=5))))then if G(n.Consecration)then return"\099\111\110\115\101\099\114\097\116\105\111\110 \100\101\102\101\110\115\105\118\101"end end if n.BlessedHammer:IsCastable()and(h:IsInMeleeRange(10)and(u.CombatTime()<5 and(n.BlessedHammer:TimeSinceLastCast()>5 and b.ProtectionDefensives.MostDefensive)))then if G(n.BlessedHammer)then return"\098\108\101\115\115\101\100\095\104\097\109\109\101\114 \100\101\102\101\110\115\105\118\101"end end if n.ShieldoftheRighteous:IsReady()and(h:IsInMeleeRange(10)and(b.ProtectionDefensives.MostDefensive and A:BuffDown(n.ShieldoftheRighteousBuff)))then if G(n.ShieldoftheRighteous,true)then return"\115\104\105\101\108\100\095\111\102\095\116\104\101\095\114\105\103\104\116\101\111\117\115 \100\101\102\101\110\115\105\118\101"end end w=OM()if w then return w end if b.Commons.Enabled.Trinkets or b.Commons.Enabled.Items then w=eM()if w then return w end end w=sM()if w then return w end end w=B>0 and(not h:IsInRange(8)and X())if w then return w end end end local function MM()b.Protection.Display()E.ResetToggle()E.ToggleIconFrame:AddButtonCustom("\083",1,"\083\109\097\108\108 \067\068\115","\115\109\097\108\108\099\100\115")E.ToggleIconFrame:AddButtonCustom("\084",2,"\084\097\098","\116\097\098")E.ToggleIconFrame:AddButtonCustom("\073",3,"\073\110\116\101\114\114\117\112\116","\105\110\116\101\114\114\117\112\116")E.ToggleIconFrame:AddButtonCustom("\068",4,"\068\105\115\112\101\108","\100\105\115\112\101\108")E.Print("\080\114\111\116\101\099\116\105\111\110 \080\097\108\097\100\105\110 \114\111\116\097\116\105\111\110 \104\097\115 \098\101\101\110 \117\112\100\097\116\101\100 \102\111\114 \112\097\116\099\104 \049\049\046\048\046\048\046 \051\048\046\048\053\046\050\052")end E.SetAPL(66,GM,MM)